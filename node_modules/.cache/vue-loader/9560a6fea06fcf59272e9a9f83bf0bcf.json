{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\sys\\out-call\\user-assign.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\sys\\out-call\\user-assign.vue","mtime":1614579763381},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoudXNlci1jaG9vc2Ugew0KICAuY2xlYXIgew0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBtYXJnaW4tbGVmdDogMTVweDsNCiAgICBjb2xvcjogIzQwYTlmZjsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogIH0NCiAgLmNvbGxhcHNlIHsNCiAgICBmb250LXNpemU6IDEycHg7DQogICAgbWFyZ2luLXRvcDogMTVweDsNCiAgICB3aWR0aDogNTAwcHg7DQogIH0NCiAgLnNlbGVjdC1jb3VudCB7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogIzQwYTlmZjsNCiAgfQ0KfQ0K"},{"version":3,"sources":["user-assign.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user-assign.vue","sourceRoot":"src/views/sys/out-call","sourcesContent":["<template>\r\n<div class=\"user-choose\" >\r\n    <!-- <Button @click=\"getDataLists\" :icon=\"icon\">{{text}}</Button> -->\r\n    <Input type=\"text\" @click.native=\"getDataLists\" v-model=\"detailName\" clearable placeholder=\"请选择坐席\" style=\"width: 275px\" />\r\n    <!-- <span @click=\"clearSelectData\" class=\"clear\">清空已选</span>\r\n    <Collapse simple class=\"collapse\">\r\n      <Panel name=\"1\">\r\n        已选择\r\n        <span class=\"select-count\">{{selectUsers.length}}</span> 人\r\n        <p slot=\"content\">\r\n          <Tag\r\n            v-for=\"(item, i) in selectUsers\"\r\n            :key=\"i\"\r\n            :name=\"item.id\"\r\n            color=\"default\"\r\n            closable\r\n            @on-close=\"handleCancelUser\"\r\n          >\r\n            <Tooltip placement=\"top\" :content=\"item.username\">{{item.nickname}}</Tooltip>\r\n          </Tag>\r\n        </p>\r\n      </Panel>\r\n    </Collapse> -->\r\n    \r\n     <Drawer title=\"选择坐席\" closable v-model=\"userModalVisible\" width=\"900\" draggable>\r\n      <Form ref=\"searchUserForm\" :model=\"searchUserForm\" inline :label-width=\"75\">\r\n        <Form-item label=\"姓名\" prop=\"nickname\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"searchUserForm.nickname\"\r\n            clearable\r\n            placeholder=\"请输入姓名\"\r\n            style=\"width: 200px\"\r\n          />\r\n        </Form-item>\r\n        <Form-item label=\"部门\" prop=\"department\">\r\n          <department-choose @on-change=\"handleSelectDep\" style=\"width: 200px\" ref=\"dep\"></department-choose>\r\n        </Form-item>\r\n        <Form-item style=\"margin-left:-35px;\" class=\"br\">\r\n          <Button @click=\"handleSearchUser\" type=\"primary\" icon=\"ios-search\">搜索</Button>\r\n          <Button @click=\"handleResetUser\">重置</Button>\r\n        </Form-item>\r\n\r\n        <!-- <Form-item label=\"接续等级\" prop=\"continuationLevel\">\r\n          <Select v-model=\"continuationLevel\" style=\"width: 200px\" placeholder=\"请选择\">\r\n            <Option value=\"1\">1级</Option>\r\n            <Option value=\"2\">2级</Option>\r\n            <Option value=\"3\">3级</Option>\r\n            <Option value=\"4\">4级</Option>\r\n            <Option value=\"5\">5级</Option>\r\n            <Option value=\"6\">6级</Option>\r\n            <Option value=\"7\">7级</Option>\r\n            <Option value=\"8\">8级</Option>\r\n            <Option value=\"9\">9级</Option>\r\n          </Select>\r\n        </Form-item> -->\r\n\r\n\r\n      </Form>\r\n      <Row v-show=\"openTip\">\r\n      <Alert show-icon>\r\n        已选择\r\n        <span class=\"select-count\">{{selectUsers.length}}</span> 项\r\n        <a style=\"margin-left: 10px;\" @click=\"clearSelectData\">清空已选</a>\r\n      </Alert>\r\n      </Row>\r\n      <Table\r\n        :loading=\"userLoading\"\r\n        border\r\n        :columns=\"userColumns\"\r\n        :data=\"userData\"\r\n        @on-selection-change=\"showSelect\"\r\n        style=\"margin: 2vh 0;\"\r\n      ></Table>\r\n      <Row type=\"flex\" justify=\"end\">\r\n        <Page\r\n          :current=\"searchUserForm.pageNumber\"\r\n          :total=\"totalUser\"\r\n          :page-size=\"searchUserForm.pageSize\"\r\n          @on-change=\"changeUserPage\"\r\n          @on-page-size-change=\"changeUserPageSize\"\r\n          :page-size-opts=\"[10,20,50]\"\r\n          size=\"small\"\r\n          show-total\r\n          show-elevator\r\n          show-sizer\r\n          transfer\r\n        ></Page>\r\n      </Row>\r\n      <div style=\"float:right;margin-top:20px;\">\r\n        <Button type=\"text\" @click=\"clearData\">取消</Button>\r\n        <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submitAssignUser\">提交</Button>\r\n      </div>\r\n    </Drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAgentGroupUserListData } from \"@/api/index\";\r\nimport departmentChoose from \"@/views/my-components/xboot/department-choose\";\r\nexport default {\r\n  name: \"userChoose\",\r\n  components: {\r\n    departmentChoose\r\n  },\r\n  props: {\r\n    text: {\r\n      type: String,\r\n      default: \"选择用户\"\r\n    },\r\n    icon: {\r\n      type: String,\r\n      default: \"md-person-add\"\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      userLoading: true,\r\n      userModalVisible: false,\r\n      openTip:false,\r\n      selectUsers: [],\r\n      continuationLevel:\"1\",\r\n      EchartsWidth:\"200\",\r\n      detailName:\"\",\r\n      searchUserForm: {\r\n        nickname: \"\",\r\n        type: \"\",\r\n        status: \"\",\r\n        agentGroupId:\"\",\r\n        pageNumber: 1, // 当前页数\r\n        pageSize: 10, // 页面大小\r\n        sort: \"create_time\", // 默认排序字段\r\n        order: \"desc\" // 默认排序方式\r\n      },\r\n      userColumns: [\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          type: \"index\",\r\n          width: 60,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          title: \"用户名\",\r\n          key: \"nickname\",\r\n          minWidth: 130,\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"登录账号\",\r\n          key: \"username\",\r\n          minWidth: 130,\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"头像\",\r\n          key: \"avatar\",\r\n          width: 80,\r\n          align: \"center\",\r\n          render: (h, params) => {\r\n            return h(\"Avatar\", {\r\n              props: {\r\n                src: params.row.avatar\r\n              }\r\n            });\r\n          }\r\n        },\r\n        {\r\n          title: \"所属部门\",\r\n          key: \"departmentTitle\",\r\n          width: 120\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          width: 125,\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"邮箱\",\r\n          key: \"email\",\r\n          width: 180,\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"性别\",\r\n          key: \"sex\",\r\n          width: 70,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\",\r\n          width: 170\r\n        }\r\n      ],\r\n      userData: [],\r\n      totalUser: 0\r\n    };\r\n  },\r\n  methods: {\r\n    handleSelectDep(v) {\r\n      this.searchUserForm.departmentId = v;\r\n    },\r\n    getDataLists() {\r\n      this.userModalVisible=true;\r\n      //this.getUserDataList();\r\n    },\r\n    changeUserPage(v) {\r\n      this.searchUserForm.pageNumber = v;\r\n      this.getUserDataList();\r\n    },\r\n    changeUserPageSize(v) {\r\n      this.searchUserForm.pageSize = v;\r\n      this.getUserDataList();\r\n    },\r\n    showSelect(e) {\r\n      this.selectUsers = e;\r\n      if(this.selectUsers.length > 0){\r\n         this.openTip = true;\r\n         var name = \"\";\r\n         for (var i = 0; i < e.length; i++) {\r\n           name += e[i].nickname  +\",\";\r\n         }\r\n         this.detailName = name.substring(0, name.length - 1);\r\n      }else{\r\n         this.openTip = false;\r\n         this.detailName = \"\";\r\n      }\r\n    },\r\n    getUserDataList() {\r\n      this.userLoading = true;\r\n      getAgentGroupUserListData(this.searchUserForm).then(res => {\r\n        this.userLoading = false;\r\n        if (res.success) {\r\n          this.userData = res.result.list;\r\n          this.totalUser = res.result.total;\r\n        }\r\n      });\r\n    },\r\n    handleSearchUser() {\r\n      this.searchUserForm.pageNumber = 1;\r\n      this.searchUserForm.pageSize = 10;\r\n      \r\n      this.getUserDataList();\r\n    },\r\n    handleResetUser() {\r\n      this.$refs.searchUserForm.resetFields();\r\n      this.searchUserForm.pageNumber = 1;\r\n      this.searchUserForm.pageSize = 10;\r\n      this.$refs.dep.clearSelect();\r\n      this.searchUserForm.departmentId = \"\";\r\n      // 重新加载数据\r\n      this.getUserDataList();\r\n    },\r\n    setData(v) {\r\n      this.selectUsers = v;\r\n      this.$emit(\"on-change\", this.selectUsers);\r\n    },\r\n    chooseUser(v) {\r\n      // 去重\r\n      let that = this;\r\n      let flag = true;\r\n      this.selectUsers.forEach(e => {\r\n        if (v.id == e.id) {\r\n          that.$Message.warning(\"已经添加过啦，请勿重复选择\");\r\n          flag = false;\r\n        }\r\n      });\r\n      if (flag) {\r\n        let u = {\r\n          id: v.id,\r\n          username: v.username,\r\n          nickname: v.nickname\r\n        };\r\n        this.selectUsers.push(u);\r\n        this.$emit(\"on-change\", this.selectUsers);\r\n        this.$Message.success(`添加用户 ${v.nickname} 成功`);\r\n      }\r\n    },\r\n    clearSelectData() {\r\n      this.selectUsers = [];\r\n      this.$emit(\"on-change\", this.selectUsers);\r\n    },\r\n    clearData() {\r\n      this.selectUsers = [];\r\n      this.$emit(\"on-change\", this.selectUsers);\r\n      this.userModalVisible=false;\r\n      this.openTip = false;\r\n    },\r\n    submitAssignUser(){\r\n      if(this.selectUsers.length < 1 || this.selectUsers.length > 1){\r\n            this.$Message.warning(\"分配坐席只能选择一位。\");\r\n            return false;\r\n      }\r\n      this.$emit(\"click\", this.selectUsers);\r\n      this.userModalVisible=false;\r\n    },\r\n    handleCancelUser(e, id) {\r\n      // 删除所选用户\r\n      this.selectUsers = this.selectUsers.filter(e => {\r\n        return e.id != id;\r\n      });\r\n      this.$emit(\"on-change\", this.selectUsers);\r\n      this.$Message.success(\"删除所选用户成功\");\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getUserDataList();\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.user-choose {\r\n  .clear {\r\n    font-size: 12px;\r\n    margin-left: 15px;\r\n    color: #40a9ff;\r\n    cursor: pointer;\r\n  }\r\n  .collapse {\r\n    font-size: 12px;\r\n    margin-top: 15px;\r\n    width: 500px;\r\n  }\r\n  .select-count {\r\n    font-weight: 600;\r\n    color: #40a9ff;\r\n  }\r\n}\r\n</style>"]}]}