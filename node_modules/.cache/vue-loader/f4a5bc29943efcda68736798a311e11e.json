{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\sys\\setting-manage\\settingManage.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\sys\\setting-manage\\settingManage.vue","mtime":1614579763391},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICIuL3NldHRpbmdNYW5hZ2UubGVzcyI7DQo="},{"version":3,"sources":["settingManage.vue"],"names":[],"mappings":";AACA","file":"settingManage.vue","sourceRoot":"src/views/sys/setting-manage","sourcesContent":["<style lang=\"less\">\r\n@import \"./settingManage.less\";\r\n</style>\r\n<template>\r\n  <div>\r\n    <Card>\r\n      <Layout>\r\n        <Sider hide-trigger style=\"background: #fff;max-width: 220px;flex: 0 0 220px;\">\r\n          <Menu\r\n            :active-name=\"currName\"\r\n            theme=\"light\"\r\n            width=\"auto\"\r\n            @on-select=\"currName=$event\"\r\n          >\r\n            <MenuItem name=\"oss\">文件对象存储配置</MenuItem>\r\n            <MenuItem name=\"sms\">短信配置</MenuItem>\r\n            <MenuItem name=\"email\">邮件配置</MenuItem>\r\n            <MenuItem name=\"vaptcha\">Vaptcha验证码</MenuItem>\r\n            <MenuItem name=\"notice\">系统公告配置</MenuItem>\r\n            <MenuItem name=\"other\">其他配置</MenuItem>\r\n          </Menu>\r\n        </Sider>\r\n        <Content :style=\"{padding: '8px 40px', minHeight: '550px', background: '#fff'}\">\r\n          <div v-show=\"currName=='oss'\">\r\n            <div class=\"setting-title\">文件对象存储配置</div>\r\n            <div style=\"display:flex;position:relative\">\r\n              <Form \r\n                ref=\"ossForm\"\r\n                :model=\"oss\" \r\n                :label-width=\"110\" \r\n                label-position=\"left\"\r\n                :rules=\"ossValidate\"\r\n                >\r\n                <FormItem label=\"服务提供商\" prop=\"serviceName\">\r\n                  <Select v-model=\"oss.serviceName\" @on-change=\"changeOss\" placeholder=\"请选择\" style=\"width: 230px\">\r\n                    <Option value=\"LOCAL_OSS\">本地服务器</Option>\r\n                    <Option value=\"MINIO_OSS\">MinIO</Option>\r\n                    <Option value=\"QINIU_OSS\">七牛云</Option>\r\n                    <Option value=\"ALI_OSS\">阿里云</Option>\r\n                    <Option value=\"TENCENT_OSS\">腾讯云</Option>\r\n                  </Select>\r\n                </FormItem>\r\n                <div v-if=\"oss.serviceName!='LOCAL_OSS'\">\r\n                  <FormItem label=\"accessKey\" prop=\"accessKey\">\r\n                    <Input type=\"text\" v-model=\"oss.accessKey\" placeholder=\"请输入accessKey\" style=\"width: 380px\" :disabled=\"changeLoading\"/>\r\n                  </FormItem>\r\n                  <FormItem label=\"secretKey\" prop=\"secretKey\">\r\n                    <Tooltip placement=\"right\" content=\"无法编辑时请先点击查看图标\">\r\n                      <Input class=\"input-see\" type=\"text\" v-model=\"oss.secretKey\" :disabled=\"changeLoading\" :readonly=\"!changedOssSK\" @on-click=\"seeSecret(oss.serviceName)\" icon=\"ios-eye\" placeholder=\"请输入secretKey\" style=\"width: 380px\"/>\r\n                    </Tooltip>\r\n                  </FormItem>\r\n                  <FormItem v-if=\"oss.serviceName=='QINIU_OSS'\" label=\"zone存储区域\" prop=\"zone\">\r\n                    <Select v-model=\"oss.zone\" placeholder=\"请选择存储区域\" style=\"width: 380px\" :disabled=\"changeLoading\">\r\n                      <Option :value=\"-1\">自动判断</Option>\r\n                      <Option :value=\"0\">华东</Option>\r\n                      <Option :value=\"1\">华北</Option>\r\n                      <Option :value=\"2\">华南</Option>\r\n                      <Option :value=\"3\">北美</Option>\r\n                      <Option :value=\"4\">东南亚</Option>\r\n                    </Select>\r\n                  </FormItem>\r\n                  <FormItem label=\"bucket空间\" prop=\"bucket\">\r\n                    <Input type=\"text\" v-model=\"oss.bucket\" placeholder=\"请输入bucket空间名\" style=\"width: 380px\" :disabled=\"changeLoading\"/>\r\n                  </FormItem>\r\n                  <FormItem v-if=\"oss.serviceName=='TENCENT_OSS'\" label=\"所属地域\" prop=\"bucketRegion\">\r\n                    <Select v-model=\"oss.bucketRegion\" placeholder=\"请选择或输入搜索\" style=\"width: 380px\" filterable transfer :disabled=\"changeLoading\">\r\n                      <Option v-for=\"(item, i) in dictBucketRegions\" :key=\"i\" :value=\"item.value\">{{item.title}}</Option>\r\n                    </Select>\r\n                  </FormItem>\r\n                  <FormItem label=\"endpoint域名\" prop=\"endpoint\" :error=\"errorMsg\">\r\n                    <Input type=\"text\" v-model=\"oss.endpoint\" :placeholder=\"endpointPH\" style=\"width: 380px\" :disabled=\"changeLoading\">\r\n                      <Select v-model=\"oss.http\" slot=\"prepend\" style=\"width: 80px\" prop=\"http\">\r\n                        <Option value=\"http://\">http://</Option>\r\n                        <Option value=\"https://\">https://</Option>\r\n                      </Select>\r\n                    </Input>\r\n                  </FormItem>\r\n                </div>\r\n                <div v-else>\r\n                  <FormItem label=\"存储磁盘路径\" prop=\"filePath\" :error=\"errorMsg2\">\r\n                    <Input type=\"text\" v-model=\"oss.filePath\" placeholder=\"例如D:/upload\" style=\"width: 380px\" :disabled=\"changeLoading\"/>\r\n                  </FormItem>\r\n                  <FormItem label=\"文件预览接口\" prop=\"endpoint\" :error=\"errorMsg\">\r\n                    <Input type=\"text\" v-model=\"oss.endpoint\" placeholder=\"请输入文件预览接口\" style=\"width: 380px\">\r\n                      <Select v-model=\"oss.http\" slot=\"prepend\" style=\"width: 80px\" prop=\"http\" :disabled=\"changeLoading\">\r\n                        <Option value=\"http://\">http://</Option>\r\n                        <Option value=\"https://\">https://</Option>\r\n                      </Select>\r\n                    </Input>\r\n                  </FormItem>\r\n                </div>\r\n                <FormItem>\r\n                  <Button type=\"primary\" style=\"width: 100px;\" :disabled=\"changeLoading\" :loading=\"saveLoading\" @click=\"saveEditOss\">保存并启用</Button>\r\n                </FormItem>\r\n              </Form>\r\n              <Spin fix v-if=\"loading\"></Spin>\r\n            </div>\r\n          </div>\r\n          <div v-show=\"currName=='sms'\">\r\n            <div class=\"setting-title\">短信配置</div>\r\n            <div style=\"display:flex;position:relative\">\r\n              <Form \r\n                ref=\"smsForm\"\r\n                :model=\"sms\" \r\n                :label-width=\"110\" \r\n                label-position=\"left\"\r\n                :rules=\"smsValidate\"\r\n                > \r\n                <FormItem label=\"服务提供商\" prop=\"serviceName\">\r\n                  <Select v-model=\"sms.serviceName\" placeholder=\"请选择\" style=\"width: 230px\">\r\n                    <Option value=\"ALI_SMS\">阿里云</Option>\r\n                  </Select>\r\n                </FormItem>\r\n                <FormItem label=\"accessKey\" prop=\"accessKey\">\r\n                  <Input type=\"text\" v-model=\"sms.accessKey\" placeholder=\"请输入\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem label=\"secretKey\" prop=\"secretKey\">\r\n                  <Tooltip placement=\"right\" content=\"无法编辑时请先点击查看图标\">\r\n                      <Input class=\"input-see\" type=\"text\" v-model=\"sms.secretKey\" :readonly=\"!changedSmsSK\" @on-click=\"seeSecret(sms.serviceName)\" icon=\"ios-eye\" placeholder=\"请输入\" style=\"width: 380px\"/>\r\n                  </Tooltip>\r\n                </FormItem>\r\n                <FormItem label=\"短信签名\" prop=\"signName\">\r\n                  <Input type=\"text\" v-model=\"sms.signName\" placeholder=\"请输入短信签名，例如XBoot\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem label=\"使用场景\" prop=\"type\">\r\n                  <Select v-model=\"sms.type\" @on-change=\"changeSmsType\" placeholder=\"请选择\" style=\"width: 380px\">\r\n                    <Option value=\"0\">通用验证码</Option>\r\n                    <Option value=\"1\">注册</Option>\r\n                    <Option value=\"2\">登录</Option>\r\n                    <Option value=\"3\">修改绑定手机号</Option>\r\n                    <Option value=\"4\">修改密码</Option>\r\n                    <Option value=\"5\">重置密码</Option>\r\n                    <Option value=\"6\">工作流消息</Option>\r\n                  </Select>\r\n                </FormItem>\r\n                <FormItem label=\"模版CODE\" prop=\"templateCode\">\r\n                  <Input type=\"text\" v-model=\"sms.templateCode\" placeholder=\"请输入场景对应短信模版CODE，例如SMS_123456789\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem>\r\n                  <Button type=\"primary\" style=\"width: 100px;\" :loading=\"saveLoading\" @click=\"saveEditSms\">保存更改</Button>\r\n                </FormItem>\r\n              </Form>\r\n              <Spin fix v-if=\"loading\"></Spin>\r\n            </div>\r\n          </div>\r\n          <div v-show=\"currName=='email'\">\r\n            <div class=\"setting-title\">邮箱配置</div>\r\n            <div style=\"display:flex;position:relative\">\r\n              <Form \r\n                ref=\"emailForm\"\r\n                :model=\"email\" \r\n                :label-width=\"110\" \r\n                label-position=\"left\"\r\n                :rules=\"emailValidate\"\r\n                > \r\n                <FormItem label=\"邮箱服务器\" prop=\"host\">\r\n                  <Input type=\"text\" v-model=\"email.host\" placeholder=\"请输入邮箱服务器Host，例如QQ邮箱为smtp.qq.com\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem label=\"发送邮箱账号\" prop=\"username\">\r\n                  <Input type=\"text\" v-model=\"email.username\" placeholder=\"请输入发送者Email账号\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem label=\"邮箱授权码\" prop=\"password\">\r\n                  <Tooltip placement=\"right\" content=\"无法编辑时请先点击查看图标\">\r\n                      <Input class=\"input-see\" type=\"text\" v-model=\"email.password\" :readonly=\"!changedEmailPass\" @on-click=\"seeSecret('EMAIL_SETTING')\" icon=\"ios-eye\" placeholder=\"请输入邮箱授权码，进入邮箱-设置中可找到\" style=\"width: 380px\"/>\r\n                  </Tooltip>\r\n                </FormItem>\r\n                <FormItem>\r\n                  <Button type=\"primary\" style=\"width: 100px;\" :loading=\"saveLoading\" @click=\"saveEditEmail\">保存更改</Button>\r\n                </FormItem>\r\n              </Form>\r\n              </Form>\r\n              <Spin fix v-if=\"loading\"></Spin>\r\n            </div>\r\n          </div>\r\n          <div v-show=\"currName=='vaptcha'\">\r\n            <div class=\"setting-title\">Vaptcha验证码配置</div>\r\n            <div style=\"display:flex;position:relative\">\r\n              <Form \r\n                ref=\"vaptchaForm\"\r\n                :model=\"vaptcha\" \r\n                :label-width=\"110\" \r\n                label-position=\"left\"\r\n                :rules=\"vaptchaValidate\"\r\n                > \r\n                <FormItem label=\"VID\" prop=\"vid\">\r\n                  <Input type=\"text\" v-model=\"vaptcha.vid\" placeholder=\"请输入验证单元VID\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem label=\"secretKey\" prop=\"secretKey\">\r\n                  <Tooltip placement=\"right\" content=\"无法编辑时请先点击查看图标\">\r\n                      <Input class=\"input-see\" type=\"text\" v-model=\"vaptcha.secretKey\" :readonly=\"!changedVaptchaSK\" @on-click=\"seeSecret('VAPTCHA_SETTING')\" icon=\"ios-eye\" placeholder=\"请输入验证单元Key\" style=\"width: 380px\"/>\r\n                  </Tooltip>\r\n                </FormItem>\r\n                <FormItem>\r\n                  <Button type=\"primary\" style=\"width: 100px;\" :loading=\"saveLoading\" @click=\"saveEditVaptcha\">保存更改</Button>\r\n                </FormItem>\r\n              </Form>\r\n              <Spin fix v-if=\"loading\"></Spin>\r\n            </div>\r\n          </div>\r\n          <div v-show=\"currName=='notice'\">\r\n            <div class=\"setting-title\">\r\n              系统公告配置\r\n              <Tooltip\r\n                content=\"访问系统公告，右上角弹出\"\r\n                placement=\"right\"\r\n              >\r\n                <Icon\r\n                  type=\"md-help-circle\"\r\n                  size=\"20\"\r\n                  color=\"#c5c5c5\"\r\n                  style=\"margin-left:10px;cursor:pointer;\"\r\n                />\r\n              </Tooltip>\r\n            </div>\r\n            <div style=\"display:flex;\">\r\n              <Form \r\n                ref=\"noticeForm\"\r\n                :model=\"notice\" \r\n                :label-width=\"110\" \r\n                label-position=\"left\"\r\n                > \r\n                <FormItem label=\"公告开关\" prop=\"open\">\r\n                  <i-switch v-model=\"notice.open\" >\r\n                    <span slot=\"open\">开</span>\r\n                    <span slot=\"close\">关</span>\r\n                  </i-switch>\r\n                </FormItem>\r\n                <FormItem label=\"展示时长\" prop=\"duration\">\r\n                  <Tooltip trigger=\"hover\" placement=\"right\" content=\"设为0不自动关闭\">\r\n                    <InputNumber :max=\"1000\" :min=\"0\" v-model=\"notice.duration\"></InputNumber> 秒\r\n                  </Tooltip>\r\n                </FormItem>\r\n                <FormItem label=\"展示页面\" prop=\"position\">\r\n                  <Select v-model=\"notice.position\" placeholder=\"请选择\" style=\"width: 380px\">\r\n                    <Option value=\"LOGIN\">登录页（访问系统时）</Option>\r\n                    <Option value=\"HOME\">首页（登录系统后）</Option>\r\n                  </Select>\r\n                </FormItem>\r\n                <FormItem label=\"公告标题\" prop=\"title\">\r\n                  <Input v-model=\"notice.title\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem label=\"公告内容\" prop=\"content\">\r\n                  <Input type=\"textarea\" v-model=\"notice.content\" :rows=\"4\" placeholder=\"\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem>\r\n                  <Button type=\"primary\" style=\"width: 100px;\" :loading=\"saveLoading\" @click=\"saveEditNotice\">保存更改</Button>\r\n                </FormItem>\r\n              </Form>\r\n              <Spin fix v-if=\"loading\"></Spin>\r\n            </div>\r\n          </div>\r\n          <div v-show=\"currName=='other'\">\r\n            <div class=\"setting-title\">其他配置</div>\r\n            <div style=\"display:flex;\">\r\n              <Form \r\n                ref=\"otherForm\"\r\n                :model=\"other\" \r\n                :label-width=\"110\" \r\n                label-position=\"left\"\r\n                :rules=\"otherValidate\"\r\n                > \r\n                <FormItem label=\"应用部署域名\" prop=\"domain\">\r\n                  <Tooltip placement=\"right\" content=\"拼接部分资源访问链接使用\">\r\n                    <Input type=\"text\" v-model=\"other.domain\" placeholder=\"请输入应用部署域名前缀，如http://xboot.exrick.cn\" style=\"width: 380px\"/>\r\n                  </Tooltip>\r\n                </FormItem>\r\n                <FormItem label=\"单点登录域名\" prop=\"ssoDomain\">\r\n                  <Tooltip max-width=\"250\" transfer placement=\"right\" content=\"该域名及子域名下将可获得单点登录所需数据\">\r\n                    <Input type=\"text\" v-model=\"other.ssoDomain\" placeholder=\"请输入应用部署一级域名，如exrick.cn\" style=\"width: 380px\"/>\r\n                  </Tooltip>\r\n                </FormItem>\r\n                <FormItem label=\"IP黑名单\" prop=\"blacklist\">\r\n                  <Input type=\"textarea\" v-model=\"other.blacklist\" :rows=\"4\" placeholder=\"多个以回车分隔\" style=\"width: 380px\"/>\r\n                </FormItem>\r\n                <FormItem>\r\n                  <Button type=\"primary\" style=\"width: 100px;\" :loading=\"saveLoading\" @click=\"saveEditOther\">保存更改</Button>\r\n                </FormItem>\r\n              </Form>\r\n              <Spin fix v-if=\"loading\"></Spin>\r\n            </div>\r\n          </div>\r\n        </Content>\r\n      </Layout>\r\n    </Card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  seeSecretSet,\r\n  checkOssSet,\r\n  getOssSet,\r\n  editOssSet,\r\n  getSmsSet,\r\n  editSmsSet,\r\n  getSmsTemplateCode,\r\n  getEmailSet,\r\n  editEmailSet,\r\n  getVaptchaSet,\r\n  editVaptchaSet,\r\n  getOtherSet,\r\n  editOtherSet,\r\n  getNoticeSet,\r\n  editNoticeSet,\r\n  getDictDataByType\r\n} from \"@/api/index\";\r\nexport default {\r\n  name: \"setting-manage\",\r\n  data() {\r\n    return {\r\n      currName: \"oss\",\r\n      loading: false, // 表单加载状态\r\n      changeLoading: false,\r\n      saveLoading: false,\r\n      oss: {\r\n        serviceName: \"\",\r\n        accessKey: \"\",\r\n        secretKey: \"\",\r\n        endpoint: \"\",\r\n        bucket: \"\"\r\n      },\r\n      changedOssSK: false, // 是否修改oss的secrectKey\r\n      sms: {\r\n        serviceName: \"ALI_SMS\",\r\n        accessKey: \"\",\r\n        secretKey: \"\",\r\n        signName: \"\",\r\n        type: \"\",\r\n        templateCode: \"\"\r\n      },\r\n      changedSmsSK: false, // 是否修改短信的secrectKey\r\n      email: {\r\n        host: \"\",\r\n        username: \"\",\r\n        password: \"\"\r\n      },\r\n      changedEmailPass: false, // 是否修改邮件密码\r\n      errorMsg: \"\",\r\n      errorMsg2: \"\",\r\n      vaptcha: {\r\n        vID: \"\",\r\n        secretKey: \"\"\r\n      },\r\n      changedVaptchaSK: false, // 是否修改Vaptcha的secrectKey\r\n      notice: {\r\n        duration: 10\r\n      },\r\n      other: {\r\n        domain: \"http://127.0.0.1:8888\",\r\n        ssoDomain: \"\",\r\n        blacklist: \"\"\r\n      },\r\n      ossValidate: {\r\n        // 表单验证规则\r\n        serviceName: [{ required: true, message: \"请选择\", trigger: \"blur\" }],\r\n        accessKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        secretKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        endpoint: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        bucket: [{ required: true, message: \"不能为空\", trigger: \"blur\" }]\r\n      },\r\n      smsValidate: {\r\n        // 表单验证规则\r\n        serviceName: [{ required: true, message: \"请选择\", trigger: \"blur\" }],\r\n        accessKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        secretKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        signName: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        type: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        templateCode: [{ required: true, message: \"不能为空\", trigger: \"blur\" }]\r\n      },\r\n      emailValidate: {\r\n        // 表单验证规则\r\n        host: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        username: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        password: [{ required: true, message: \"不能为空\", trigger: \"blur\" }]\r\n      },\r\n      vaptchaValidate: {\r\n        // 表单验证规则\r\n        vID: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        secretKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }]\r\n      },\r\n      otherValidate: {\r\n        // 表单验证规则\r\n        domain: [{ required: true, message: \"不能为空\", trigger: \"blur\" }]\r\n      },\r\n      endpointPH: \"请输入空间访问域名\",\r\n      dictBucketRegions: [\r\n      ]\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.initOssSet();\r\n      this.initSmsSet();\r\n      this.initEmailSet();\r\n      this.initVaptchaSet();\r\n      this.initNoticeSet();\r\n      this.initOtherSet();\r\n      this.getDictBucketRegions();\r\n    },\r\n    getDictBucketRegions() {\r\n      getDictDataByType(\"tencent_bucket_region\").then(res => {\r\n        if (res.success) {\r\n          this.dictBucketRegions = res.result;\r\n        }\r\n      });\r\n    },\r\n    initOssSet() {\r\n      this.loading = true;\r\n      checkOssSet().then(res => {\r\n        if (res.success && res.result) {\r\n          let oss = res.result;\r\n          getOssSet(oss).then(res => {\r\n            this.loading = false;\r\n            if (res.result) {\r\n              // 转换null为\"\"\r\n              for (let attr in res.result) {\r\n                if (res.result[attr] == null) {\r\n                  res.result[attr] = \"\";\r\n                }\r\n              }\r\n              this.oss = res.result;\r\n            } else {\r\n              this.changedOssSK = true;\r\n            }\r\n          });\r\n        } else {\r\n          this.loading = false;\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    changeOss(v) {\r\n      if (v == \"ALI_OSS\") {\r\n        this.endpointPH = \"请输入EndPoint(地域节点) 非Bucket域名\";\r\n      } else if (v == \"TENCENT_OSS\") {\r\n        this.endpointPH =\r\n          \"请输入完整请求域名\";\r\n      } else {\r\n        this.endpointPH = \"请输入空间访问域名\";\r\n      }\r\n      this.changeLoading = true;\r\n      getOssSet(v).then(res => {\r\n        this.changeLoading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.oss = res.result;\r\n          this.changedOssSK = false;\r\n        } else {\r\n          this.oss = { serviceName: v };\r\n          if (this.oss.serviceName == \"LOCAL_OSS\") {\r\n            this.oss.http = \"http://\";\r\n            this.oss.endpoint = \"127.0.0.1:9999/xboot/file/view\";\r\n          }\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    initSmsSet() {\r\n      this.loading = true;\r\n      getSmsSet(this.sms.serviceName).then(res => {\r\n        this.loading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.sms = res.result;\r\n          this.sms.type = \"0\";\r\n          this.changeSmsType(this.sms.type);\r\n        } else {\r\n          this.changedSmsSK = true;\r\n        }\r\n      });\r\n    },\r\n    changeSmsType(v) {\r\n      getSmsTemplateCode(v).then(res => {\r\n        if (res.success) {\r\n          this.sms.templateCode = res.result;\r\n        }\r\n      });\r\n    },\r\n    initEmailSet() {\r\n      this.loading = true;\r\n      getEmailSet().then(res => {\r\n        this.loading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.email = res.result;\r\n        } else {\r\n          this.changedEmailPass = true;\r\n        }\r\n      });\r\n    },\r\n    initVaptchaSet() {\r\n      this.loading = true;\r\n      getVaptchaSet().then(res => {\r\n        this.loading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.vaptcha = res.result;\r\n        } else {\r\n          this.changedVaptchaSK = true;\r\n        }\r\n      });\r\n    },\r\n    initOtherSet() {\r\n      this.loading = true;\r\n      getOtherSet().then(res => {\r\n        this.loading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.other = res.result;\r\n        }\r\n      });\r\n    },\r\n    initNoticeSet() {\r\n      this.loading = true;\r\n      getNoticeSet().then(res => {\r\n        this.loading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.notice = res.result;\r\n        }\r\n      });\r\n    },\r\n    seeSecret(name) {\r\n      if (!name) {\r\n        return;\r\n      }\r\n      seeSecretSet(name).then(res => {\r\n        if (res.success) {\r\n          if (this.currName == \"oss\") {\r\n            this.oss.secretKey = res.result;\r\n            this.changedOssSK = true;\r\n          } else if (this.currName == \"sms\") {\r\n            this.sms.secretKey = res.result;\r\n            this.changedSmsSK = true;\r\n          } else if (this.currName == \"email\") {\r\n            this.email.password = res.result;\r\n            this.changedEmailPass = true;\r\n          } else if (this.currName == \"vaptcha\") {\r\n            this.vaptcha.secretKey = res.result;\r\n            this.changedVaptchaSK = true;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    saveEditOss() {\r\n      if (this.oss.serviceName == \"LOCAL_OSS\") {\r\n        if (!this.oss.http) {\r\n          this.errorMsg = \"请选择http协议\";\r\n          return;\r\n        } else {\r\n          this.errorMsg = \"\";\r\n        }\r\n        if (!this.oss.endpoint) {\r\n          this.errorMsg = \"请输入文件预览接口\";\r\n          return;\r\n        } else {\r\n          this.errorMsg = \"\";\r\n        }\r\n        if (!this.oss.filePath) {\r\n          this.errorMsg2 = \"请输入存储磁盘路径\";\r\n          return;\r\n        } else {\r\n          this.errorMsg2 = \"\";\r\n        }\r\n        editOssSet(this.oss).then(res => {\r\n          this.saveLoading = false;\r\n          if (res.success) {\r\n            this.$Message.success(\"保存成功\");\r\n          }\r\n        });\r\n      } else {\r\n        this.$refs.ossForm.validate(valid => {\r\n          if (valid) {\r\n            if (!this.oss.http) {\r\n              this.errorMsg = \"请选择http协议\";\r\n              return;\r\n            } else {\r\n              this.errorMsg = \"\";\r\n            }\r\n            this.saveLoading = true;\r\n            this.oss.changed = this.changedOssSK;\r\n            editOssSet(this.oss).then(res => {\r\n              this.saveLoading = false;\r\n              if (res.success) {\r\n                this.$Message.success(\"保存成功\");\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n    saveEditSms() {\r\n      this.$refs.smsForm.validate(valid => {\r\n        if (valid) {\r\n          this.saveLoading = true;\r\n          this.sms.changed = this.changedSmsSK;\r\n          editSmsSet(this.sms).then(res => {\r\n            this.saveLoading = false;\r\n            if (res.success) {\r\n              this.$Message.success(\"保存成功\");\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    saveEditEmail() {\r\n      this.$refs.emailForm.validate(valid => {\r\n        if (valid) {\r\n          this.saveLoading = true;\r\n          this.email.changed = this.changedEmailPass;\r\n          editEmailSet(this.email).then(res => {\r\n            this.saveLoading = false;\r\n            if (res.success) {\r\n              this.$Message.success(\"保存成功\");\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    saveEditVaptcha() {\r\n      this.$refs.vaptchaForm.validate(valid => {\r\n        if (valid) {\r\n          this.saveLoading = true;\r\n          this.vaptcha.changed = this.changedVaptchaSK;\r\n          editVaptchaSet(this.vaptcha).then(res => {\r\n            this.saveLoading = false;\r\n            if (res.success) {\r\n              this.$Message.success(\"保存成功\");\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    saveEditOther() {\r\n      this.$refs.otherForm.validate(valid => {\r\n        if (valid) {\r\n          this.saveLoading = true;\r\n          editOtherSet(this.other).then(res => {\r\n            this.saveLoading = false;\r\n            if (res.success) {\r\n              this.$Message.success(\"保存成功\");\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    saveEditNotice() {\r\n      this.saveLoading = true;\r\n      let str = JSON.stringify(this.notice);\r\n      let params = JSON.parse(str);\r\n      if(!this.notice.duration){\r\n        params.duration = 0;\r\n      }\r\n      editNoticeSet(params).then(res => {\r\n        this.saveLoading = false;\r\n        if (res.success) {\r\n          this.$Message.success(\"保存成功\");\r\n        }\r\n      });\r\n    }\r\n  },\r\n  mounted() {\r\n    let name = this.$route.query.name;\r\n    if (name) {\r\n      this.currName = name;\r\n    }\r\n    this.init();\r\n  }\r\n};\r\n</script>"]}]}