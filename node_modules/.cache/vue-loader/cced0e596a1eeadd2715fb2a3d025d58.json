{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\my-components\\IVR\\SetNode_SetVariable.vue?vue&type=style&index=0&id=3eed3852&scoped=true&lang=less&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\my-components\\IVR\\SetNode_SetVariable.vue","mtime":1614579763291},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQoudWktY29tYmluYXRpb24tZm9ybXsNCiAgLnVpLXZvaWNlTGlzdHsNCiAgICAudWktdm9pY2VMaXN0LWl0ZW17DQogICAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgICAgLml2dS1mb3JtLWl0ZW0tbGFiZWx7DQogICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHJlZCAhaW1wb3J0YW50Ow0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQp9DQo="},{"version":3,"sources":["SetNode_SetVariable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"SetNode_SetVariable.vue","sourceRoot":"src/views/my-components/IVR","sourcesContent":["<template>\r\n  <Row style=\"padding-top: 20px;background: #fff;\">\r\n    <Col span=\"22\" offset=\"1\">\r\n      <!--      {{formItem}}-->\r\n      <!--      {{nextNodeIdStr}}-->\r\n      <Form class=\"ui-combination-form\" ref=\"formItem\" :model=\"formItem\" :rules=\"formItemValidate\" :label-width=\"120\">\r\n        <FormItem label=\"节点号\" prop=\"id\">\r\n          <Input v-model=\"formItem.id\" placeholder=\"请输入...\" disabled></Input>\r\n        </FormItem>\r\n        <FormItem label=\"节点名称\" prop=\"name\">\r\n          <Input v-model=\"formItem.name\" placeholder=\"请输入...\"></Input>\r\n        </FormItem>\r\n        <FormItem label=\"变量名\" prop=\"strVariable\" class=\"ui-voiceList-item\">\r\n          <Row :gutter=\"16\" style=\"margin-bottom: 5px\">\r\n            <Col span=\"15\" prop=\"strVariable\" style=\"padding-left: 0;\">\r\n              <Input v-model=\"formItem.strVariable\"  placeholder=\"请选择\" disabled></Input>\r\n            </Col>\r\n            <Col span=\"8\" style=\"text-align: left;padding-left: 0 !important;\">\r\n              <Button @click=\"selProcessVariablesVisible('str')\" style=\"margin-left: 10px\">选择</Button>\r\n            </Col>\r\n          </Row>\r\n        </FormItem>\r\n        <FormItem label=\"源数据\" prop=\"dataSource\" class=\"ui-voiceList-item\">\r\n<!--          {{formItem.dataSource}}-->\r\n<!--          {{formItem.dataSourceList}}-->\r\n          <Row :gutter=\"16\" style=\"margin-bottom: 5px\">\r\n            <Col span=\"15\" prop=\"dataSource\" style=\"padding-left: 0;\">\r\n              <Input type=\"textarea\" v-model=\"formItem.dataSource\"  placeholder=\"请选择\" @on-change=\"ChangeDataSource(formItem.dataSource)\"></Input>\r\n            </Col>\r\n            <Col span=\"8\" style=\"text-align: left;padding-left: 0 !important;\">\r\n              <Button @click=\"selProcessVariablesVisible('list')\" style=\"margin-left: 10px\">选择</Button>\r\n            </Col>\r\n          </Row>\r\n        </FormItem>\r\n        <FormItem label=\"跳转节点\" prop=\"nextNodeId\">\r\n          <Select v-model=\"formItem.nextNodeId\">\r\n            <Option :value=\"item.value\" v-for=\"(item,i) in nextNodeIdList\" :key=\"i\">{{item.text}}</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"说明\" prop=\"describe\">\r\n          <Input type=\"textarea\" v-model=\"formItem.describe\" placeholder=\"请输入...\"></Input>\r\n        </FormItem>\r\n        <FormItem>\r\n          <Button @click=\"btnOk\" type=\"primary\">确定</Button>\r\n          <Button @click=\"btnCancel\" style=\"margin-left: 8px\">取消</Button>\r\n        </FormItem>\r\n      </Form>\r\n    </Col>\r\n    <Modal\r\n        title=\"选择流程变量\"\r\n        v-model=\"processVariablesVisible\"\r\n        :closable=\"false\"\r\n        :mask-closable=\"false\"\r\n        :width=\"800\"\r\n    >\r\n      <processVariables ref=\"getProcessVariablesVisible\"></processVariables>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"processVariablesVisible = false\">{{\r\n            $t(\"cancel\")\r\n          }}</Button>\r\n        <Button\r\n            type=\"primary\"\r\n            @click=\"btnProcessVariables\"\r\n        >{{ $t(\"save\") }}</Button\r\n        >\r\n      </div>\r\n    </Modal><!--选择流程变量-结束--->\r\n  </Row>\r\n</template>\r\n\r\n<script>\r\nimport {getBlackListGroups} from \"@/api/index\";\r\nimport processVariables from \"@/views/my-components/IVR/processVariables\";\r\nvar frame = parent;\r\nexport default {\r\n  name: \"SetNode_SetVariable\",\r\n  components:{processVariables},\r\n  data(){\r\n    return{\r\n      layParent:true,\r\n      processVariablesVisible:false,\r\n      selProcessVariablesType:'str',\r\n      openerid:WFCore.GetQuery(\"openerid\"),\r\n      stepid:WFCore.GetQuery(\"id\"),\r\n      flowdata:top.wMyflowData,\r\n      nextNodeIdList:[{value:0,text:'无'}],\r\n      selIndex:0,\r\n      step:'',\r\n      formItem:{\r\n        id:'',//节点号\r\n        name:'',//节点名称\r\n        strVariable:'',//变量名\r\n        dataSource:'',//源数据\r\n        dataSourceList:[],//源数据\r\n        nextNodeId:0,//跳转节点\r\n        sort:'',//排序序号\r\n        describe:'',//说明\r\n      },\r\n      inBlacklistNextNodeIdStr:0,//黑名单跳转节点-绑定\r\n      notInBlacklistNextNodeIdStr:0,//非黑名单跳转节点-绑定\r\n      formItemValidate:{\r\n        name: [{\r\n          required: true,\r\n          message: this.$t(\"pleaseEnter\"),\r\n          trigger: \"blur\",\r\n        }],\r\n        // replayCount: [{\r\n        //   required: true,\r\n        //   message: this.$t(\"pleaseEnter\"),\r\n        //   trigger: \"blur\",\r\n        // }],\r\n        // nextNodeId: [{\r\n        //   required: true,\r\n        //   message: this.$t(\"pleaseEnter\"),\r\n        //   trigger: \"blur\",\r\n        // }]\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    init(){\r\n      this.initData();\r\n    },\r\n    initData(){\r\n      var than=this;\r\n      if (frame == null) return;\r\n      than.flowdata=top.wMyflowData;\r\n      than.step = than.flowdata.getNode(than.stepid);\r\n      if(than.flowdata.nodes.size()>0){\r\n        than.flowdata.nodes.each(function (nodeId,node,index){\r\n          if(than.step.checkNextNodeIsAllow(\"nextNodeId\",node.id)){\r\n            than.nextNodeIdList.push({value:node.id,text:[node.id]+'-' + node.getText()})\r\n          }\r\n        })\r\n      }\r\n\r\n      this.initStep(than.step);\r\n    },\r\n    initStep(step) {\r\n      var than=this;\r\n      if(step==null||step==undefined){\r\n        than.formItem.name='新流程';\r\n        return;\r\n      }\r\n      than.formItem.id=step.id;\r\n      than.formItem.name=step.getText();\r\n      than.formItem.strVariable=step.strVariable;\r\n      than.formItem.dataSource=step.dataSource;\r\n      than.formItem.sort=step.sort;\r\n      than.formItem.describe=step.describe;\r\n\r\n      //跳转节点\r\n      than.ShowNodeResult(\"nextNodeId\",\"#nextNodeId\",1);\r\n      //跳转节点\r\n      // than.ShowNodeResult(\"nextNodeId\",\"#base_NextNodeId\",0);\r\n      window.setTimeout(function (){\r\n        than.formItem.nextNodeId=than.nextNodeIdStr;\r\n      },100)\r\n    },\r\n    btnOk(){\r\n      var than=this;\r\n      var isFormValid = new RoadUI.Validate().validateForm(\"form1\");\r\n      if(this.formItem.replayCount > 10||this.formItem.replayCount <1)\r\n      {\r\n        WFCore.DialogUtils.tipDialog(\"重播次数在1-10之间\",2,7);\r\n        return false;\r\n      }\r\n      this.$refs[\"formItem\"].validate((valid) => {\r\n        if (valid) {\r\n          than.confirm1();\r\n        }\r\n      })\r\n    },\r\n    btnCancel(){\r\n      new RoadUI.Window().close();\r\n    },\r\n    confirm1() {\r\n      var than=this;\r\n\r\n      var ostep={\r\n        text:{\r\n          text:than.formItem.name\r\n        },\r\n        sort:than.formItem.sort,\r\n        describe:than.formItem.describe,\r\n        strVariable:than.formItem.strVariable,\r\n        dataSource:than.formItem.dataSource,\r\n      }\r\n\r\n      //非黑名单跳转节点\r\n      than.SaveNodeResult(\"nextNodeId\",\"#nextNodeId\",\"跳转节点\",1);\r\n\r\n      var playVoices = new parent.WFCore.List();\r\n      var varIndex = 1;\r\n\r\n      window.setTimeout(function (){\r\n        than.step.restore(ostep);\r\n        new RoadUI.Window().close();\r\n      },100)\r\n    },\r\n    //给NodeResult控件赋值\r\n    ShowNodeResult(resultName,nextNodeCtlId,isDefault){\r\n      var than=this;\r\n      if(than.step.getNodeResult(resultName) != null && than.step.getNodeResult(resultName).nextNodeId > 0)\r\n      {\r\n        than.formItem[resultName]=parseInt(than.step.getNodeResult(resultName).nextNodeId);\r\n        than.nextNodeIdStr=parseInt(than.step.getNodeResult(resultName).nextNodeId);\r\n        //$(nextNodeCtlId).val(than.step.getNodeResult(resultName).nextNodeId+\"\");\r\n      }\r\n      // isDefault = isDefault != undefined && isDefault != null ? isDefault:0;\r\n      // $(nextNodeCtlId).attr(\"isDefault\",isDefault);\r\n    },\r\n    //保存NodeResult控件所选下一节点\r\n    SaveNodeResult(resultName,nextNodeCtlId,describe,isDefault){\r\n\r\n      var than=this;\r\n      if(than.step.getNodeResult(resultName) != null){\r\n        if(than.formItem.nextNodeId != null && than.formItem.nextNodeId != \"\")\r\n        {\r\n          var nodeResult = than.step.getNodeResult(resultName).restore({\r\n            nextNodeId:isNaN(than.formItem[resultName]) ? 0 : parseInt(than.formItem[resultName]) || 0,\r\n            isDefault:isDefault || 0\r\n          });\r\n          if(nodeResult != null) nodeResult.drawNodeResult();\r\n        }\r\n        else\r\n        {\r\n          than.step.removeNodeResult(resultName);\r\n        }\r\n      }\r\n      else{\r\n        if(than.formItem[resultName] != null && than.formItem[resultName] != \"\")\r\n        {\r\n          var nodeResult = than.step.createNodeResult({\r\n            name:resultName,\r\n            nextNodeId:isNaN(than.formItem[resultName]) ? 0 : parseInt(than.formItem[resultName]) || 0,\r\n            isDefault:isDefault || 0,\r\n            describe:describe\r\n          });\r\n          if(nodeResult != null) nodeResult.drawNodeResult();\r\n        }\r\n      }\r\n    },\r\n    //\r\n    selVoiceListItem(i){\r\n      this.selIndex=i;\r\n    },\r\n    selProcessVariablesVisible(v){\r\n      this.processVariablesVisible=true;\r\n      this.selProcessVariablesType=v;\r\n    },\r\n    btnProcessVariables(){\r\n      if(this.selProcessVariablesType=='str'){\r\n        this.formItem.strVariable=this.$refs.getProcessVariablesVisible.selectRadioItem.name;\r\n      }else {\r\n        this.formItem.dataSourceList.push(this.$refs.getProcessVariablesVisible.selectRadioItem.name);\r\n      }\r\n\r\n      this.processVariablesVisible=false;\r\n    },\r\n    ChangeDataSource(v){\r\n      var arr0=[];\r\n      var arr1=[],\r\n          arr0=v.split(\"{\");//字符分割\r\n      arr0.forEach(function (v,i,arr){\r\n        if(v.toString()!=\"{}\"&&v.toString()!=''){\r\n          var str=v;\r\n          if(str.substring(0,1)==\"{\"){\r\n            str=str.replace(\"{\",'');\r\n          }\r\n          if(str.substring(str.length-1)==\"}\"){\r\n            str=str.replace(\"}\",'');\r\n          }\r\n          arr1.push(str)\r\n        }\r\n      })\r\n      this.formItem.dataSourceList=arr1;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init()\r\n  },\r\n  watch:{\r\n    'formItem.dataSourceList':{\r\n      handler(v){\r\n        var str='';\r\n        v.forEach(function (v,i,arr){\r\n          str+=\"{\"+v+\"}\"\r\n        });\r\n        this.formItem.dataSource=str;\r\n      },\r\n      deep:true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.ui-combination-form{\r\n  .ui-voiceList{\r\n    .ui-voiceList-item{\r\n      text-align: left;\r\n      .ivu-form-item-label{\r\n        border: 1px solid red !important;\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n</style>"]}]}