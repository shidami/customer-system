{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\xboot-vue-template\\excel\\excel.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\xboot-vue-template\\excel\\excel.vue","mtime":1614579763461},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDmqKHniYjlr7zlhaXmlofku7booajmlbDmja4NCmltcG9ydCB7IHVzZXJDb2x1bW5zLCB1c2VyRGF0YSB9IGZyb20gIkAvbGlicy9pbXBvcnRUZW1wbGF0ZSI7DQovLyBleGNlbOi9rOaNouW3peWFt+exuw0KaW1wb3J0IGV4Y2VsIGZyb20gIkAvbGlicy9leGNlbCI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJleGNlbCIsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG9wZW5UaXA6IHRydWUsIC8vIOaYvuekuuaPkOekug0KICAgICAgcmVhZGluZzogZmFsc2UsIC8vIOivu+WPluS4rQ0KICAgICAgaGVpZ2h0OiA1MTAsIC8vIOmrmOW6pg0KICAgICAgbG9hZGluZzogdHJ1ZSwgLy8g6KGo5Y2V5Yqg6L2954q25oCBDQogICAgICBpbXBvcnRMb2FkaW5nOiBmYWxzZSwgLy8g5a+85YWl5Yqg6L2954q25oCBDQogICAgICBsb2FkaW5nRXhwb3J0OiB0cnVlLCAvLyDlr7zlh7rliqDovb3nirbmgIENCiAgICAgIGV4cG9ydE1vZGFsVmlzaWJsZTogZmFsc2UsIC8vIOiHquWumuS5ieWvvOWHuuaYvuekug0KICAgICAgaW1wb3J0TW9kYWxWaXNpYmxlOiBmYWxzZSwgLy8g5a+85YWl5pi+56S6DQogICAgICBzZWxlY3RDb3VudDogMCwgLy8g5aSa6YCJ6K6h5pWwDQogICAgICBzZWxlY3RMaXN0OiBbXSwgLy8g5aSa6YCJ5pWw5o2uDQogICAgICBzZWFyY2hGb3JtOiB7DQogICAgICAgIHBhZ2VOdW1iZXI6IDEsDQogICAgICAgIHBhZ2VTaXplOiAxMCwNCiAgICAgICAgc29ydDogImNyZWF0ZVRpbWUiLA0KICAgICAgICBvcmRlcjogImRlc2MiDQogICAgICB9LA0KICAgICAgY29sdW1uczogWw0KICAgICAgICAvLyDooajlpLQNCiAgICAgICAgew0KICAgICAgICAgIHR5cGU6ICJzZWxlY3Rpb24iLA0KICAgICAgICAgIHdpZHRoOiA2MCwNCiAgICAgICAgICBhbGlnbjogImNlbnRlciINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHR5cGU6ICJpbmRleCIsDQogICAgICAgICAgd2lkdGg6IDYwLA0KICAgICAgICAgIGFsaWduOiAiY2VudGVyIg0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLlkI3np7AiLA0KICAgICAgICAgIGtleTogIm5hbWUiLA0KICAgICAgICAgIHNvcnRhYmxlOiB0cnVlDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0aXRsZTogIuaJi+acuiIsDQogICAgICAgICAga2V5OiAibW9iaWxlIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLliJvlu7rml7bpl7QiLA0KICAgICAgICAgIGtleTogImNyZWF0ZVRpbWUiLA0KICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLA0KICAgICAgICAgIHNvcnRUeXBlOiAiZGVzYyINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHRpdGxlOiAi5pu05paw5pe26Ze0IiwNCiAgICAgICAgICBrZXk6ICJ1cGRhdGVUaW1lIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLmk43kvZwiLA0KICAgICAgICAgIGtleTogImFjdGlvbiIsDQogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLA0KICAgICAgICAgIHdpZHRoOiAyMDAsDQogICAgICAgICAgcmVuZGVyOiAoaCwgcGFyYW1zKSA9PiB7DQogICAgICAgICAgICByZXR1cm4gaCgiZGl2IiwgWw0KICAgICAgICAgICAgICBoKA0KICAgICAgICAgICAgICAgICJCdXR0b24iLA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgIHByb3BzOiB7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJwcmltYXJ5IiwNCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogInNtYWxsIiwNCiAgICAgICAgICAgICAgICAgICAgaWNvbjogImlvcy1jcmVhdGUtb3V0bGluZSINCiAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICBzdHlsZTogew0KICAgICAgICAgICAgICAgICAgICBtYXJnaW5SaWdodDogIjVweCINCiAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuaW5mbygi54K55Ye75LqG57yW6L6RIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICLnvJbovpEiDQogICAgICAgICAgICAgICksDQogICAgICAgICAgICAgIGgoDQogICAgICAgICAgICAgICAgIkJ1dHRvbiIsDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgcHJvcHM6IHsNCiAgICAgICAgICAgICAgICAgICAgdHlwZTogImVycm9yIiwNCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogInNtYWxsIiwNCiAgICAgICAgICAgICAgICAgICAgaWNvbjogIm1kLXRyYXNoIg0KICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgIG9uOiB7DQogICAgICAgICAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5pbmZvKCLngrnlh7vkuobliKDpmaQiKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIuWIoOmZpCINCiAgICAgICAgICAgICAgKQ0KICAgICAgICAgICAgXSk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgZXhwb3J0Q29sdW1uczogWw0KICAgICAgICAvLyDlr7zlh7rliJcNCiAgICAgICAgew0KICAgICAgICAgIHRpdGxlOiAi5ZCN56ewIiwNCiAgICAgICAgICBrZXk6ICJuYW1lIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLmiYvmnLoiLA0KICAgICAgICAgIGtleTogIm1vYmlsZSIsDQogICAgICAgICAgc29ydGFibGU6IHRydWUNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHRpdGxlOiAi5Yib5bu65pe26Ze0IiwNCiAgICAgICAgICBrZXk6ICJjcmVhdGVUaW1lIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwNCiAgICAgICAgICBzb3J0VHlwZTogImRlc2MiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0aXRsZTogIuabtOaWsOaXtumXtCIsDQogICAgICAgICAga2V5OiAidXBkYXRlVGltZSIsDQogICAgICAgICAgc29ydGFibGU6IHRydWUNCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgIGNob29zZUNvbHVtbnM6IFtdLA0KICAgICAgZmlsZW5hbWU6ICLmlbDmja4iLA0KICAgICAgZXhwb3J0VGl0bGU6ICLnoa7orqTlr7zlh7oiLA0KICAgICAgZXhwb3J0VHlwZTogIiIsDQogICAgICBpbXBvcnRUYWJsZURhdGE6IFtdLA0KICAgICAgaW1wb3J0Q29sdW1uczogW10sDQogICAgICB1cGxvYWRmaWxlOiB7DQogICAgICAgIG5hbWU6ICIiDQogICAgICB9LA0KICAgICAgdGVtcENvbHVtbnM6IHVzZXJDb2x1bW5zLA0KICAgICAgdGVtcERhdGE6IHVzZXJEYXRhLA0KICAgICAgZGF0YTogW10sDQogICAgICBleHBvcnREYXRhOiBbXSwNCiAgICAgIHRvdGFsOiAwDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGluaXQoKSB7DQogICAgICB0aGlzLmdldERhdGFMaXN0KCk7DQogICAgICAvLyDliJ3lp4vljJblr7zlh7rliJfmlbDmja4NCiAgICAgIGxldCBhcnJheSA9IFtdOw0KICAgICAgdGhpcy5leHBvcnRDb2x1bW5zLmZvckVhY2goZSA9PiB7DQogICAgICAgIC8vIOaMh+WumuWIl+mZkOWItuadg+mZkA0KICAgICAgICBpZiAoDQogICAgICAgICAgIXRoaXMuZ2V0U3RvcmUoInJvbGVzIikuaW5jbHVkZXMoIlJPTEVfQURNSU4iKSAmJg0KICAgICAgICAgIGUua2V5ID09ICJtb2JpbGUiDQogICAgICAgICkgew0KICAgICAgICAgIGUudGl0bGUgPSAiW+aXoOadg+WvvOWHul0gIiArIGUudGl0bGU7DQogICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgZS5kaXNhYmxlZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgICAgIGFycmF5LnB1c2goZS50aXRsZSk7DQogICAgICB9KTsNCiAgICAgIHRoaXMuY2hvb3NlQ29sdW1ucyA9IGFycmF5Ow0KICAgIH0sDQogICAgY2hhbmdlUGFnZSh2KSB7DQogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZU51bWJlciA9IHY7DQogICAgICB0aGlzLmdldERhdGFMaXN0KCk7DQogICAgICB0aGlzLmNsZWFyU2VsZWN0QWxsKCk7DQogICAgfSwNCiAgICBjaGFuZ2VQYWdlU2l6ZSh2KSB7DQogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZVNpemUgPSB2Ow0KICAgICAgdGhpcy5nZXREYXRhTGlzdCgpOw0KICAgIH0sDQogICAgc2VsZWN0RGF0ZVJhbmdlKHYpIHsNCiAgICAgIGlmICh2KSB7DQogICAgICAgIHRoaXMuc2VhcmNoRm9ybS5zdGFydERhdGUgPSB2WzBdOw0KICAgICAgICB0aGlzLnNlYXJjaEZvcm0uZW5kRGF0ZSA9IHZbMV07DQogICAgICB9DQogICAgfSwNCiAgICBnZXREYXRhTGlzdCgpIHsNCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7DQogICAgICBsZXQgcGFyYW1zID0gew0KICAgICAgICBwYWdlTnVtYmVyOiB0aGlzLnBhZ2VOdW1iZXIsDQogICAgICAgIHBhZ2VTaXplOiB0aGlzLnBhZ2VTaXplLA0KICAgICAgICBzb3J0OiB0aGlzLnNvcnRDb2x1bW4sDQogICAgICAgIG9yZGVyOiB0aGlzLnNvcnRUeXBlDQogICAgICB9Ow0KICAgICAgLy8g6K+35rGC5ZCO56uv6I635Y+W6KGo5Y2V5pWw5o2uIOivt+iHquihjOS/ruaUueaOpeWPow0KICAgICAgLy8gdGhpcy5nZXRSZXF1ZXN0KCLor7fmsYLot6/lvoQiLCBwYXJhbXMpLnRoZW4ocmVzID0+IHsNCiAgICAgIC8vICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgICAvLyAgIGlmIChyZXMuc3VjY2Vzcykgew0KICAgICAgLy8gICAgIHRoaXMuZGF0YSA9IHJlcy5yZXN1bHQuY29udGVudDsNCiAgICAgIC8vICAgICB0aGlzLnRvdGFsID0gcmVzLnJlc3VsdC50b3RhbEVsZW1lbnRzOw0KICAgICAgLy8gICB9DQogICAgICAvLyB9KTsNCiAgICAgIC8vIOS7peS4i+S4uuaooeaLn+aVsOaNrg0KICAgICAgdGhpcy5kYXRhID0gWw0KICAgICAgICB7DQogICAgICAgICAgaWQ6ICIxIiwNCiAgICAgICAgICBuYW1lOiAiWEJvb3QiLA0KICAgICAgICAgIG1vYmlsZTogIjEyMzQ1Njc4OTAxIiwNCiAgICAgICAgICBjcmVhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIsDQogICAgICAgICAgdXBkYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAiDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBpZDogIjIiLA0KICAgICAgICAgIG5hbWU6ICJFeHJpY2siLA0KICAgICAgICAgIG1vYmlsZTogIjEyMzQ1Njc4OTAxIiwNCiAgICAgICAgICBjcmVhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIsDQogICAgICAgICAgdXBkYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAiDQogICAgICAgIH0NCiAgICAgIF07DQogICAgICB0aGlzLnRvdGFsID0gdGhpcy5kYXRhLmxlbmd0aDsNCiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgIH0sDQogICAgaGFuZGxlU2VhcmNoKCkgew0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VOdW1iZXIgPSAxOw0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VTaXplID0gMTA7DQogICAgICB0aGlzLmdldERhdGFMaXN0KCk7DQogICAgfSwNCiAgICBoYW5kbGVSZXNldCgpIHsNCiAgICAgIHRoaXMuJHJlZnMuc2VhcmNoRm9ybS5yZXNldEZpZWxkcygpOw0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VOdW1iZXIgPSAxOw0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VTaXplID0gMTA7DQogICAgICAvLyDph43mlrDliqDovb3mlbDmja4NCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICB9LA0KICAgIGNoYW5nZVNvcnQoZSkgew0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnNvcnQgPSBlLmtleTsNCiAgICAgIHRoaXMuc2VhcmNoRm9ybS5vcmRlciA9IGUub3JkZXI7DQogICAgICBpZiAoZS5vcmRlciA9PSAibm9ybWFsIikgew0KICAgICAgICB0aGlzLnNlYXJjaEZvcm0ub3JkZXIgPSAiIjsNCiAgICAgIH0NCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICB9LA0KICAgIGV4cG9ydFNlbGVjdERhdGEoKSB7DQogICAgICBpZiAodGhpcy5zZWxlY3RDb3VudCA8PSAwKSB7DQogICAgICAgIHRoaXMuJE1lc3NhZ2Uud2FybmluZygi5oKo6L+Y5pyq6YCJ5oup6KaB5a+85Ye655qE5pWw5o2uIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIHRoaXMuZXhwb3J0VHlwZSA9ICJwYXJ0IjsNCiAgICAgIHRoaXMuZXhwb3J0TW9kYWxWaXNpYmxlID0gdHJ1ZTsNCiAgICAgIHRoaXMuZXhwb3J0VGl0bGUgPSAi56Gu6K6k5a+85Ye6ICIgKyB0aGlzLnNlbGVjdENvdW50ICsgIiDmnaHmlbDmja4iOw0KICAgIH0sDQogICAgZXhwb3J0QWxsKCkgew0KICAgICAgdGhpcy5leHBvcnRUeXBlID0gImFsbCI7DQogICAgICB0aGlzLmV4cG9ydE1vZGFsVmlzaWJsZSA9IHRydWU7DQogICAgICB0aGlzLmV4cG9ydFRpdGxlID0gIuehruiupOWvvOWHuuWFqOmDqCAiICsgdGhpcy50b3RhbCArICIg5p2h5pWw5o2uIjsNCiAgICAgIC8vIOivt+axguWQjuerr+iOt+WPluWFqOmDqOaVsOaNriDor7foh6rooYzkv67mlLnmjqXlj6MNCiAgICAgIC8vIHRoaXMuZ2V0UmVxdWVzdCgi6K+35rGC6Lev5b6EIiwgcGFyYW1zKS50aGVuKHJlcyA9PiB7DQogICAgICAvLyAgIGlmIChyZXMuc3VjY2Vzcykgew0KICAgICAgLy8gICAgIHRoaXMuZXhwb3J0RGF0YSA9IHJlcy5yZXN1bHQ7DQogICAgICAvLyAgIH0NCiAgICAgIC8vIH0pOw0KICAgICAgLy8g5Lul5LiL5Li65qih5ouf5pWw5o2uDQogICAgICB0aGlzLmV4cG9ydERhdGEgPSBbDQogICAgICAgIHsNCiAgICAgICAgICBpZDogIjEiLA0KICAgICAgICAgIG5hbWU6ICJYQm9vdCIsDQogICAgICAgICAgbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLA0KICAgICAgICAgIGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwNCiAgICAgICAgICB1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCINCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGlkOiAiMiIsDQogICAgICAgICAgbmFtZTogIkV4cmljayIsDQogICAgICAgICAgbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLA0KICAgICAgICAgIGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwNCiAgICAgICAgICB1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCINCiAgICAgICAgfQ0KICAgICAgXTsNCiAgICB9LA0KICAgIGV4cG9ydEN1c3RvbURhdGEoKSB7DQogICAgICBpZiAodGhpcy5maWxlbmFtZSA9PSAiIikgew0KICAgICAgICB0aGlzLmZpbGVuYW1lID0gIueUqOaIt+aVsOaNriI7DQogICAgICB9DQogICAgICAvLyDliKTmlq3li77pgInlr7zlh7rliJcNCiAgICAgIGxldCBhcnJheSA9IFtdOw0KICAgICAgdGhpcy5leHBvcnRDb2x1bW5zLmZvckVhY2goZSA9PiB7DQogICAgICAgIHRoaXMuY2hvb3NlQ29sdW1ucy5mb3JFYWNoKGMgPT4gew0KICAgICAgICAgIGlmIChlLnRpdGxlID09IGMgJiYgIWUuZGlzYWJsZWQpIHsNCiAgICAgICAgICAgIGFycmF5LnB1c2goZSk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgICAgdGhpcy5leHBvcnRDb2x1bW5zID0gYXJyYXk7DQogICAgICB0aGlzLmV4cG9ydE1vZGFsVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgbGV0IHRpdGxlID0gW107DQogICAgICBsZXQga2V5ID0gW107DQogICAgICB0aGlzLmV4cG9ydENvbHVtbnMuZm9yRWFjaChlID0+IHsNCiAgICAgICAgdGl0bGUucHVzaChlLnRpdGxlKTsNCiAgICAgICAga2V5LnB1c2goZS5rZXkpOw0KICAgICAgfSk7DQogICAgICBjb25zdCBwYXJhbXMgPSB7DQogICAgICAgIHRpdGxlOiB0aXRsZSwNCiAgICAgICAga2V5OiBrZXksDQogICAgICAgIGRhdGE6IHRoaXMuZXhwb3J0RGF0YSwNCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLA0KICAgICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZQ0KICAgICAgfTsNCiAgICAgIGV4Y2VsLmV4cG9ydF9hcnJheV90b19leGNlbChwYXJhbXMpOw0KICAgIH0sDQogICAgYmVmb3JlVXBsb2FkSW1wb3J0KGZpbGUpIHsNCiAgICAgIHRoaXMudXBsb2FkZmlsZSA9IGZpbGU7DQogICAgICBjb25zdCBmaWxlRXh0ID0gZmlsZS5uYW1lDQogICAgICAgIC5zcGxpdCgiLiIpDQogICAgICAgIC5wb3AoKQ0KICAgICAgICAudG9Mb2NhbGVMb3dlckNhc2UoKTsNCiAgICAgIGlmIChmaWxlRXh0ID09ICJ4bHN4IiB8fCBmaWxlRXh0ID09ICJ4bHMiKSB7DQogICAgICAgIHRoaXMucmVhZEZpbGUoZmlsZSk7DQogICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiROb3RpY2Uud2FybmluZyh7DQogICAgICAgICAgdGl0bGU6ICLmlofku7bnsbvlnovplJnor68iLA0KICAgICAgICAgIGRlc2M6DQogICAgICAgICAgICAi5omA6YCJ5paH5Lu24oCYICIgKw0KICAgICAgICAgICAgZmlsZS5uYW1lICsNCiAgICAgICAgICAgICIg4oCZ5LiN5pivRVhDRUzmlofku7bvvIzor7fpgInmi6nlkI7nvIDkuLoueGxzeOaIluiAhS54bHPnmoRFWENFTOaWh+S7tuOAgiINCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfSwNCiAgICAvLyDor7vlj5bmlofku7YNCiAgICByZWFkRmlsZShmaWxlKSB7DQogICAgICB0aGlzLnJlYWRpbmcgPSB0cnVlOw0KICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihmaWxlKTsNCiAgICAgIHJlYWRlci5vbmVycm9yID0gZSA9PiB7DQogICAgICAgIHRoaXMucmVhZGluZyA9IGZhbHNlOw0KICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCLmlofku7bor7vlj5blh7rplJkiKTsNCiAgICAgIH07DQogICAgICByZWFkZXIub25sb2FkID0gZSA9PiB7DQogICAgICAgIGNvbnN0IGRhdGEgPSBlLnRhcmdldC5yZXN1bHQ7DQogICAgICAgIGNvbnN0IHsgaGVhZGVyLCByZXN1bHRzIH0gPSBleGNlbC5yZWFkKGRhdGEsICJhcnJheSIpOw0KICAgICAgICBjb25zdCB0YWJsZVRpdGxlID0gaGVhZGVyLm1hcChpdGVtID0+IHsNCiAgICAgICAgICByZXR1cm4geyB0aXRsZTogaXRlbSwga2V5OiBpdGVtLCBtaW5XaWR0aDogMTAwLCBhbGlnbjogImNlbnRlciIgfTsNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMuaW1wb3J0VGFibGVEYXRhID0gcmVzdWx0czsNCiAgICAgICAgdGhpcy5pbXBvcnRDb2x1bW5zID0gdGFibGVUaXRsZTsNCiAgICAgICAgdGhpcy5yZWFkaW5nID0gZmFsc2U7DQogICAgICAgIHRoaXMuJE1lc3NhZ2Uuc3VjY2Vzcygi6K+75Y+W5pWw5o2u5oiQ5YqfIik7DQogICAgICB9Ow0KICAgIH0sDQogICAgZG93bmxvYWRUZW1wbGUoKSB7DQogICAgICBsZXQgdGl0bGUgPSBbXTsNCiAgICAgIGxldCBrZXkgPSBbXTsNCiAgICAgIHVzZXJDb2x1bW5zLmZvckVhY2goZSA9PiB7DQogICAgICAgIHRpdGxlLnB1c2goZS50aXRsZSk7DQogICAgICAgIGtleS5wdXNoKGUua2V5KTsNCiAgICAgIH0pOw0KICAgICAgY29uc3QgcGFyYW1zID0gew0KICAgICAgICB0aXRsZTogdGl0bGUsDQogICAgICAgIGtleToga2V5LA0KICAgICAgICBkYXRhOiB1c2VyRGF0YSwNCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLA0KICAgICAgICBmaWxlbmFtZTogIuWvvOWFpeaVsOaNruaooeeJiCINCiAgICAgIH07DQogICAgICBleGNlbC5leHBvcnRfYXJyYXlfdG9fZXhjZWwocGFyYW1zKTsNCiAgICB9LA0KICAgIGltcG9ydERhdGEoKSB7DQogICAgICB0aGlzLmltcG9ydExvYWRpbmcgPSB0cnVlOw0KICAgICAgLy8g5Lyg5YWl5a+85YWl5pWw5o2uIOWQjuerr+aOpeaUtmJvZHnmlbDnu4TliJfooajmibnph4/lr7zlhaUNCiAgICAgIC8vIHRoaXMuaW1wb3J0UmVxdWVzdCgi6K+35rGC6Lev5b6EIiwgdGhpcy5pbXBvcnRUYWJsZURhdGEpLnRoZW4ocmVzID0+IHsNCiAgICAgIC8vICAgdGhpcy5pbXBvcnRMb2FkaW5nID0gZmFsc2U7DQogICAgICAvLyAgIGlmIChyZXMuc3VjY2Vzcykgew0KICAgICAgLy8gICAgIHRoaXMuaW1wb3J0TW9kYWxWaXNpYmxlID0gZmFsc2U7DQogICAgICAvLyAgICAgdGhpcy5nZXREYXRhTGlzdCgpOw0KICAgICAgLy8gICAgIHRoaXMuJE1vZGFsLmluZm8oew0KICAgICAgLy8gICAgICAgdGl0bGU6ICLlr7zlhaXnu5PmnpwiLA0KICAgICAgLy8gICAgICAgY29udGVudDogcmVzLm1lc3NhZ2UNCiAgICAgIC8vICAgICB9KTsNCiAgICAgIC8vICAgfQ0KICAgICAgLy8gfSk7DQogICAgICAvLyDmqKHmi5/or7fmsYLmiJDlip8NCiAgICAgIHRoaXMuaW1wb3J0TG9hZGluZyA9IGZhbHNlOw0KICAgICAgdGhpcy5pbXBvcnRNb2RhbFZpc2libGUgPSBmYWxzZTsNCiAgICAgIHRoaXMuJE1vZGFsLmluZm8oew0KICAgICAgICB0aXRsZTogIuWvvOWFpee7k+aenCIsDQogICAgICAgIGNvbnRlbnQ6ICLlr7zlhaXmiJDlip/vvIzov5nmmK/lgYfpgJrnn6UiDQogICAgICB9KTsNCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICB9LA0KICAgIHNob3dTZWxlY3QoZSkgew0KICAgICAgdGhpcy5leHBvcnREYXRhID0gZTsNCiAgICAgIHRoaXMuc2VsZWN0TGlzdCA9IGU7DQogICAgICB0aGlzLnNlbGVjdENvdW50ID0gZS5sZW5ndGg7DQogICAgfSwNCiAgICBjbGVhclNlbGVjdEFsbCgpIHsNCiAgICAgIHRoaXMuJHJlZnMudGFibGUuc2VsZWN0QWxsKGZhbHNlKTsNCiAgICB9LA0KICAgIGNsZWFySW1wb3J0RGF0YSgpIHsNCiAgICAgIHRoaXMuaW1wb3J0VGFibGVEYXRhID0gW107DQogICAgICB0aGlzLmltcG9ydENvbHVtbnMgPSBbXTsNCiAgICAgIHRoaXMudXBsb2FkZmlsZSA9IHt9Ow0KICAgIH0NCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICAvLyDorqHnrpfpq5jluqYNCiAgICB0aGlzLmhlaWdodCA9IE51bWJlcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMjMwKTsNCiAgICB0aGlzLmluaXQoKTsNCiAgfQ0KfTsNCg=="},{"version":3,"sources":["excel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"excel.vue","sourceRoot":"src/views/xboot-vue-template/excel","sourcesContent":["<style lang=\"less\">\r\n@import \"../../../styles/table-common.less\";\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n    <Card>\r\n      <Row class=\"operation\">\r\n        <Button @click=\"exportSelectData\" icon=\"md-cloud-upload\">导出所选数据</Button>\r\n        <Button @click=\"exportAll\" icon=\"ios-cloud-upload\">导出全部数据</Button>\r\n        <Button @click=\"importModalVisible=true\" icon=\"ios-download\">导入数据</Button>\r\n        <Button type=\"dashed\" @click=\"openTip=!openTip\">{{openTip ? \"关闭提示\" : \"开启提示\"}}</Button>\r\n      </Row>\r\n      <Row v-show=\"openTip && selectCount > 0\">\r\n        <Alert show-icon>\r\n          已选择\r\n          <span class=\"select-count\">{{selectCount}}</span> 项\r\n          <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\r\n        </Alert>\r\n      </Row>\r\n      <Row>\r\n        <Table\r\n          :loading=\"loading\"\r\n          border\r\n          :columns=\"columns\"\r\n          :data=\"data\"\r\n          sortable=\"custom\"\r\n          @on-sort-change=\"changeSort\"\r\n          @on-selection-change=\"showSelect\"\r\n          ref=\"table\"\r\n        ></Table>\r\n      </Row>\r\n      <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n        <Page\r\n          :current=\"searchForm.pageNumber\"\r\n          :total=\"total\"\r\n          :page-size=\"searchForm.pageSize\"\r\n          @on-change=\"changePage\"\r\n          @on-page-size-change=\"changePageSize\"\r\n          :page-size-opts=\"[10,20,50]\"\r\n          size=\"small\"\r\n          show-total\r\n          show-elevator\r\n          show-sizer\r\n        ></Page>\r\n      </Row>\r\n    </Card>\r\n\r\n    <!-- 自定义导出数据 -->\r\n    <Modal\r\n      v-model=\"exportModalVisible\"\r\n      :title=\"exportTitle\"\r\n      :loading=\"loadingExport\"\r\n      @on-ok=\"exportCustomData\"\r\n    >\r\n      <Form ref=\"exportForm\" :label-width=\"100\">\r\n        <FormItem label=\"导出文件名\">\r\n          <Input v-model=\"filename\" />\r\n        </FormItem>\r\n        <FormItem label=\"自定义导出列\">\r\n          <CheckboxGroup v-model=\"chooseColumns\">\r\n            <Checkbox\r\n              v-for=\"(item, i) in exportColumns\"\r\n              :label=\"item.title\"\r\n              :key=\"i\"\r\n              :value=\"item.checked\"\r\n              :disabled=\"item.disabled\"\r\n            ></Checkbox>\r\n          </CheckboxGroup>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n    <Drawer title=\"导入数据\" closable v-model=\"importModalVisible\" width=\"1000\">\r\n      <div style=\"display:flex;justify-content: space-between;align-items: center;\">\r\n        <Upload action :before-upload=\"beforeUploadImport\" accept=\".xls, .xlsx\">\r\n          <Button\r\n            :loading=\"reading\"\r\n            icon=\"ios-cloud-upload-outline\"\r\n            style=\"margin-right:10px\"\r\n          >上传Excel文件</Button>\r\n          <span v-if=\"uploadfile.name\">当前选择文件：{{ uploadfile.name }}</span>\r\n        </Upload>\r\n        <Button @click=\"clearImportData\" icon=\"md-trash\">清空数据</Button>\r\n      </div>\r\n      <Alert type=\"warning\" show-icon>导入前请下载查看导入模版数据文件，确保数据格式正确，不得修改列英文名称。</Alert>\r\n      <Table\r\n        :columns=\"importColumns\"\r\n        border\r\n        :height=\"height\"\r\n        :data=\"importTableData\"\r\n        ref=\"importTable\"\r\n      ></Table>\r\n      <div class=\"drawer-footer\">\r\n        <Button @click=\"downloadTemple\" type=\"info\" style=\"position:absolute;left:15px;\">下载导入模板</Button>\r\n        <Button @click=\"importModalVisible=false\">关闭</Button>\r\n        <Button\r\n          :loading=\"importLoading\"\r\n          :disabled=\"importTableData.length<=0\"\r\n          @click=\"importData\"\r\n          style=\"margin-left:5px\"\r\n          type=\"primary\"\r\n        >\r\n          确认导入\r\n          <span v-if=\"importTableData.length>0\">{{importTableData.length}} 条数据</span>\r\n        </Button>\r\n      </div>\r\n    </Drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 模版导入文件表数据\r\nimport { userColumns, userData } from \"@/libs/importTemplate\";\r\n// excel转换工具类\r\nimport excel from \"@/libs/excel\";\r\nexport default {\r\n  name: \"excel\",\r\n  data() {\r\n    return {\r\n      openTip: true, // 显示提示\r\n      reading: false, // 读取中\r\n      height: 510, // 高度\r\n      loading: true, // 表单加载状态\r\n      importLoading: false, // 导入加载状态\r\n      loadingExport: true, // 导出加载状态\r\n      exportModalVisible: false, // 自定义导出显示\r\n      importModalVisible: false, // 导入显示\r\n      selectCount: 0, // 多选计数\r\n      selectList: [], // 多选数据\r\n      searchForm: {\r\n        pageNumber: 1,\r\n        pageSize: 10,\r\n        sort: \"createTime\",\r\n        order: \"desc\"\r\n      },\r\n      columns: [\r\n        // 表头\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          type: \"index\",\r\n          width: 60,\r\n          align: \"center\"\r\n        },\r\n        {\r\n          title: \"名称\",\r\n          key: \"name\",\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\"\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"action\",\r\n          align: \"center\",\r\n          width: 200,\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\r\n                \"Button\",\r\n                {\r\n                  props: {\r\n                    type: \"primary\",\r\n                    size: \"small\",\r\n                    icon: \"ios-create-outline\"\r\n                  },\r\n                  style: {\r\n                    marginRight: \"5px\"\r\n                  },\r\n                  on: {\r\n                    click: () => {\r\n                      this.$Message.info(\"点击了编辑\");\r\n                    }\r\n                  }\r\n                },\r\n                \"编辑\"\r\n              ),\r\n              h(\r\n                \"Button\",\r\n                {\r\n                  props: {\r\n                    type: \"error\",\r\n                    size: \"small\",\r\n                    icon: \"md-trash\"\r\n                  },\r\n                  on: {\r\n                    click: () => {\r\n                      this.$Message.info(\"点击了删除\");\r\n                    }\r\n                  }\r\n                },\r\n                \"删除\"\r\n              )\r\n            ]);\r\n          }\r\n        }\r\n      ],\r\n      exportColumns: [\r\n        // 导出列\r\n        {\r\n          title: \"名称\",\r\n          key: \"name\",\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          sortable: true\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\"\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          sortable: true\r\n        }\r\n      ],\r\n      chooseColumns: [],\r\n      filename: \"数据\",\r\n      exportTitle: \"确认导出\",\r\n      exportType: \"\",\r\n      importTableData: [],\r\n      importColumns: [],\r\n      uploadfile: {\r\n        name: \"\"\r\n      },\r\n      tempColumns: userColumns,\r\n      tempData: userData,\r\n      data: [],\r\n      exportData: [],\r\n      total: 0\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getDataList();\r\n      // 初始化导出列数据\r\n      let array = [];\r\n      this.exportColumns.forEach(e => {\r\n        // 指定列限制权限\r\n        if (\r\n          !this.getStore(\"roles\").includes(\"ROLE_ADMIN\") &&\r\n          e.key == \"mobile\"\r\n        ) {\r\n          e.title = \"[无权导出] \" + e.title;\r\n          e.disabled = true;\r\n        } else {\r\n          e.disabled = false;\r\n        }\r\n        array.push(e.title);\r\n      });\r\n      this.chooseColumns = array;\r\n    },\r\n    changePage(v) {\r\n      this.searchForm.pageNumber = v;\r\n      this.getDataList();\r\n      this.clearSelectAll();\r\n    },\r\n    changePageSize(v) {\r\n      this.searchForm.pageSize = v;\r\n      this.getDataList();\r\n    },\r\n    selectDateRange(v) {\r\n      if (v) {\r\n        this.searchForm.startDate = v[0];\r\n        this.searchForm.endDate = v[1];\r\n      }\r\n    },\r\n    getDataList() {\r\n      this.loading = true;\r\n      let params = {\r\n        pageNumber: this.pageNumber,\r\n        pageSize: this.pageSize,\r\n        sort: this.sortColumn,\r\n        order: this.sortType\r\n      };\r\n      // 请求后端获取表单数据 请自行修改接口\r\n      // this.getRequest(\"请求路径\", params).then(res => {\r\n      //   this.loading = false;\r\n      //   if (res.success) {\r\n      //     this.data = res.result.content;\r\n      //     this.total = res.result.totalElements;\r\n      //   }\r\n      // });\r\n      // 以下为模拟数据\r\n      this.data = [\r\n        {\r\n          id: \"1\",\r\n          name: \"XBoot\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\"\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"Exrick\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\"\r\n        }\r\n      ];\r\n      this.total = this.data.length;\r\n      this.loading = false;\r\n    },\r\n    handleSearch() {\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      this.getDataList();\r\n    },\r\n    handleReset() {\r\n      this.$refs.searchForm.resetFields();\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      // 重新加载数据\r\n      this.getDataList();\r\n    },\r\n    changeSort(e) {\r\n      this.searchForm.sort = e.key;\r\n      this.searchForm.order = e.order;\r\n      if (e.order == \"normal\") {\r\n        this.searchForm.order = \"\";\r\n      }\r\n      this.getDataList();\r\n    },\r\n    exportSelectData() {\r\n      if (this.selectCount <= 0) {\r\n        this.$Message.warning(\"您还未选择要导出的数据\");\r\n        return;\r\n      }\r\n      this.exportType = \"part\";\r\n      this.exportModalVisible = true;\r\n      this.exportTitle = \"确认导出 \" + this.selectCount + \" 条数据\";\r\n    },\r\n    exportAll() {\r\n      this.exportType = \"all\";\r\n      this.exportModalVisible = true;\r\n      this.exportTitle = \"确认导出全部 \" + this.total + \" 条数据\";\r\n      // 请求后端获取全部数据 请自行修改接口\r\n      // this.getRequest(\"请求路径\", params).then(res => {\r\n      //   if (res.success) {\r\n      //     this.exportData = res.result;\r\n      //   }\r\n      // });\r\n      // 以下为模拟数据\r\n      this.exportData = [\r\n        {\r\n          id: \"1\",\r\n          name: \"XBoot\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\"\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"Exrick\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\"\r\n        }\r\n      ];\r\n    },\r\n    exportCustomData() {\r\n      if (this.filename == \"\") {\r\n        this.filename = \"用户数据\";\r\n      }\r\n      // 判断勾选导出列\r\n      let array = [];\r\n      this.exportColumns.forEach(e => {\r\n        this.chooseColumns.forEach(c => {\r\n          if (e.title == c && !e.disabled) {\r\n            array.push(e);\r\n          }\r\n        });\r\n      });\r\n      this.exportColumns = array;\r\n      this.exportModalVisible = false;\r\n      let title = [];\r\n      let key = [];\r\n      this.exportColumns.forEach(e => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: this.exportData,\r\n        autoWidth: true,\r\n        filename: this.filename\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    beforeUploadImport(file) {\r\n      this.uploadfile = file;\r\n      const fileExt = file.name\r\n        .split(\".\")\r\n        .pop()\r\n        .toLocaleLowerCase();\r\n      if (fileExt == \"xlsx\" || fileExt == \"xls\") {\r\n        this.readFile(file);\r\n        this.file = file;\r\n      } else {\r\n        this.$Notice.warning({\r\n          title: \"文件类型错误\",\r\n          desc:\r\n            \"所选文件‘ \" +\r\n            file.name +\r\n            \" ’不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。\"\r\n        });\r\n      }\r\n      return false;\r\n    },\r\n    // 读取文件\r\n    readFile(file) {\r\n      this.reading = true;\r\n      const reader = new FileReader();\r\n      reader.readAsArrayBuffer(file);\r\n      reader.onerror = e => {\r\n        this.reading = false;\r\n        this.$Message.error(\"文件读取出错\");\r\n      };\r\n      reader.onload = e => {\r\n        const data = e.target.result;\r\n        const { header, results } = excel.read(data, \"array\");\r\n        const tableTitle = header.map(item => {\r\n          return { title: item, key: item, minWidth: 100, align: \"center\" };\r\n        });\r\n        this.importTableData = results;\r\n        this.importColumns = tableTitle;\r\n        this.reading = false;\r\n        this.$Message.success(\"读取数据成功\");\r\n      };\r\n    },\r\n    downloadTemple() {\r\n      let title = [];\r\n      let key = [];\r\n      userColumns.forEach(e => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: userData,\r\n        autoWidth: true,\r\n        filename: \"导入数据模版\"\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    importData() {\r\n      this.importLoading = true;\r\n      // 传入导入数据 后端接收body数组列表批量导入\r\n      // this.importRequest(\"请求路径\", this.importTableData).then(res => {\r\n      //   this.importLoading = false;\r\n      //   if (res.success) {\r\n      //     this.importModalVisible = false;\r\n      //     this.getDataList();\r\n      //     this.$Modal.info({\r\n      //       title: \"导入结果\",\r\n      //       content: res.message\r\n      //     });\r\n      //   }\r\n      // });\r\n      // 模拟请求成功\r\n      this.importLoading = false;\r\n      this.importModalVisible = false;\r\n      this.$Modal.info({\r\n        title: \"导入结果\",\r\n        content: \"导入成功，这是假通知\"\r\n      });\r\n      this.getDataList();\r\n    },\r\n    showSelect(e) {\r\n      this.exportData = e;\r\n      this.selectList = e;\r\n      this.selectCount = e.length;\r\n    },\r\n    clearSelectAll() {\r\n      this.$refs.table.selectAll(false);\r\n    },\r\n    clearImportData() {\r\n      this.importTableData = [];\r\n      this.importColumns = [];\r\n      this.uploadfile = {};\r\n    }\r\n  },\r\n  mounted() {\r\n    // 计算高度\r\n    this.height = Number(document.documentElement.clientHeight - 230);\r\n    this.init();\r\n  }\r\n};\r\n</script>"]}]}