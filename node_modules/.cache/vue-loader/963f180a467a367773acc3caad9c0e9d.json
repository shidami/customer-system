{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\callcenter\\baseLogMessage.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\callcenter\\baseLogMessage.vue","mtime":1614579763221},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICIuLi8uLi9zdHlsZXMvdGFibGUtY29tbW9uLmxlc3MiOw0KQGltcG9ydCAiYmFzZUxvZ01hbmFnZS5sZXNzIjsNCi5uby1tYXJnaW57DQogIG1hcmdpbjogMDsNCiAgICAuaXZ1LWZvcm0taXRlbS1jb250ZW50ew0KICAgICAgbWFyZ2luOiAwICFpbXBvcnRhbnQ7DQogICAgfQ0KICB9DQo="},{"version":3,"sources":["baseLogMessage.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"baseLogMessage.vue","sourceRoot":"src/views/callcenter","sourcesContent":["<style lang=\"less\">\r\n@import \"../../styles/table-common.less\";\r\n@import \"baseLogManage.less\";\r\n.no-margin{\r\n  margin: 0;\r\n    .ivu-form-item-content{\r\n      margin: 0 !important;\r\n    }\r\n  }\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n    <Card>\r\n      <Tabs value=\"name1\">\r\n        <TabPane :label=\"allTitle\"  name=\"name1\" >\r\n          <Row>\r\n            <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"60\" >\r\n              <Form-item label=\"主叫号码\" prop=\"caller\">\r\n                <Input type=\"text\" v-model=\"searchForm.caller\"  clearable style=\"width: 200px\"/>\r\n              </Form-item>\r\n              <Form-item label=\"通话时间\">\r\n                <DatePicker  v-model=\"searchForm.callStartDate\"  type=\"datetime\" format=\"yyyy-MM-dd HH:mm:ss\" style=\"width: 160px\" ></DatePicker>~\r\n                <DatePicker  v-model=\"searchForm.callEndDate\"  type=\"datetime\" format=\"yyyy-MM-dd HH:mm:ss\" style=\"width: 160px\" ></DatePicker>\r\n              </Form-item>\r\n              <Form-item class=\"no-margin br\">\r\n                <Button @click=\"handleSearch\" type=\"primary\" icon=\"ios-search\" >{{ $t(\"search\") }}</Button>\r\n                <Button @click=\"handleReset\">{{ $t(\"reset\") }}</Button>\r\n              </Form-item>\r\n            </Form>\r\n          </Row>\r\n          <Row class=\"operation ui-operation\">\r\n            <div class=\"ui-operation-left\" v-show=\"openTip && selectCount > 0\" >\r\n              <Row class=\"ui-alert-warp\">\r\n                <Alert>\r\n                  已选择\r\n                  <span class=\"select-count\">{{ selectCount }}</span> 项\r\n                  <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\r\n                </Alert>\r\n              </Row>\r\n              <Button @click=\"lockingType\" icon=\"md-add\">锁定</Button>\r\n            </div>\r\n          </Row>\r\n\r\n          <Row>\r\n            <Table :columns=\"columns\" :data=\"tableData\" ref=\"table\" sortable=\"custom\" @on-selection-change=\"showSelect\" @on-row-click=\"showDetail\" ></Table>\r\n          </Row>\r\n          <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n            <Page :current=\"searchForm.pageNumber\"\r\n              :total=\"total\"\r\n              :page-size=\"searchForm.pageSize\"\r\n              @on-change=\"changePage\"\r\n              @on-page-size-change=\"changePageSize\"\r\n              :page-size-opts=\"[10, 20, 50]\"\r\n              size=\"small\"\r\n              show-total\r\n              show-elevator\r\n              show-sizer\r\n            >\r\n            </Page>\r\n          </Row>\r\n        </TabPane>\r\n        <TabPane :label=\"myTitle\" name=\"name2\">\r\n          <publicBaseLogMessage @getMessageList=\"getMessageList\" ref=\"message\"></publicBaseLogMessage>\r\n        </TabPane>\r\n      </Tabs>\r\n    </Card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport {\r\n    getBaseLogMessagePageList,\r\n    updateLockingType\r\n} from \"@/api/index\";\r\nimport util from \"@/libs/util.js\";\r\nimport publicBaseLogMessage from \"@/views/callcenter/publicBaseLogMessage\";\r\nexport default {\r\n  name: \"baselog-manage\",\r\n  components: { publicBaseLogMessage },\r\n  data() {\r\n    return {\r\n        openTip: true,\r\n        selectCount: 0, // 多选计数\r\n        loading: true, // 表单加载状态\r\n        allTitle:\"全部留言\",\r\n        myTitle:\"待我处理\",\r\n        openSearch:false,\r\n        selectList: [],\r\n        columns: [\r\n        {\r\n          title: \"复选框\", //复选框\r\n          type: \"selection\",\r\n          key: 'flag',\r\n          width: 60\r\n        },\r\n        {  title: \"主叫号码\", key: \"caller\", minWidth: 125},\r\n        {  title: \"被叫号码\", key: \"called\", minWidth: 125},\r\n        {  title: \"通话时长\", key: \"duration\", minWidth: 125},\r\n        {  title: \"通话时间\", key: \"beginTimestamp\", minWidth: 125},\r\n        {  title: \"结束时间\", key: \"releasedTimestamp\", minWidth: 125},\r\n        {  title: \"处理状态\", key: \"dealState\", minWidth: 125,\r\n                render:(h,params)=>{\r\n                    var typeObj={0:\"未锁定\",1:\"已锁定\",2:\"已处理\"};\r\n                    return h(\"div\",typeObj[params.row.dealState]);\r\n                }\r\n        },\r\n        {  title: \"处理人\", key: \"nickName\", minWidth: 125},\r\n        {  title: \"处理结果\", key: \"dealResult\", minWidth: 125,\r\n                render:(h,params)=>{\r\n                    var typeObj={0:\"处理失败\",1:\"处理成功\",2:\"未处理\"};\r\n                    return h(\"div\",typeObj[params.row.dealResult]);\r\n                }\r\n        },\r\n        {  title: \"处理时间\", key: \"dealTimestamp\", minWidth: 125},\r\n        {  title: \"备注\", key: \"remark\", minWidth: 125}\r\n      ],\r\n      tableData: [],\r\n      searchForm: {\r\n          pageNumber: 1,\r\n          pageSize: 20,\r\n          sort: \"begin_timestamp\",\r\n          order: \"desc\"\r\n      },\r\n      total: 0\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getMessageList();\r\n    },\r\n    getMessageList() {\r\n        this.loading = false;\r\n        var formData={};\r\n        for(var i in this.searchForm){\r\n            if(this.searchForm[i]!=\"\"&&this.searchForm[i]!=undefined){\r\n                formData[i]=this.searchForm[i];\r\n            }\r\n        }\r\n        getBaseLogMessagePageList(formData).then((res) => {\r\n            if (res.success) {\r\n                this.tableData = res.result.list;\r\n                this.total = res.result.total;\r\n            }\r\n        });\r\n    },\r\n    clearSelectAll() {\r\n      this.$refs.table.selectAll(false);\r\n    },\r\n    showSelect(e) {\r\n      this.selectCount = e.length;\r\n      this.selectList = e;\r\n    },\r\n    changePage(v) {\r\n      this.searchForm.pageNumber = v;\r\n      this.getMessageList();\r\n    },\r\n    changePageSize(v) {\r\n      this.searchForm.pageSize = v;\r\n      this.getMessageList();\r\n    },\r\n    //搜索\r\n    handleSearch() {\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      this.getMessageList();\r\n    },\r\n    //重置\r\n    handleReset() {\r\n      this.$refs.searchForm.resetFields();\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      this.searchForm.callStartDate = \"\";\r\n      this.searchForm.callEndDate = \"\";\r\n      this.getMessageList();\r\n    },\r\n    lockingType() {\r\n        let ids = \"\";\r\n        var flag = true;\r\n        this.selectList.forEach(function (e) {\r\n          if(e.dealState==1 || e.dealState==2){\r\n                  flag = false;\r\n          }\r\n          ids += e.id + \",\";\r\n        });\r\n        if(!flag){\r\n            this.$Message.warning(\"存在已锁定,已处理数据请重新选择。\");\r\n            return;\r\n        }\r\n        ids = ids.substring(0, ids.length - 1);\r\n        updateLockingType({messageId:ids,lockingType:1}).then((res) => {\r\n            if (res.success) {\r\n                 this.$Message.success(\"操作成功\");\r\n                 this.getMessageList();\r\n                 this.$refs.message.getMessageList();\r\n                 this.$refs.table.selectAll(false);\r\n            }\r\n        });\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  watch: {\r\n\r\n  }\r\n};\r\n</script>\r\n"]}]}