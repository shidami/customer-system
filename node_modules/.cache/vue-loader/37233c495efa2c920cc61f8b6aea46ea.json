{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\knowledge\\components\\excelExport.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\knowledge\\components\\excelExport.vue","mtime":1614579763251},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAga25vd2xlZGdlQ29sdW1ucywKfSBmcm9tICJAL2xpYnMvdGFibGVUZW1wbGF0ZS9rbm93bGVkZ2UiOwppbXBvcnQgZXhjZWwgZnJvbSAiQC9saWJzL2V4Y2VsIjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBleHBvcnRNb2RhbFZpc2libGU6IGZhbHNlLAogICAgICBsb2FkaW5nRXhwb3J0OiB0cnVlLAogICAgICBmaWxlbmFtZTogIuefpeivhuW6k+aVsOaNriIsCiAgICAgIGNob29zZUNvbHVtbnM6IFtdLAogICAgICBleHBvcnRDb2x1bW5zOiBbCiAgICAgICAgLy8g5rWL6K+V55So5a+85Ye65YiX5pWw5o2uCiAgICAgICAgLy8ge3RpdGxlOiAi5ZCN56ewIixrZXk6ICJuYW1lIixzb3J0YWJsZTogdHJ1ZX0sCiAgICAgICAgLy8ge3RpdGxlOiAi5omL5py6IixrZXk6ICJtb2JpbGUiLHNvcnRhYmxlOiB0cnVlfSwKICAgICAgICAvLyB7dGl0bGU6ICLliJvlu7rml7bpl7QiLGtleTogImNyZWF0ZVRpbWUiLHNvcnRhYmxlOiB0cnVlLHNvcnRUeXBlOiAiZGVzYyJ9LAogICAgICAgIC8vIHt0aXRsZTogIuabtOaWsOaXtumXtCIsa2V5OiAidXBkYXRlVGltZSIsc29ydGFibGU6IHRydWV9CiAgICAgIF0sCiAgICAgIGV4cG9ydERhdGE6IFsKICAgICAgICAvL+a1i+ivleeUqOWvvOWHuuaVsOaNrgogICAgICAgIC8vIHtpZDogIjEiLG5hbWU6ICJYQm9vdCIsbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIix1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCJ9LAogICAgICAgIC8vIHtpZDogIjIiLG5hbWU6ICJFeHJpY2siLG1vYmlsZTogIjEyMzQ1Njc4OTAxIixjcmVhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIsdXBkYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAifQogICAgICBdLAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgaW5pdCgpIHsKICAgICAgdGhpcy5leHBvcnRDb2x1bW5zPWtub3dsZWRnZUNvbHVtbnMKICAgICAgLy8g5Yid5aeL5YyW5a+85Ye65YiX5pWw5o2uCiAgICAgIGxldCBhcnJheSA9IFtdOwogICAgICB0aGlzLmV4cG9ydENvbHVtbnMuZm9yRWFjaChlID0+IHsKICAgICAgICAvLyDmjIflrprliJfpmZDliLbmnYPpmZAKICAgICAgICBpZiAoCiAgICAgICAgICAhdGhpcy5nZXRTdG9yZSgicm9sZXMiKS5pbmNsdWRlcygiUk9MRV9BRE1JTiIpICYmCiAgICAgICAgICBlLmtleSA9PSAibW9iaWxlIgogICAgICAgICkgewogICAgICAgICAgZS50aXRsZSA9ICJb5peg5p2D5a+85Ye6XSAiICsgZS50aXRsZTsKICAgICAgICAgIGUuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlLmRpc2FibGVkID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGFycmF5LnB1c2goZS50aXRsZSk7CiAgICAgIH0pOwogICAgICB0aGlzLmNob29zZUNvbHVtbnMgPSBhcnJheTsKICAgIH0sCiAgICBleHBvcnRDdXN0b21EYXRhKCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLmV4cG9ydERhdGEpCiAgICAgIGlmICh0aGlzLmZpbGVuYW1lID09ICIiKSB7CiAgICAgICAgdGhpcy5maWxlbmFtZSA9ICLnlKjmiLfmlbDmja4iOwogICAgICB9CiAgICAgIC8vIOWIpOaWreWLvumAieWvvOWHuuWIlwogICAgICBsZXQgYXJyYXkgPSBbXTsKICAgICAgdGhpcy5leHBvcnRDb2x1bW5zLmZvckVhY2goZSA9PiB7CiAgICAgICAgdGhpcy5jaG9vc2VDb2x1bW5zLmZvckVhY2goYyA9PiB7CiAgICAgICAgICBpZiAoZS50aXRsZSA9PSBjICYmICFlLmRpc2FibGVkKSB7CiAgICAgICAgICAgIGFycmF5LnB1c2goZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLmV4cG9ydENvbHVtbnMgPSBhcnJheTsKICAgICAgdGhpcy5leHBvcnRNb2RhbFZpc2libGUgPSBmYWxzZTsKICAgICAgbGV0IHRpdGxlID0gW107CiAgICAgIGxldCBrZXkgPSBbXTsKICAgICAgdGhpcy5leHBvcnRDb2x1bW5zLmZvckVhY2goZSA9PiB7CiAgICAgICAgdGl0bGUucHVzaChlLnRpdGxlKTsKICAgICAgICBrZXkucHVzaChlLmtleSk7CiAgICAgIH0pOwogICAgICBjb25zdCBwYXJhbXMgPSB7CiAgICAgICAgdGl0bGU6IHRpdGxlLAogICAgICAgIGtleToga2V5LAogICAgICAgIGRhdGE6IHRoaXMuZXhwb3J0RGF0YSwKICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUKICAgICAgfTsKICAgICAgZXhjZWwuZXhwb3J0X2FycmF5X3RvX2V4Y2VsKHBhcmFtcyk7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuaW5pdCgpCiAgfQp9Cg=="},{"version":3,"sources":["excelExport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"excelExport.vue","sourceRoot":"src/views/knowledge/components","sourcesContent":["<template>\r\n  <Modal v-model=\"exportModalVisible\" title=\"导出知识\" :loading=\"loadingExport\" @on-ok=\"exportCustomData\">\r\n    <Form ref=\"exportForm\" :label-width=\"100\">\r\n      <FormItem label=\"导出文件名\">\r\n        <Input v-model=\"filename\" />\r\n      </FormItem>\r\n      <FormItem label=\"自定义导出列\">\r\n        <CheckboxGroup v-model=\"chooseColumns\">\r\n          <Checkbox v-for=\"(item,i) in exportColumns\" :label=\"item.title\" :key=\"i\" :disabled=\"item.disabled\"></Checkbox>\r\n        </CheckboxGroup>\r\n      </FormItem>\r\n    </Form>\r\n  </Modal>\r\n</template>\r\n\r\n<script>\r\n  import {\r\n    knowledgeColumns,\r\n  } from \"@/libs/tableTemplate/knowledge\";\r\n  import excel from \"@/libs/excel\";\r\n  export default {\r\n    data() {\r\n      return {\r\n        exportModalVisible: false,\r\n        loadingExport: true,\r\n        filename: \"知识库数据\",\r\n        chooseColumns: [],\r\n        exportColumns: [\r\n          // 测试用导出列数据\r\n          // {title: \"名称\",key: \"name\",sortable: true},\r\n          // {title: \"手机\",key: \"mobile\",sortable: true},\r\n          // {title: \"创建时间\",key: \"createTime\",sortable: true,sortType: \"desc\"},\r\n          // {title: \"更新时间\",key: \"updateTime\",sortable: true}\r\n        ],\r\n        exportData: [\r\n          //测试用导出数据\r\n          // {id: \"1\",name: \"XBoot\",mobile: \"12345678901\",createTime: \"2018-08-08 00:08:00\",updateTime: \"2018-08-08 00:08:00\"},\r\n          // {id: \"2\",name: \"Exrick\",mobile: \"12345678901\",createTime: \"2018-08-08 00:08:00\",updateTime: \"2018-08-08 00:08:00\"}\r\n        ],\r\n      }\r\n    },\r\n    methods: {\r\n      init() {\r\n        this.exportColumns=knowledgeColumns\r\n        // 初始化导出列数据\r\n        let array = [];\r\n        this.exportColumns.forEach(e => {\r\n          // 指定列限制权限\r\n          if (\r\n            !this.getStore(\"roles\").includes(\"ROLE_ADMIN\") &&\r\n            e.key == \"mobile\"\r\n          ) {\r\n            e.title = \"[无权导出] \" + e.title;\r\n            e.disabled = true;\r\n          } else {\r\n            e.disabled = false;\r\n          }\r\n          array.push(e.title);\r\n        });\r\n        this.chooseColumns = array;\r\n      },\r\n      exportCustomData() {\r\n        console.log(this.exportData)\r\n        if (this.filename == \"\") {\r\n          this.filename = \"用户数据\";\r\n        }\r\n        // 判断勾选导出列\r\n        let array = [];\r\n        this.exportColumns.forEach(e => {\r\n          this.chooseColumns.forEach(c => {\r\n            if (e.title == c && !e.disabled) {\r\n              array.push(e);\r\n            }\r\n          });\r\n        });\r\n        this.exportColumns = array;\r\n        this.exportModalVisible = false;\r\n        let title = [];\r\n        let key = [];\r\n        this.exportColumns.forEach(e => {\r\n          title.push(e.title);\r\n          key.push(e.key);\r\n        });\r\n        const params = {\r\n          title: title,\r\n          key: key,\r\n          data: this.exportData,\r\n          autoWidth: true,\r\n          filename: this.filename\r\n        };\r\n        excel.export_array_to_excel(params);\r\n      },\r\n    },\r\n    mounted() {\r\n      this.init()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"]}]}