{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\sys\\out-call\\callTaskManage.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\sys\\out-call\\callTaskManage.vue","mtime":1614579763381},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICJjYWxsVGFza01hbmFnZS5sZXNzIjsNCg=="},{"version":3,"sources":["callTaskManage.vue"],"names":[],"mappings":";AACA","file":"callTaskManage.vue","sourceRoot":"src/views/sys/out-call","sourcesContent":["<style lang=\"less\">\r\n@import \"callTaskManage.less\";\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n      <Card>\r\n          <Row>\r\n              <div style=\"height:100%\">\r\n                  <div class=\"own-space ui-time-schedule-settings\">\r\n                      <Col :xs=\"8\" :sm=\"8\" :md=\"8\" :lg=\"6\" class=\"own-space-left bg-default\">\r\n                          <div class=\"own-header\">\r\n                              <Button type=\"default\" icon=\"md-add\" @click=\"addTask\">添加任务</Button>\r\n                          </div>\r\n                          <Menu :active-name=\"callTaskList[0].id\" class=\"own-space-left-item-box\" style=\"width: 100%\" >\r\n                           \r\n                            <MenuItem\r\n                                :name=\"item.id\"\r\n                                @click.native=\"clickItem(item)\"\r\n                                class=\"own-space-left-item\"\r\n                                :class=\"taskId == item.id ? 'own-space-left-item ivu-menu-item ivu-menu-item-active ivu-menu-item-selected' : ''\"\r\n                                v-for=\"(item, i) in callTaskList\" :key=\"item.id\" \r\n                                :data-name-1=\"i + 1\">\r\n                              <span>{{ item.taskName }}</span>\r\n                              <div class=\"ui-icon-box\">\r\n                                <Icon type=\"ios-create-outline\" @click=\"editTask(item)\" title=\"编辑任务\" @click.stop/>\r\n                                <Icon type=\"ios-trash-outline\"  @click=\"callTaskDelClick(item)\" title=\"删除任务\"  @click.stop/>\r\n                                <Icon type=\"ios-create-outline\" @click=\"editDisplay(item.taskDisplay =='0'?'1':'0','',item.id)\" title=\"显示隐藏\"  @click.stop/>\r\n                                <Icon type=\"ios-create-outline\" @click=\"getResultAll('0',item.id,'0')\" title=\"配置任务营销结果\"  @click.stop/>\r\n                              </div>\r\n                            </MenuItem>\r\n\r\n                          </Menu>\r\n                      </Col>\r\n                      <Col :xs=\"16\" :sm=\"16\" :md=\"16\" :lg=\"18\">\r\n                          <div class=\"own-space-right\">\r\n                              <Row v-if=\"openSearch\">\r\n                                  <Form ref=\"searchForm\" :model=\"searchForm\" inline :label-width=\"80\" >\r\n                                      <Form-item label=\"批次名称\" prop=\"batchName\">\r\n                                          <Input type=\"text\" v-model=\"searchForm.batchName\" placeholder=\"请输入批次名称\" clearable style=\"width: 200px\" />\r\n                                      </Form-item>\r\n                                      <Form-item class=\"no-margin br\">\r\n                                          <Button @click=\"handleSearch\"  type=\"primary\"  icon=\"ios-search\" >{{ $t(\"search\") }}</Button>\r\n                                          <Button @click=\"handleReset\">{{ $t(\"reset\") }}</Button>\r\n                                      </Form-item>\r\n                                  </Form>\r\n                              </Row>\r\n                              <Row class=\"operation\">\r\n                                  <Button @click=\"addBacthDetailList\" type=\"primary\" icon=\"md-add\">数据管理</Button><!-- 增加 -->\r\n                                  <Button @click=\"getResultAll('1','','1')\"  type=\"primary\" icon=\"md-add\">配置公共营销结果</Button>\r\n                                  <Button @click=\"btnDataAssign\"  type=\"primary\" icon=\"md-add\">数据分配</Button>\r\n                                  <Button @click=\"btnDataRecycle\"  type=\"primary\" icon=\"md-add\">数据回收</Button>\r\n                                  <!-- <Button @click=\"importBlackList\" icon=\"md-exit\">{{ $t(\"import\") }}</Button>  导入 -->\r\n                                  <!-- <Button @click=\"delAll\" icon=\"md-trash\">{{  $t(\"deleteList\") }}</Button>  批量删除 -->\r\n                                  <Button @click=\"handleReset\" icon=\"md-refresh\">{{ $t(\"refresh\") }}</Button><!-- 刷新 -->\r\n                                  <Button type=\"dashed\" @click=\"openSearch=!openSearch\">{{openSearch ? \"关闭搜索\" : \"开启搜索\"}}</Button>\r\n                              </Row>\r\n                              <Row v-show=\"openTip && selectCount > 0\">\r\n                                  <Alert show-icon> {{ $t(\"tableTileSelected\") }} <span class=\"select-count\">{{ selectCount }}</span>\r\n                                      {{ $t(\"tableTileTerm\") }}\r\n                                      <a class=\"select-clear\" @click=\"clearSelectAll\">{{ $t(\"clear\") }}</a>\r\n                                  </Alert>\r\n                              </Row>\r\n                              <Row>\r\n                                  <Table :columns=\"columns\" :data=\"batchDataList\" ref=\"table\" sortable=\"custom\" @on-selection-change=\"showSelect\"></Table>\r\n                              </Row>\r\n                              <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n                                  <Page :current=\"searchForm.pageNumber\" :total=\"total\" :page-size=\"searchForm.pageSize\" @on-change=\"changePage\" \r\n                                   @on-page-size-change=\"changePageSize\" :page-size-opts=\"[10, 20, 50]\" size=\"small\" show-total show-elevator show-sizer>\r\n                                  </Page>\r\n                              </Row>\r\n                          </div>\r\n                      </Col>\r\n                  </div>\r\n              </div>\r\n          </Row>\r\n      </Card>\r\n\r\n    <!-- 新增编辑任务记录-start -->\r\n    <Modal :title=\"modalTitle\" v-model=\"taskModalVisible\" :closable=\"false\" :mask-closable=\"false\" :width=\"700\">\r\n      <Form ref=\"taskForm\" :model=\"taskForm\" :label-width=\"100\" :rules=\"taskFormValidate\">\r\n          <Row :gutter=\"32\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"任务名称\" prop=\"taskName\">\r\n                <Input v-model=\"taskForm.taskName\" :disabled=\"editTaskState\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"最大通道数\" prop=\"maxChannel\">\r\n                <Input v-model=\"taskForm.maxChannel\"  :disabled=\"editTaskState\" />\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"32\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"开始日期\" prop=\"startTime\">\r\n                <DatePicker  type=\"datetime\" style=\"width:217px\" :disabled=\"editTaskState\" placeholder=\"请选择\" v-model=\"taskForm.startTime\"></DatePicker>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"完成日期\" prop=\"endTime\">\r\n                <DatePicker type=\"datetime\" style=\"width:217px\"  :disabled=\"editTaskState\" placeholder=\"请选择\" v-model=\"taskForm.endTime\"></DatePicker>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"32\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"免呼组\" prop=\"blackGroupId\">\r\n                <Select v-model=\"taskForm.blackGroupId\" :disabled=\"editTaskState\" placeholder=\"请选择\">\r\n                  <Option\r\n                    v-for=\"(item, index) in blackListItems\"\r\n                    :key=\"index\"\r\n                    :value=\"item.id\"\r\n                    >{{ item.name }}</Option\r\n                  >\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"中继组\" prop=\"relayGroupId\">\r\n                <Select v-model=\"taskForm.relayGroupId\" :disabled=\"editTaskState\" @on-change=\"getRelayPhoneAll()\" placeholder=\"请选择\">\r\n                  <Option\r\n                    v-for=\"(item, index) in relayGroupListItems\"\r\n                    :key=\"index\"\r\n                    :value=\"item.id\"\r\n                    >{{ item.relayGroupName }}</Option\r\n                  >\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"32\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"主叫号码规则\" prop=\"relayPhoneMode\">\r\n                 <Select v-model=\"taskForm.relayPhoneMode\" :disabled=\"editTaskState\" @on-change=\"getRelayPhoneAllDisabled()\" placeholder=\"请选择\">\r\n                  <Option value=\"0\">顺序分配</Option>\r\n                  <Option value=\"1\">随机分配</Option>\r\n                  <Option value=\"2\">指定号码</Option>\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"主叫号码\" prop=\"relayPhoneId\">\r\n                <Select v-model=\"taskForm.relayPhoneId\"  :disabled=\"selectPhone\" placeholder=\"请选择\">\r\n                  <Option\r\n                    v-for=\"(item, index) in relayPhoneListItems\"\r\n                    :key=\"index\"\r\n                    :value=\"item.id\"\r\n                    >{{ item.relayPhoneNumber }}</Option\r\n                  >\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n         <Row :gutter=\"32\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"时间组\" prop=\"workTimeGroupId\">\r\n                <Select v-model=\"taskForm.workTimeGroupId\" :disabled=\"editTaskState\" placeholder=\"请选择\">\r\n                  <Option\r\n                    v-for=\"(item, index) in WorkTimeListItems\"\r\n                    :key=\"index\"\r\n                    :value=\"item.id\"\r\n                    >{{ item.name }}</Option\r\n                  >\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"32\">\r\n            <Col span=\"32\">\r\n              <FormItem label=\"备注\" prop=\"remark\">\r\n                 <Input type=\"textarea\" v-model=\"taskForm.remark\" :disabled=\"editTaskState\" :rows=\"4\" />\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"64\">\r\n            <Col span=\"64\">\r\n              <FormItem label=\"营销结果配置\" prop=\"startTime\">\r\n                  <table id=\"table\">\r\n                  <thead>\r\n                    <tr>\r\n                      <th :width=\"100\">名称</th>\r\n                      <th :width=\"100\">备注</th>\r\n                      <th :width=\"100\">是否成功标识</th>\r\n                      <th><Button  @click=\"insertResult\" v-show=\"subEdit\" :width=\"200\" type=\"primary\" icon=\"md-add\"></Button></th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    <tr v-for=\"(item, index) in queryResultListItems\" :key=\"index\">\r\n                      <td :width=\"100\" style=\"text-align: center\">\r\n                        <input prop=\"fullName\" v-model=\"item.fullName\" :disabled=\"editTaskState\" />\r\n                        <!-- <input v-model=\"item.id\" v-show=\"false\" value=\"item.id\" /> -->\r\n                      </td>\r\n                      <td :width=\"100\" style=\"text-align: center\">\r\n                        <input v-model=\"item.remark\"  :disabled=\"editTaskState\" />\r\n                      </td>\r\n                      <td :width=\"100\" style=\"text-align: center\">\r\n                        <input type=\"checkbox\" v-model=\"item.successFlag\" :disabled=\"editTaskState\" />\r\n                      </td>\r\n                      <td><Button   @click=\"removeResult(index)\" v-show=\"subEdit\" type=\"primary\" icon=\"md-remove\"></Button></td>\r\n                    </tr>\r\n                  </tbody>\r\n                </table>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"cancelTask\">取消</Button>\r\n        <Button type=\"primary\" :loading=\"submitLoading\" v-show=\"subEdit\" @click=\"submitTask\">提交</Button>\r\n      </div>\r\n    </Modal>\r\n    <!-- 新增编辑任务记录-end -->\r\n\r\n\r\n\r\n    <!-- 根据任务数据管理-start -->\r\n    <Modal :title=\"batchModalTitle\"  :transfer=\"false\" v-model=\"batchModalVisible\" :closable=\"false\" style=\"z-index:100\" :mask-closable=\"false\" :width=\"900\">\r\n      <Form ref=\"batchForm\" :model=\"batchForm\" :label-width=\"140\" >\r\n          <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"批次名称\" prop=\"batchName\">\r\n                <Input v-model=\"batchForm.batchName\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"批次类型\" prop=\"batchType\">\r\n                <Select v-model=\"batchForm.batchType\" @on-change=\"getBatchTypeDisplay()\" >\r\n                  <Option value=\"1\">预览式外呼</Option>\r\n                  <Option value=\"2\">预测外呼</Option>\r\n                  <Option value=\"3\">自动外呼</Option>\r\n                  <Option value=\"5\">智能外呼</Option>\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"数据文件\" prop=\"startTime\">\r\n               <Upload action :before-upload=\"beforeUploadImport\" accept=\".xls, .xlsx\">\r\n                <Button :loading=\"reading\" icon=\"ios-cloud-upload-outline\" style=\"margin-right:10px\" >上传Excel文件</Button>\r\n                <br>\r\n                <span v-if=\"uploadfile.name\">当前选择文件:{{ uploadfile.name }}</span>\r\n              </Upload>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem>\r\n                <Button  @click=\"downloadTemple\"  type=\"info\" style=\"position: absolute;\" >下载导入模板</Button>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row  :gutter=\"36\">\r\n            <Col  v-show=\"seatUserDisplay\" span=\"12\">\r\n              <FormItem label=\"分配坐席\" prop=\"seatUserIds\">\r\n                  <Input v-model=\"batchForm.seatUserIds\" v-show=\"false\" />\r\n                  <user-choose @on-change=\"handleSelectUser\"  @click=\"submitUser\" ref=\"user\" style=\"display: inline-block;\"></user-choose>               \r\n              </FormItem>\r\n            </Col>\r\n            <Col v-show=\"ivrDisplay\" span=\"12\">\r\n              <FormItem  label=\"IVR流程\" prop=\"ivrFlowId\">\r\n                <Input v-model=\"batchForm.ivrFlowId\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col v-show=\"batchTypeDisplay\" span=\"12\">\r\n              <FormItem label=\"速率\" prop=\"outCallRate\">\r\n                 <Input v-model=\"batchForm.outCallRate\" />\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Row v-show=\"batchTypeDisplay\" :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"每天自动回拨次数\" prop=\"autoCallCount\">\r\n                 <Input v-model=\"batchForm.autoCallCount\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"自动回拨间隔时间(分钟)\" prop=\"recallInterval\">\r\n                <Input v-model=\"batchForm.recallInterval\" />\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"号码前缀\" prop=\"batchPrefix\">\r\n                 <Input v-model=\"batchForm.batchPrefix\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"允许重复\" prop=\"removal\">\r\n                <input type=\"checkbox\" v-model=\"batchForm.removal\" />\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"cancelDetailTask\">取消</Button>\r\n        <Button type=\"primary\" :loading=\"submitLoading\" v-show=\"subEdit\" @click=\"submitBacthImport\">提交</Button>\r\n      </div>\r\n    </Modal>\r\n    <!-- 根据任务数据管理-end -->\r\n\r\n\r\n\r\n\r\n    <!-- 新增营销结果记录-start -->\r\n    <Modal :title=\"resultTitle\" v-model=\"resultModalVisible\" :closable=\"false\" :mask-closable=\"false\" :width=\"500\">\r\n        <Form ref=\"resultForm\" :model=\"resultForm\" :label-width=\"200\" :rules=\"resultValidate\">\r\n            <table id=\"table\">\r\n            <thead>\r\n                <tr>\r\n                <th :width=\"100\">名称</th>\r\n                <th :width=\"100\">备注</th>\r\n                <th :width=\"100\">是否成功标识</th>\r\n                <th><Button  @click=\"insertResult\" :width=\"200\" type=\"primary\" icon=\"md-add\"></Button></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr v-for=\"(item, index) in queryResultListItems\" :key=\"index\">\r\n                <td :width=\"100\" style=\"text-align: center\">\r\n                    <input prop=\"fullName\" v-model=\"item.fullName\"  />\r\n                    <!-- <input v-model=\"item.id\" v-show=\"false\" value=\"item.id\" /> -->\r\n                </td>\r\n                <td :width=\"100\" style=\"text-align: center\">\r\n                    <input v-model=\"item.remark\" />\r\n                </td>\r\n                <td :width=\"100\" style=\"text-align: center\">\r\n                    <input type=\"checkbox\" v-model=\"item.successFlag\" />\r\n                </td>\r\n                <td><Button   @click=\"removeResult(index)\" type=\"primary\" icon=\"md-remove\"></Button></td>\r\n                </tr>\r\n            </tbody>\r\n            </table>\r\n        </Form>\r\n        <div slot=\"footer\">\r\n            <Button type=\"text\" @click=\"cancelResult\">取消</Button>\r\n            <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submitResult\">提交</Button>\r\n        </div>\r\n        </Modal>\r\n    <!-- 新增营销结果记录-end -->\r\n\r\n    <!--修改批次速率-开始--->\r\n    <Modal :title=\"batchMobileVisibleTitle\" v-model=\"batchMobileVisible\" :closable=\"false\" :mask-closable=\"false\" :width=\"500\" >\r\n        <Form ref=\"batchForm\" :model=\"batchForm\" :label-width=\"120\"  label-position=\"right\" style=\"width:450px\" >\r\n            <FormItem label=\"速率\" prop=\"outCallRate\">\r\n                <Input v-model=\"batchForm.outCallRate\" /><span>(1.0~4.0之间)</span>\r\n            </FormItem>\r\n        </Form>\r\n        <div slot=\"footer\">\r\n            <Button type=\"text\" @click=\"cancelBatch\">{{ $t(\"cancel\") }}</Button>\r\n            <Button type=\"primary\" :loading=\"checkCodeLoading\"  @click=\"submitaBatch\" >{{ $t(\"save\") }}</Button>\r\n        </div> \r\n      </Modal>\r\n      <!--修改批次速率-结束--->\r\n     \r\n    \r\n     <!--分配数据-开始-->\r\n      <Modal :title=\"assignModalTitle\"  :transfer=\"false\" v-model=\"assignModalVisible\" :closable=\"false\" style=\"z-index:100\" :mask-closable=\"false\" :width=\"1200\">\r\n      <Form ref=\"assignForm\" :model=\"assignForm\" :label-width=\"100\" >\r\n          <Row :gutter=\"24\" >\r\n            <Col span=\"7\">\r\n              <FormItem label=\"分配工号\" prop=\"seatUserIds\">\r\n                <Input v-model=\"assignForm.seatUserIds\" style=\"width:140px\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"7\">\r\n              <FormItem label=\"任务名称\" prop=\"taskName\">\r\n                <Input v-model=\"assignForm.taskName\" style=\"width:140px\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"7\">\r\n              <FormItem label=\"批次名称\" prop=\"batchName\">\r\n                <Input v-model=\"assignForm.batchName\" style=\"width:140px\" />\r\n              </FormItem>\r\n            </Col>\r\n            <Button type=\"primary\" :loading=\"submitLoading\" icon=\"ios-search\"  @click=\"submitBacthImport\">检索</Button>\r\n          </Row>\r\n          <Row :gutter=\"24\">\r\n            <Col span=\"7\">\r\n              <FormItem label=\"选择数据\" prop=\"chooseType\">\r\n                <Select v-model=\"assignForm.chooseType\" style=\"width:140px\">\r\n                  <Option  value=\"1\">检索结果</Option>\r\n                  <Option  value=\"2\">点选分配</Option>\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"7\">\r\n              <FormItem label=\"分配数\" prop=\"assignNum\">\r\n                <Input v-model=\"assignForm.assignNum\"  style=\"width:140px\"/>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"7\">\r\n              <FormItem label=\"分配方式\" prop=\"assignType\">\r\n                <Select v-model=\"assignForm.assignType\" style=\"width:140px\">\r\n                  <Option  value=\"1\">平均分配</Option>\r\n                  <Option  value=\"2\">指定数量分配</Option>\r\n                  <Option  value=\"3\">按比例分配</Option>\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Button type=\"primary\" :loading=\"submitLoading\" icon=\"md-add\"  @click=\"submitBacthImport\">分配坐席</Button>\r\n          </Row>\r\n          <div style=\"width:500px;display: inline-block;\">\r\n          <!--清单数据--> \r\n          <Row >    \r\n            <Table\r\n              :loading=\"loading\"\r\n              :columns=\"columnsDetail\"\r\n              :data=\"dataDetail\"\r\n              sortable=\"title\"\r\n              ref=\"tableDetail\"\r\n            ></Table>\r\n          </Row>\r\n          <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n            <Page\r\n              :current=\"searchDetailForm.pageNumber\"\r\n              :total=\"totalDetail\"\r\n              :page-size=\"searchDetailForm.pageSize\"\r\n              @on-change=\"changeDetailPage\"\r\n              @on-page-size-change=\"changeDetailPageSize\"\r\n              :page-size-opts=\"[10, 20, 50]\"\r\n              size=\"small\"\r\n              show-total\r\n              show-elevator\r\n              show-sizer\r\n            ></Page>\r\n          </Row>\r\n          </div>\r\n          <div style=\"width:500px;float:right;display: inline-block;\">\r\n          <!--坐席分配-->\r\n          <Row>\r\n            <Table\r\n              :loading=\"loading\"\r\n              :columns=\"columnsTask\"\r\n              :data=\"dataTask\"\r\n              sortable=\"title\"\r\n              ref=\"tableDetail\"\r\n            ></Table>\r\n          </Row>\r\n          <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n            <Page\r\n              :current=\"searchTaskForm.pageNumber\"\r\n              :total=\"totalTask\"\r\n              :page-size=\"searchTaskForm.pageSize\"\r\n              @on-change=\"changeTaskPage\"\r\n              @on-page-size-change=\"changeTaskPageSize\"\r\n              :page-size-opts=\"[10, 20, 50]\"\r\n              size=\"small\"\r\n              show-total\r\n              show-elevator\r\n              show-sizer\r\n            ></Page>\r\n          </Row>\r\n          </div>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"cancelAssignTask\">取消</Button>\r\n        <Button type=\"primary\" :loading=\"submitLoading\" v-show=\"subEdit\" @click=\"submitBacthImport\">提交</Button>\r\n      </div>\r\n    </Modal>\r\n\r\n      <!--任务记录-->\r\n      <Modal :title=\"modalTaskTitle\"  v-model=\"modalTaskVisible\" :mask-closable=\"false\"  :width=\"800\" >\r\n          <Row>\r\n            <Table\r\n              :loading=\"loading\"\r\n              :columns=\"columnsTask\"\r\n              :data=\"dataTask\"\r\n              sortable=\"title\"\r\n              ref=\"tableDetail\"\r\n            ></Table>\r\n          </Row>\r\n          <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n            <Page\r\n              :current=\"searchTaskForm.pageNumber\"\r\n              :total=\"totalTask\"\r\n              :page-size=\"searchTaskForm.pageSize\"\r\n              @on-change=\"changeTaskPage\"\r\n              @on-page-size-change=\"changeTaskPageSize\"\r\n              :page-size-opts=\"[10, 20, 50]\"\r\n              size=\"small\"\r\n              show-total\r\n              show-elevator\r\n              show-sizer\r\n            ></Page>\r\n          </Row>\r\n          <div slot=\"footer\">\r\n            <Button type=\"text\" @click=\"clearTask\">取消</Button>\r\n            <Button type=\"primary\" :loading=\"submitTaskLoading\" @click=\"handelTaskSubmit\">确定</Button>\r\n          </div>\r\n      </Modal>\r\n      <!--批次记录-->\r\n      <Modal :title=\"modalBatchTitle\"  v-model=\"modalBatchVisible\" :mask-closable=\"false\"  :width=\"800\" >\r\n          <Row>\r\n            <Table\r\n              :loading=\"loading\"\r\n              :columns=\"columnsBatch\"\r\n              :data=\"dataBatch\"\r\n              sortable=\"title\"\r\n              ref=\"tableDetail\"\r\n            ></Table>\r\n          </Row>\r\n          <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n            <Page\r\n              :current=\"searchBatchForm.pageNumber\"\r\n              :total=\"totalBatch\"\r\n              :page-size=\"searchBatchForm.pageSize\"\r\n              @on-change=\"changeBatchPage\"\r\n              @on-page-size-change=\"changeBatchPageSize\"\r\n              :page-size-opts=\"[10, 20, 50]\"\r\n              size=\"small\"\r\n              show-total\r\n              show-elevator\r\n              show-sizer\r\n            ></Page>\r\n          </Row>\r\n          <div slot=\"footer\">\r\n            <Button type=\"text\" @click=\"clearBatch\">取消</Button>\r\n            <Button type=\"primary\" :loading=\"submitBatchLoading\" @click=\"handelBatchSubmit\">确定</Button>\r\n          </div>\r\n      </Modal>\r\n     <!--分配数据-结束-->\r\n\r\n\r\n\r\n    <!-- 根据任务数据回收-start -->\r\n    <Modal :title=\"recycleModalTitle\"  :transfer=\"false\" v-model=\"recycleModalVisible\" :closable=\"false\" style=\"z-index:100\" :mask-closable=\"false\" :width=\"900\">\r\n      <Form ref=\"recycleForm\" :model=\"recycleForm\" :label-width=\"140\" >\r\n          <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"开始时间\" prop=\"startDate\">\r\n                <DatePicker v-model=\"recycleForm.startDate\" format=\"yyyy-MM-dd\" @on-change=\"changeStartDate\" type=\"date\" ></DatePicker>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"结束时间\" prop=\"endDate\">\r\n               <DatePicker v-model=\"recycleForm.endDate\" format=\"yyyy-MM-dd\" @on-change=\"changeEndDate\" type=\"date\" ></DatePicker>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"批次名称\" prop=\"batchId\">\r\n                <Select v-model=\"recycleForm.batchId\">\r\n                <Option v-for=\"item in batchList\" :value=\"item.id\" :key=\"item.id\"   :label=\"item.batchName\" >\r\n                  <span style=\"margin-right:10px;\">{{ item.batchName }}</span>\r\n                </Option>\r\n              </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"呼叫状态\" prop=\"callStatus\">\r\n                <Select v-model=\"recycleForm.callStatus\">\r\n                  <Option value=\"0\">未执行</Option>\r\n                  <Option value=\"1\">待后续</Option>\r\n                  <Option value=\"2\">已完成</Option>\r\n                </Select>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n          <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"呼叫结果\" prop=\"callResult\">\r\n                <Select v-model=\"recycleForm.callResult\" >\r\n                <Option v-for=\"item in this.$store.state.dict.callResult\" :value=\"item.value\" :key=\"item.id\" :label=\"item.title\" >\r\n                  <span style=\"margin-right:10px;\">{{ item.title }}</span>\r\n                </Option>\r\n              </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"营销结果\" prop=\"marketingResult\">\r\n                 <Select v-model=\"recycleForm.marketingResult\" >\r\n                  <Option v-for=\"item in marketingResultList\" :value=\"item.fullName\" :key=\"item.fullName\" :label=\"item.fullName\" >\r\n                    <span style=\"margin-right:10px;\">{{ item.fullName }}</span>\r\n                  </Option>\r\n                 </Select>\r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n           <Row :gutter=\"36\">\r\n            <Col span=\"12\">\r\n              <FormItem label=\"回收坐席\" prop=\"recycleUser\">\r\n                 <Input v-model=\"recycleForm.recycleUser\" v-show=\"false\" />\r\n                  <user-recycle  @click=\"submitRecycleUser\" ref=\"user\" style=\"display: inline-block;\"></user-recycle>  \r\n              </Select>\r\n              </FormItem>\r\n            </Col>\r\n            <Col span=\"12\">\r\n              <FormItem label=\"分配坐席\" prop=\"assignUser\">\r\n                  <Input v-model=\"recycleForm.assignUser\" v-show=\"false\" />\r\n                  <user-assign @click=\"submitAssignUser\" ref=\"user\" style=\"display: inline-block;\"></user-assign>  \r\n              </FormItem>\r\n            </Col>\r\n          </Row>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"cancelRecycle\">取消</Button>\r\n        <Button type=\"primary\" :loading=\"submitLoading\" v-show=\"subEdit\" @click=\"submitRecycle\">提交</Button>\r\n      </div>\r\n    </Modal>\r\n    <!-- 根据任务数据回收-end -->\r\n    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    getBlackListGroups,\r\n    getBlackList,\r\n    editBlackListGroups,\r\n    delBlackListGroups,\r\n    editBlackList,\r\n    delBlackList,\r\n    getCallTaskAllLists,   //获取任务记录数据\r\n    getResultAllLists,     //根据类型获取营销结果数据\r\n    insertMarketingResult, //新增公共营销结果数据\r\n    getWorktimeGroups,    //获取时间组\r\n    getRelayGroupList,    //获取中继组\r\n    getRelayPhoneList,     //获取中继号码\r\n    submitCallTask,\r\n    getCallTaskBatchAllLists,  //获取任务批次数据\r\n    validateTaskNameById,\r\n    deleteCallTaskById,\r\n    getCallTaskBatchAllPageLists,\r\n    fileDetailUpload,\r\n    submitStateCallTaskBatch,\r\n    submitDisplayCallTask,\r\n    submitCallTaskBatch,\r\n    submitRecycle\r\n} from \"@/api/index\";\r\nimport userChoose from \"@/views/sys/out-call/user-choose\";\r\nimport userRecycle from \"@/views/sys/out-call/user-recycle\";\r\nimport userAssign from \"@/views/sys/out-call/user-assign\";\r\nimport { detailImportColumns, detailData } from \"@/libs/importCallTaskDetail\";\r\nimport excel from \"@/libs/excel\";\r\nexport default {\r\n  components: {\r\n    userChoose,\r\n    userAssign,\r\n    userRecycle\r\n  },\r\n  name: \"blacklistManage\",\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      activeName: \"基本信息\",\r\n      batchMobileVisibleTitle:\"\",    \r\n      batchMobileVisible:false,\r\n      area: 86,\r\n      openSearch:false,\r\n      modalType: 0,\r\n      modalTitle:\"\",\r\n      callTaskList:[],   //任务记录结果集\r\n      batchCount:0,\r\n      editTaskState:false,\r\n      subEdit:true,\r\n      taskModalVisible: false,\r\n      batchModalVisible:false,\r\n      batchTypeDisplay:false,\r\n      seatUserDisplay:true,\r\n      ivrDisplay:false,\r\n      batchModalTitle:\"\",\r\n      blackListItems:[],\r\n      WorkTimeListItems:[],\r\n      relayGroupListItems:[],\r\n      relayPhoneListItems:[],\r\n      selectUsers: [],\r\n      selectPhone:true,\r\n      validateName:false,\r\n      importList:{},\r\n      importLoading: false, // 导入加载状态\r\n      taskId:\"\",\r\n      taskForm: {\r\n        taskName: \"\",\r\n        maxChannel: \"\",\r\n        startTime: \"\",\r\n        endTime: \"\"\r\n      },\r\n      batchForm:{\r\n          batchType:\"1\"\r\n      },\r\n      taskFormValidate: {\r\n        taskName: [{ required: true, message: \"任务名称不能为空\", trigger: \"blur\" }],\r\n        // maxChannel: [{ required: true, message: \"最大通道数不能为空\", trigger: \"blur\" }],\r\n        // startTime: [{ required: true, message: \"开始时间不能为空\", trigger: \"change\" }],\r\n        // endTime: [{ required: true, message: \"结束时间不能为空\", trigger: \"change\" }]\r\n      },\r\n      resultTitle:\"\",\r\n      resultModalVisible:false,\r\n      resultForm:{},\r\n      queryResultListItems:[],\r\n      resultValidate:{\r\n         fullName: [{ required: true, message: \"名称不能为空\", trigger: \"blur\" }]\r\n      },\r\n      resultParams:{},\r\n      uploadfile: {\r\n        name: \"\",\r\n      },\r\n\r\n      recycleModalTitle:\"任务数据回收\",\r\n      recycleModalVisible:false,\r\n      recycleForm:{\r\n           startDate:\"\",\r\n           endDate:\"\",  \r\n           batchId:\"\", \r\n           callStatus:\"\", \r\n           callResult:\"\", \r\n           marketingResult:\"\"\r\n      },\r\n      marketingResultList: [],\r\n      batchList:[],\r\n\r\n      assignModalTitle:\"\",\r\n      assignModalVisible:false,\r\n      assignForm:{\r\n          chooseType:\"1\",\r\n          assignType:\"1\"\r\n      },\r\n\r\n      columnsDetail:[\r\n          {\r\n            type: \"index\",\r\n            width: 60,\r\n            align: \"center\",\r\n          },\r\n          {  title: \"批次名称\", key: \"batchName\", minWidth: 120},\r\n          {  title: \"创建时间\", key: \"createTime\", minWidth: 120},\r\n          {  title: \"呼叫结果\", key: \"callResult\", minWidth: 120},\r\n          {  title: \"号码\", key: \"moblieNumber\", minWidth: 120}\r\n      ],   \r\n      dataDetail:[],\r\n      searchDetailForm:{\r\n           pageNumber: 1, // 当前页数\r\n           pageSize: 10, // 页面大小\r\n           sort: \"create_time\", // 默认排序字段\r\n           order: \"desc\" // 默认排序方式\r\n      },  \r\n      totalDetail:0,\r\n\r\n\r\n      submitBatchLoading:false,\r\n      modalBatchTitle:\"\",\r\n      modalBatchVisible:false,\r\n      columnsBatch:[\r\n        {\r\n            type: \"index\",\r\n            width: 60,\r\n            align: \"center\",\r\n        },\r\n        {  title: \"批次名称\", key: \"batchName\", minWidth: 120},\r\n        {  title: \"创建时间\", key: \"createTime\", minWidth: 120},\r\n        {  title: \"批次类型\", key: \"batchType\", minWidth: 120}\r\n      ],\r\n      dataBatch:[],\r\n      totalBatch:0,\r\n      searchBatchForm: {\r\n            pageNumber: 1, // 当前页数\r\n            pageSize: 10, // 页面大小\r\n            sort: \"create_time\", // 默认排序字段\r\n            order: \"desc\" // 默认排序方式\r\n      },\r\n\r\n\r\n      submitTaskLoading:false,\r\n      modalTaskTitle:\"\",\r\n      modalTaskVisible:false,\r\n      columnsTask:[\r\n        {\r\n            type: \"index\",\r\n            width: 60,\r\n            align: \"center\",\r\n        },\r\n        {  title: \"任务名称\", key: \"taskName\", minWidth: 120},\r\n        {  title: \"创建时间\", key: \"createTime\", minWidth: 120},\r\n        {  title: \"任务类型\", key: \"taskType\", minWidth: 120},\r\n        {  title: \"备注\", key: \"remark\", minWidth: 120},\r\n        {  title: \"数据总量\", key: \"totalNum\", minWidth: 120},\r\n        {  title: \"未分配数量\", key: \"unAssign\", minWidth: 120},\r\n        {  title: \"未拨打数量\", key: \"unCall\", minWidth: 120}\r\n      ],\r\n      dataTask:[],\r\n      totalTask:0,\r\n      searchTaskForm: {\r\n            pageNumber: 1, // 当前页数\r\n            pageSize: 10, // 页面大小\r\n            sort: \"create_time\", // 默认排序字段\r\n            order: \"desc\" // 默认排序方式\r\n      },\r\n\r\n\r\n\r\n      ownSpaceLeftItem: 1,\r\n      selectCount:0,\r\n      batchDataList:[],\r\n      columns: [\r\n            {\r\n                type: \"selection\",\r\n                width: 60,\r\n                align: \"center\",\r\n            },\r\n            {\r\n                title: \"批次名称\", \r\n                key: \"batchName\",\r\n                minwidth: 120\r\n            },\r\n            {\r\n                title: \"外呼速率\", \r\n                key: \"outCallRate\",\r\n                minwidth: 120\r\n            },\r\n            {\r\n                title: \"添加时间\", \r\n                key: \"createTime\",\r\n                minwidth: 120\r\n            },\r\n            {\r\n                title: \"显示状态\", \r\n                key: \"batchState\",\r\n                minwidth: 120,\r\n                render: (h, params) => {\r\n                  if (params.row.batchState == \"0\") {\r\n                    return h(\"span\", [\r\n                      h(\"span\", \"暂停\")\r\n                    ]);\r\n                  } else if (params.row.batchState == \"1\") {\r\n                    return h(\"span\", [\r\n                      h(\"span\", \"启动\")\r\n                    ]);\r\n                  } \r\n                }\r\n            },\r\n            {\r\n                title: \"呼叫类型\", \r\n                key: \"batchType\",\r\n                minwidth: 120,\r\n                render: (h, params) => {\r\n                  if (params.row.batchType == \"1\") {\r\n                    return h(\"span\", [\r\n                      h(\"span\", \"预览式外呼\")\r\n                    ]);\r\n                  } else if (params.row.batchType == \"2\") {\r\n                    return h(\"span\", [\r\n                      h(\"span\", \"预测外呼\")\r\n                    ]);\r\n                  } else if (params.row.batchType == \"3\") {\r\n                    return h(\"span\", [\r\n                      h(\"span\", \"自动外呼\")\r\n                    ]);\r\n                  } else if (params.row.batchType == \"5\") {\r\n                    return h(\"span\", [\r\n                      h(\"span\", \"智能外呼\")\r\n                    ]);\r\n                  }\r\n                }\r\n            },\r\n            {\r\n                title: \"备注\", \r\n                key: \"remark\",\r\n                minwidth: 120,\r\n            },\r\n            {\r\n                title: this.$t(\"operation\"), //操作\r\n                key: \"active\",\r\n                width: 170,\r\n                fixed: \"right\",\r\n                tooltip: true,\r\n                render: (h, params) => {\r\n                  let state = \"\";\r\n                  let display = \"\";\r\n                  if(params.row.batchState == \"1\"){\r\n                      state = h('Tooltip',{props: {\r\n                                placement: 'top',\r\n                                transfer: true\r\n                            }},[h(\r\n                            \"Icon\",\r\n                            {\r\n                                props: {\r\n                                    type: \"ios-pause\",\r\n                                    size: \"\",\r\n                                },\r\n                                style: { marginRight: \"5px\",fontSize:'18px',cursor: 'pointer' },\r\n                                on: {\r\n                                    click: () => {\r\n                                        this.editState(0, params.row);\r\n                                    },\r\n                                },\r\n                            },\r\n                            this.$t(\"play\")\r\n                        ),h('span', {\r\n                            slot: 'content',\r\n                            style: {\r\n                                whiteSpace: 'normal'\r\n                            }\r\n                        }, '暂停')])\r\n                    }else{\r\n                      state = h('Tooltip',{props: {\r\n                                placement: 'top',\r\n                                transfer: true\r\n                            }},[h(\r\n                            \"Icon\",\r\n                            {\r\n                                props: {\r\n                                    type: \"ios-play\",\r\n                                    size: \"\",\r\n                                },\r\n                                style: { marginRight: \"5px\",fontSize:'18px',cursor: 'pointer' },\r\n                                on: {\r\n                                    click: () => {\r\n                                        this.editState(1, params.row);\r\n                                    },\r\n                                },\r\n                            },\r\n                            this.$t(\"play\")\r\n                        ),h('span', {\r\n                            slot: 'content',\r\n                            style: {\r\n                                whiteSpace: 'normal'\r\n                            }\r\n                        }, '启动')])\r\n                    }\r\n\r\n                    if(params.row.batchDisplay == \"1\"){\r\n                      display = h('Tooltip',{props: {\r\n                                placement: 'top',\r\n                                transfer: true\r\n                            }},[h(\r\n                            \"Icon\",\r\n                            {\r\n                                props: {\r\n                                    type: \"ios-pause\",\r\n                                    size: \"\",\r\n                                },\r\n                                style: { marginRight: \"5px\",fontSize:'18px',cursor: 'pointer' },\r\n                                on: {\r\n                                    click: () => {\r\n                                        this.editDisplay(0,params.row.id,'');\r\n                                    },\r\n                                },\r\n                            },\r\n                            this.$t(\"play\")\r\n                        ),h('span', {\r\n                            slot: 'content',\r\n                            style: {\r\n                                whiteSpace: 'normal'\r\n                            }\r\n                        }, '隐藏')])\r\n                    }else{\r\n                      display = h('Tooltip',{props: {\r\n                                placement: 'top',\r\n                                transfer: true\r\n                            }},[h(\r\n                            \"Icon\",\r\n                            {\r\n                                props: {\r\n                                    type: \"ios-play\",\r\n                                    size: \"\",\r\n                                },\r\n                                style: { marginRight: \"5px\",fontSize:'18px',cursor: 'pointer' },\r\n                                on: {\r\n                                    click: () => {\r\n                                        this.editDisplay(1,params.row.id,'');\r\n                                    },\r\n                                },\r\n                            },\r\n                            this.$t(\"play\")\r\n                        ),h('span', {\r\n                            slot: 'content',\r\n                            style: {\r\n                                whiteSpace: 'normal'\r\n                            }\r\n                        }, '显示')])\r\n                    }\r\n\r\n                    return h(\"div\", [\r\n                        //编辑\r\n                        h('Tooltip',{props: {\r\n                                placement: 'top',\r\n                                transfer: true\r\n                            }},[h(\r\n                            \"Icon\",\r\n                            {\r\n                                props: {\r\n                                    type: \"ios-create-outline\",\r\n                                    size: \"\",\r\n                                },\r\n                                style: { marginRight: \"5px\",fontSize:'18px',cursor: 'pointer' },\r\n                                on: {\r\n                                    click: () => {\r\n                                        this.rowBatchEdit(params.row);\r\n                                    },\r\n                                },\r\n                            },\r\n                            this.$t(\"play\")\r\n                        ),h('span', {\r\n                            slot: 'content',\r\n                            style: {\r\n                                whiteSpace: 'normal'\r\n                            }\r\n                        }, '编辑')]),\r\n\r\n\r\n                        //删除\r\n                        h('Tooltip',{props: {\r\n                                placement: 'top',\r\n                                transfer: true\r\n                            }},[h(\r\n                            \"Icon\",\r\n                            {\r\n                                props: {\r\n                                    type: \"ios-trash-outline\",\r\n                                    size: \"\",\r\n                                },\r\n                                style: { marginRight: \"5px\",fontSize:'18px',cursor: 'pointer' },\r\n                                on: {\r\n                                    click: () => {\r\n                                        this.rowDel(params.row);\r\n                                    },\r\n                                },\r\n                            },\r\n                            this.$t(\"play\")\r\n                        ),h('span', {\r\n                            slot: 'content',\r\n                            style: {\r\n                                whiteSpace: 'normal'\r\n                            }\r\n                        }, '删除')]),\r\n                        state,\r\n                        display\r\n                    ]);\r\n                },\r\n            },\r\n        ],\r\n        searchForm: {\r\n            pageNumber: 1, // 当前页数\r\n            pageSize: 10, // 页面大小\r\n            sort: \"ctb.create_time\", // 默认排序字段\r\n            order: \"desc\" // 默认排序方式\r\n        },\r\n        total: 0,\r\n\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getCallTaskList();\r\n    },\r\n    //获取任务记录列表数据\r\n    getCallTaskList(){\r\n        getCallTaskAllLists({}).then((res) => {\r\n            if (res.success) {\r\n               this.callTaskList = res.result.list;\r\n               if(this.callTaskList.length > 0){\r\n                  this.clickItem(this.callTaskList[0]);\r\n               }\r\n               \r\n            }\r\n        });\r\n    },\r\n    clickItem(item){\r\n        this.importList = item;\r\n        this.taskId=item.id;\r\n        this.getbatchList(item.id);\r\n       // this.handleReset();\r\n    },\r\n    //获取批次列表\r\n    getbatchList(id) {\r\n        var serarchForm={};\r\n        for(var i in this.searchForm){\r\n            if(this.searchForm[i]!=\"\"){\r\n                serarchForm[i]=this.searchForm[i];\r\n            }\r\n        }\r\n        if(id==undefined){\r\n            serarchForm.taskId=this.taskId;\r\n        }else {\r\n            serarchForm.taskId=id;\r\n        }\r\n        getCallTaskBatchAllPageLists(serarchForm).then((res) => {\r\n            if (res.success) {\r\n                this.batchDataList=res.result.list;\r\n                this.total = res.result.total;\r\n            }\r\n        });\r\n    },\r\n    showSelect(e) {\r\n          this.selectCount = e.length;\r\n          this.selectList = e;\r\n    },\r\n    changePage(v) {\r\n          this.searchForm.pageNumber = v;\r\n          //this.getBlackList(this.groupId);\r\n    },\r\n    changePageSize(v) {\r\n          this.searchForm.pageSize = v;\r\n          //this.getBlackList(this.groupId);\r\n    },\r\n    //搜索\r\n    handleSearch() {\r\n          this.searchForm.pageNumber = 1;\r\n          this.searchForm.pageSize = 10;\r\n          this.getbatchList(this.taskId);\r\n    },\r\n    //重置\r\n    handleReset() {\r\n          this.$refs.searchForm.resetFields();\r\n          this.searchForm.pageNumber = 1;\r\n          this.searchForm.pageSize = 10;\r\n    },\r\n    //新增\r\n    addBacthDetailList(){\r\n          this.batchModalVisible = true;\r\n          this.batchModalTitle = \"数据管理\";\r\n          this.uploadfile = { name: \"\" };\r\n    },\r\n    //导入\r\n    importBlackList(){\r\n        this.importBlackListMobileVisible=true;\r\n    },\r\n    //编辑\r\n    rowEdit(V) {\r\n          for (var i in V) {\r\n              if (i == null) {\r\n                  V[i] = \"\";\r\n              }\r\n          }\r\n          V = JSON.stringify(V);\r\n          V = JSON.parse(V);\r\n\r\n          if(V.delFlag==0){\r\n              V.delFlag=\"有效\";\r\n          }\r\n          V.type=V.type.toString();\r\n          this.blackListForm=V;\r\n          this.blackListMobileVisible = true;\r\n    },\r\n    //删除\r\n    rowDel(v) {\r\n          this.$Modal.confirm({\r\n              title: \"确认删除\", \r\n              content: \"删除批次当前批次清单数据一并也会删除,您确认要删除 \" +v.batchName +\" ?\", \r\n              onOk: () => {\r\n                  deleteCallTaskById({\r\n                      batchId: v.id\r\n                  }).then(res => {\r\n                      if (res.success) {\r\n                          this.$Message.success(this.$t(\"success\"));\r\n                          this.getbatchList(this.taskId);\r\n                      }\r\n                  });\r\n              },\r\n          });\r\n    },\r\n    clearSelectAll() {\r\n          this.$refs.table.selectAll(false);\r\n    },\r\n    cancelResult(){\r\n       this.queryResultListItems = [];\r\n       this.resultModalVisible = false;\r\n    },\r\n    removeResult(index) {\r\n      this.queryResultListItems.splice(index, 1);\r\n    },\r\n    insertResult() {\r\n      this.queryResultListItems.push({successFlag:0,id:\"\",fullName:\"\",remark:\"\"});\r\n    },\r\n    getResultAll(isPublic,taskId,type) {\r\n      this.resultParams[\"isPublic\"] = isPublic;\r\n      this.resultParams[\"taskId\"] = taskId;\r\n      getResultAllLists({isPublic:isPublic,taskId:taskId}).then((res) => {\r\n        if (res.success) {\r\n          if(1==type){\r\n            this.resultModalVisible = true;\r\n            this.resultTitle = \"配置营销结果\";\r\n          }\r\n          this.queryResultListItems = res.result.list;\r\n        }\r\n      });\r\n    },\r\n    submitResult() {\r\n      if(this.queryResultListItems!=null && this.queryResultListItems!=''){\r\n        var result = this.queryResultListItems;\r\n        for (var i = 0; i < result.length; i++) {\r\n          if (result[i].fullName == \"\" || result[i].fullName == null) {\r\n            this.$Message.warning(\"名称不能为空\");\r\n            return;\r\n          }\r\n          if(result[i].successFlag == true){\r\n              result[i].successFlag = 1;\r\n          }\r\n        }\r\n        this.resultParams[\"list\"] = JSON.stringify(result);\r\n        insertMarketingResult(this.resultParams).then(res => {\r\n          this.submitLoading = false;\r\n          if (res.success) {\r\n            this.$Message.success(\"操作成功\");\r\n            this.queryResultListItems = [];\r\n            this.resultParams = [];\r\n            this.resultModalVisible = false;\r\n          }\r\n        });\r\n      }else{\r\n         this.queryResultListItems = [];\r\n         this.resultParams = [];\r\n         this.resultModalVisible = false;\r\n      }\r\n    },\r\n    getBlackAll() {  //获取黑名单组\r\n      getBlackListGroups({}).then((res) => {\r\n        if (res.success) {\r\n          this.blackListItems = res.result;\r\n        }\r\n      });\r\n    },\r\n    getWorktimetAll() {  //获取时间组\r\n      getWorktimeGroups({}).then((res) => {\r\n        if (res.success) {\r\n          this.WorkTimeListItems = res.result;\r\n        }\r\n      });\r\n    },\r\n    getRelayGroupAll() { //获取中继组\r\n      getRelayGroupList({}).then((res) => {\r\n        if (res.success) {\r\n          this.relayGroupListItems = res.result.list;\r\n        }\r\n      });\r\n    },\r\n    getRelayPhoneAll() { //获取中继号码\r\n      var relayGroupId = \"\";\r\n      if(this.taskForm.relayGroupId){\r\n          relayGroupId = this.taskForm.relayGroupId;\r\n      }\r\n      getRelayPhoneList({blackMark:1,workMode:1,relayGroupId:relayGroupId}).then((res) => {\r\n        if (res.success) {\r\n          this.relayPhoneListItems = [];\r\n          this.relayPhoneListItems = res.result.list;\r\n        }\r\n      });\r\n    },\r\n    getRelayPhoneAllDisabled() { //获取中继号码\r\n      if(this.taskForm.relayPhoneMode == 2){\r\n        this.selectPhone = false;\r\n      }else{\r\n        this.selectPhone = true;\r\n      }\r\n      getRelayPhoneList({blackMark:1,workMode:1,relayGroupId:\"\"}).then((res) => {\r\n        if (res.success) {\r\n          this.taskForm.relayPhoneId = \"\";\r\n          this.relayPhoneListItems = [];\r\n          this.relayPhoneListItems = res.result.list;\r\n        }\r\n      });\r\n    },\r\n    getBatchTypeDisplay() { //根据批次类型显示隐藏列\r\n      if(this.batchForm.batchType == 1){\r\n        this.seatUserDisplay = true;\r\n        this.batchTypeDisplay = false;\r\n        this.ivrDisplay = false;\r\n      }\r\n      if(this.batchForm.batchType == 2){\r\n        this.seatUserDisplay = false;\r\n        this.batchTypeDisplay = true;\r\n        this.ivrDisplay = true;\r\n      }\r\n      if(this.batchForm.batchType == 3){\r\n        this.seatUserDisplay = false;\r\n        this.batchTypeDisplay = false;\r\n        this.ivrDisplay = true;\r\n      }\r\n      if(this.batchForm.batchType == 5){\r\n        this.seatUserDisplay = false;\r\n        this.batchTypeDisplay = false;\r\n        this.ivrDisplay = false;\r\n      }\r\n    },\r\n    addTask() {\r\n      this.modalType = 0;\r\n      this.$refs.taskForm.resetFields();\r\n      this.taskForm = [];\r\n      this.taskModalVisible = true;\r\n      this.modalTitle = \"新增任务\";\r\n      this.selectPhone = false;\r\n      this.subEdit = true;\r\n      this.getResultAll(\"1\",\"\",\"0\");\r\n      this.getBlackAll();\r\n      this.getWorktimetAll();\r\n      this.getRelayGroupAll();\r\n      this.getRelayPhoneAll();\r\n    },\r\n    cancelTask() {\r\n      this.taskModalVisible = false;\r\n      this.editTaskState = false;\r\n      this.selectPhone = false;\r\n      this.subEdit = true;\r\n      this.queryResultListItems = [];\r\n    },\r\n    cancelDetailTask() {\r\n      this.$refs.batchForm.resetFields();\r\n      this.batchModalVisible = false;\r\n      this.batchForm = {batchType:\"1\",seatUserIds:\"\"};\r\n      this.seatUserDisplay = true;\r\n      this.batchTypeDisplay = false;\r\n      this.ivrDisplay = false;\r\n    },\r\n    submitTask() {\r\n        var params = {}; \r\n        if(!this.taskForm.taskName){\r\n          this.$Message.warning(\"任务名称不能为空\");\r\n          return;\r\n        }\r\n        // else{\r\n        //     this.validateTaskName(this.taskForm.id,this.taskForm.taskName);\r\n        // }\r\n        // console.log(this.validateName);\r\n        // if(this.validateName){\r\n        //    this.$Message.warning(\"任务名称已存在!\");\r\n        //    return;\r\n        // }\r\n\r\n        if(!this.taskForm.maxChannel){\r\n          this.$Message.warning(\"最大通道数不能为空\");\r\n          return;\r\n        }\r\n        if(!this.taskForm.blackGroupId){\r\n          this.$Message.warning(\"免呼组不能为空\");\r\n          return;\r\n        }\r\n        if(!this.taskForm.relayGroupId){\r\n          this.$Message.warning(\"中继组不能为空\");\r\n          return;\r\n        }\r\n        if(!this.taskForm.relayPhoneMode){\r\n          this.$Message.warning(\"主叫号码规则不能为空\");\r\n          return;\r\n        }else{\r\n          if(this.taskForm.relayPhoneMode == 2){\r\n              if(!this.taskForm.relayPhoneId){\r\n                this.$Message.warning(\"主叫号码不能为空\");\r\n                return;\r\n              }\r\n          }\r\n        }\r\n        if(!this.taskForm.workTimeGroupId){\r\n          this.$Message.warning(\"时间组不能为空\");\r\n          return;\r\n        }\r\n        this.taskForm.startTime =  this.dateFormat(this.taskForm.startTime);\r\n        this.taskForm.endTime =  this.dateFormat(this.taskForm.endTime);\r\n        params = this.taskForm;\r\n        console.log(params);\r\n        var result = this.queryResultListItems;\r\n        if(result.length <= 0){\r\n            this.$Message.warning(\"营销结果配置不能为空,至少配置一项\");\r\n            return;\r\n        }else{\r\n          for (var i = 0; i < result.length; i++) {\r\n            if (result[i].fullName == \"\" || result[i].fullName == null) {\r\n              this.$Message.warning(\"营销结果名称不能为空\");\r\n              return;\r\n            }\r\n            if(result[i].successFlag == true){\r\n                result[i].successFlag = 1;\r\n            }\r\n          }\r\n          params[\"list\"] = JSON.stringify(result);\r\n        }\r\n        this.submitLoading = true;\r\n        params[\"taskState\"] = 0;\r\n        params[\"taskType\"] = 1;\r\n        params[\"taskDisplay\"] = 1;\r\n        params[\"maxCallCount\"] = 0;\r\n        if(this.modalType == 0){\r\n          params[\"id\"] = 0;\r\n        }\r\n        params[\"modalType\"] = this.modalType;\r\n        submitCallTask(params).then(res => {\r\n          this.submitLoading = false;\r\n          if (res.success) {\r\n            this.$Message.success(\"操作成功\");\r\n            this.taskForm = {};\r\n            this.queryResultListItems = [];\r\n            this.taskModalVisible = false;\r\n            this.getCallTaskList();\r\n          }\r\n        });\r\n    },\r\n    dateFormat(dateData) {\r\n      var date = new Date(dateData)\r\n      var y = date.getFullYear()\r\n      var m = date.getMonth() + 1\r\n      m = m < 10 ? ('0' + m) : m\r\n      var d = date.getDate()\r\n      d = d < 10 ? ('0' + d) : d\r\n      const time = y + '-' + m + '-' + d +\" \"+ date.getHours() + ':' + date.getMinutes() + ':' + date.getSeconds();\r\n      return time\r\n    },\r\n    editTask(v) {\r\n      // 转换null为\"\"\r\n      for (let attr in v) {\r\n        if (v[attr] == null) {\r\n          delete v[attr];\r\n        }\r\n        if(attr==\"relayPhoneMode\"){\r\n          v[attr] = v[attr]+\"\";\r\n          if(v[attr] == \"2\"){\r\n            this.selectPhone = false;\r\n          }\r\n        }\r\n        if(attr==\"blackGroupId\"){\r\n          v[attr] = parseInt(v[attr]);\r\n        }\r\n        if(attr==\"workTimeGroupId\"){\r\n          v[attr] = parseInt(v[attr]);\r\n        }\r\n      }\r\n      this.modalType = 1;\r\n      this.taskModalVisible = true;\r\n      this.modalTitle = \"编辑任务\";\r\n      this.$refs.taskForm.resetFields();\r\n      let str = JSON.stringify(v);\r\n      let data = JSON.parse(str);\r\n      this.getResultAll(\"0\",data.id,\"0\");\r\n      this.getBlackAll();\r\n      this.getWorktimetAll();\r\n      this.getRelayGroupAll();\r\n      this.getRelayPhoneAll();\r\n      this.taskForm = data;\r\n      console.log(this.taskForm);\r\n      this.getBatchCount(data.id,\"1\");   \r\n    },\r\n    //删除任务记录数据\r\n    callTaskDelClick(v){\r\n        this.$Modal.confirm({\r\n              title: \"确认删除\",\r\n              content: \"删除任务会把当前任务下的批次清单数据一并删除,您确认要删除 \" + v.taskName + \" ?\",\r\n              onOk: () => {\r\n                    deleteCallTaskById({taskId:v.id}).then(res=>{\r\n                        if(res.success){\r\n                            this.$Message.success(\"操作成功\");\r\n                            this.getCallTaskList();\r\n                        }\r\n                    })\r\n              }\r\n        }); \r\n    },\r\n    getBatchCount(taskId,type) { //获取批次信息\r\n      var batchType = \"\";\r\n      if(type==\"2\"){\r\n        batchType = \"1\";\r\n      }\r\n      getCallTaskBatchAllLists({taskId:taskId,batchType:batchType}).then((res) => {\r\n        if (res.success) {\r\n          if(type==\"1\"){\r\n            if(this.modalType == 1 && res.result.total > 0){\r\n              this.editTaskState = true;\r\n              this.subEdit = false;\r\n              this.selectPhone = true;\r\n              this.modalTitle = \"编辑任务(当前任务下存在\"+res.result.total+\"个批次不允许编辑)\";\r\n            }\r\n          }else{\r\n            this.batchList = res.result.list;\r\n          }\r\n          \r\n        }\r\n      });\r\n    },\r\n    beforeUploadImport(file) {\r\n      const fileExt = file.name.split(\".\").pop().toLocaleLowerCase();\r\n      if (fileExt == \"xlsx\" || fileExt == \"xls\") {\r\n       this.uploadfile = file;\r\n      } else {\r\n        this.$Notice.warning({\r\n          title: \"文件类型错误\",\r\n          desc:\r\n            \"所选文件‘ \" +\r\n            file.name +\r\n            \" ’不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。\",\r\n        });\r\n      }\r\n      return false;\r\n    },\r\n    downloadTemple() {\r\n      let title = [];\r\n      let key = [];\r\n      detailImportColumns.forEach((e) => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: detailData,\r\n        autoWidth: true,\r\n        filename: \"导入数据模版\",\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    handleSelectUser(v) {\r\n      this.selectUsers = v;\r\n    },\r\n    submitUser(v){\r\n      let ids = \"\";\r\n      v.forEach(function(e) {\r\n        ids += e.id + \",\";\r\n      });\r\n      ids = ids.substring(0, ids.length - 1);\r\n      this.batchForm.seatUserIds = ids;\r\n    },\r\n    submitBacthImport(){\r\n      var zipFormData = new FormData();\r\n      zipFormData.append(\"file\", this.uploadfile); //file要和@RequestParam(\"file\")MultipartFile file对应好\r\n      zipFormData.append(\"taskId\", this.importList.id);\r\n      zipFormData.append(\"relayPhoneMode\", this.importList.relayPhoneMode);\r\n      zipFormData.append(\"relayPhoneId\", this.importList.relayPhoneId);\r\n      zipFormData.append(\"relayGroupId\", this.importList.relayGroupId);\r\n      zipFormData.append(\"batchName\", this.batchForm.batchName);\r\n      zipFormData.append(\"batchType\", this.batchForm.batchType);\r\n      if(this.batchForm.batchType==1){\r\n        zipFormData.append(\"seatUserIds\", this.batchForm.seatUserIds);\r\n      }\r\n      if(this.batchForm.batchType==2){\r\n        zipFormData.append(\"ivrFlowId\", this.batchForm.ivrFlowId);\r\n        zipFormData.append(\"outCallRate\", this.batchForm.outCallRate);\r\n        zipFormData.append(\"autoCallCount\", this.batchForm.autoCallCount);\r\n        zipFormData.append(\"recallInterval\", this.batchForm.recallInterval);\r\n      }\r\n      if(this.batchForm.batchType==3){\r\n         zipFormData.append(\"ivrFlowId\", this.batchForm.ivrFlowId);\r\n      }\r\n      zipFormData.append(\"batchPrefix\", this.batchForm.batchPrefix);\r\n      zipFormData.append(\"removal\", this.batchForm.removal);\r\n      this.importLoading = true;\r\n      fileDetailUpload(zipFormData).then((res) => {\r\n        if (res.success) {\r\n          this.importLoading = false;\r\n          this.batchModalVisible = false;\r\n          this.batchForm = {batchType:\"1\"};\r\n          this.seatUserDisplay = true;\r\n          this.batchTypeDisplay = false;\r\n          this.ivrDisplay = false;\r\n          this.$Message.success(res.message);\r\n          this.getbatchList(this.taskId);\r\n        }\r\n      });\r\n    },\r\n    editState(enabled, v) {\r\n      let operation = \"\";\r\n      if (enabled == \"1\") {\r\n        operation = \"启动\";\r\n      } else {\r\n        operation = \"暂停\";\r\n      }\r\n      this.$Modal.confirm({\r\n        title: \"确认\" + operation,\r\n        content: `您确认要${operation} ${v.batchName}?`,\r\n        loading: true,\r\n        onOk: () => {\r\n          var params = {};\r\n          params[\"taskId\"] = v.taskId;\r\n          params[\"batchId\"] = v.id;\r\n          params[\"taskState\"] = v.taskState;\r\n          params[\"batchState\"] = enabled;\r\n          submitStateCallTaskBatch(params).then(res => {\r\n            this.$Modal.remove();\r\n            if (res.success) {\r\n              this.$Message.success(\"操作成功\");\r\n              this.getCallTaskList();\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    editDisplay(display,batchId,taskId) {\r\n          var params = {};\r\n          params[\"display\"] = display;\r\n          params[\"batchId\"] = batchId;\r\n          params[\"taskId\"] = taskId;\r\n          submitDisplayCallTask(params).then(res => {\r\n            if (res.success) {\r\n              this.$Message.success(\"操作成功\");\r\n              this.getCallTaskList();\r\n            }\r\n          });\r\n    },\r\n    //编辑\r\n    rowBatchEdit(V) {\r\n        this.batchForm.batchId = V.id;\r\n        this.batchForm.outCallRate = V.outCallRate;\r\n        this.batchMobileVisible = true;\r\n        this.batchMobileVisibleTitle=\"编辑批次\";\r\n    },\r\n    submitaBatch(){\r\n        if(parseFloat(this.batchForm.outCallRate).toFixed(1) < 1.0 || parseFloat(this.batchForm.outCallRate).toFixed(1) > 4.0){\r\n              this.$Message.warning(\"预测外呼速率输入的值请在1.0~4.0之间。\");\r\n              return;\r\n        }\r\n        var params = {};\r\n        params[\"batchId\"] = this.batchForm.batchId;\r\n        params[\"outCallRate\"] = this.batchForm.outCallRate;\r\n        this.submitLoading = true;\r\n        submitCallTaskBatch(params).then(res => {\r\n          this.submitLoading = false;\r\n          if (res.success) {\r\n            this.getbatchList(this.taskId);\r\n            this.batchForm.outCallRate = \"\";\r\n            this.batchForm.batchId = \"\";\r\n            this.batchMobileVisible = false;\r\n          }\r\n        });\r\n    },\r\n    btnDataAssign(){\r\n       this.assignModalTitle=\"数据分配\";\r\n       this.assignModalVisible=true;\r\n    },\r\n    cancelBatch(){\r\n       this.batchForm.outCallRate = \"\";\r\n       this.batchForm.batchId = \"\";\r\n       this.batchMobileVisible = false;\r\n    },\r\n    changeBatchPage(v){\r\n         this.searchBatchForm.pageNumber = v;\r\n    },\r\n    changeBatchPageSize(v){\r\n         this.searchBatchForm.pageSize = v;\r\n    },\r\n    clearBatch(){\r\n         this.modalBatchVisible=false;\r\n         this.totalBatch=0;\r\n         this.dataBatch=[];\r\n         this.$refs.searchBatchForm.resetFields();\r\n    },\r\n    handelBatchSubmit(){\r\n\r\n    },\r\n    changeTaskPage(v){\r\n         this.searchTaskForm.pageNumber = v;\r\n    },\r\n    changeTaskPageSize(v){\r\n         this.searchTaskForm.pageSize = v;\r\n    },\r\n    clearTask(){\r\n         this.modalTaskVisible=false;\r\n         this.totalTask=0;\r\n         this.dataTask=[];\r\n         this.$refs.searchTaskForm.resetFields();\r\n    },\r\n    handelTaskSubmit(){\r\n\r\n    },\r\n    changeStartDate(v) {\r\n      this.recycleForm.startDate = v;\r\n    },\r\n    changeEndDate(v) {\r\n      this.recycleForm.endDate = v;\r\n    },\r\n    btnDataRecycle(){\r\n        this.recycleModalVisible=true;\r\n        this.batchList = [];\r\n        this.marketingResultList = [];\r\n        this.recycleForm.startDate = this.addDate();\r\n        this.recycleForm.endDate = this.addDate();\r\n        this.getBatchCount(this.taskId,\"2\");\r\n        this.getRecycleResultAll();\r\n    },\r\n    addDate(toDay) {\r\n      let nowDate = \"\";\r\n      if(toDay){\r\n        nowDate = toDay;\r\n      }else{\r\n        nowDate = new Date();\r\n      }\r\n      let date = {\r\n        year: nowDate.getFullYear(),\r\n        month: nowDate.getMonth() + 1,\r\n        date: nowDate.getDate()\r\n      }\r\n      let month = date.month < 10 ? '0'+date.month:date.month;\r\n      let day = date.date < 10 ? '0'+date.date:date.date;\r\n      let systemTime = date.year + '-' + month + '-' + day;\r\n      return systemTime;\r\n    },\r\n    getRecycleResultAll() {\r\n      getResultAllLists({isPublic:0,taskId:this.taskId}).then((res) => {\r\n        if (res.success) {\r\n          this.marketingResultList = res.result.list;\r\n        }\r\n      });\r\n    },\r\n    cancelRecycle(){\r\n        this.$refs.recycleForm.resetFields();\r\n        this.recycleModalVisible=false;\r\n        this.batchList = [];\r\n        this.marketingResultList = [];\r\n    }, \r\n    submitRecycle(){\r\n          if(!this.recycleForm.batchId){\r\n              this.$Message.warning(\"批次名称不能为空!\");\r\n              return;\r\n          }\r\n          if(!this.recycleForm.startDate || !this.recycleForm.endDate){\r\n              this.$Message.warning(\"开始,结束日期不能为空!\");\r\n              return;\r\n          }\r\n          if(!this.recycleForm.recycleUser){\r\n              this.$Message.warning(\"回收坐席不能为空!\");\r\n              return;\r\n          }\r\n          if(!this.recycleForm.assignUser){\r\n              this.$Message.warning(\"分配坐席不能为空!\");\r\n              return;\r\n          }\r\n          var formdata={};\r\n          for(var i in this.recycleForm){\r\n            if(this.recycleForm[i] != null && this.recycleForm[i] !=\"\"){\r\n              if(i==\"startDate\" || i==\"endDate\"){\r\n                 formdata[i] = this.addDate(this.recycleForm[i]);  \r\n              }else{\r\n                 formdata[i] = this.recycleForm[i];  \r\n              }\r\n              \r\n            }\r\n          }\r\n          formdata[\"taskId\"] = this.taskId;\r\n          console.log(formdata);\r\n          submitRecycle(formdata).then((res) => {\r\n            if (res.success) {\r\n              this.$Message.success(\"操作成功\");\r\n              this.$refs.recycleForm.resetFields();\r\n              this.recycleModalVisible=false;\r\n              this.batchList = [];\r\n              this.marketingResultList = [];\r\n            }\r\n          });\r\n    },\r\n    submitRecycleUser(v){\r\n      let ids = \"\";\r\n      v.forEach(function(e) {\r\n        ids += e.id + \",\";\r\n      });\r\n      ids = ids.substring(0, ids.length - 1);\r\n      this.recycleForm.recycleUser = ids;\r\n    },\r\n    submitAssignUser(v){\r\n      let ids = \"\";\r\n      v.forEach(function(e) {\r\n        ids += e.id + \",\";\r\n      });\r\n      ids = ids.substring(0, ids.length - 1);\r\n      this.recycleForm.assignUser = ids;\r\n    },\r\n    cancelAssignTask() {\r\n      this.$refs.assignForm.resetFields();\r\n      this.assignModalTitle=\"分配数据\";\r\n      this.assignModalVisible = false;\r\n    },\r\n\r\n  },\r\n  mounted() {\r\n    let type = this.$route.query.type;\r\n    if (type == \"social\") {\r\n      this.activeName = \"第三方账号绑定\";\r\n      this.currMenu = \"第三方账号绑定\";\r\n    }\r\n    this.init();\r\n  },\r\n  watch: {\r\n\r\n  },\r\n  computed: {},\r\n};\r\n</script>\r\n"]}]}