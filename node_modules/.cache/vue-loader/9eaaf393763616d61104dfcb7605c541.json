{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\my-components\\excel\\excelExport.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\my-components\\excel\\excelExport.vue","mtime":1614579763291},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBleGNlbCBmcm9tICJAL2xpYnMvZXhjZWwiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGV4cG9ydE1vZGFsVmlzaWJsZTogZmFsc2UsCiAgICAgIGxvYWRpbmdFeHBvcnQ6IHRydWUsCiAgICAgIGZpbGVuYW1lOiAi5a+85Ye65pWw5o2uIiwKICAgICAgY2hvb3NlQ29sdW1uczogW10sCiAgICAgIGV4cG9ydENvbHVtbnM6IFtdLAogICAgICBleHBvcnREYXRhOiBbXSwKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXQoKSB7CiAgICAgIC8vIOWIneWni+WMluWvvOWHuuWIl+aVsOaNrgogICAgICBsZXQgYXJyYXkgPSBbXTsKICAgICAgdGhpcy5leHBvcnRDb2x1bW5zLmZvckVhY2goZSA9PiB7CiAgICAgICAgLy8g5oyH5a6a5YiX6ZmQ5Yi25p2D6ZmQCiAgICAgICAgaWYgKAogICAgICAgICAgIXRoaXMuZ2V0U3RvcmUoInJvbGVzIikuaW5jbHVkZXMoIlJPTEVfQURNSU4iKSAmJgogICAgICAgICAgZS5rZXkgPT0gIm1vYmlsZSIKICAgICAgICApIHsKICAgICAgICAgIGUudGl0bGUgPSAiW+aXoOadg+WvvOWHul0gIiArIGUudGl0bGU7CiAgICAgICAgICBlLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZS5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBhcnJheS5wdXNoKGUudGl0bGUpOwogICAgICB9KTsKICAgICAgdGhpcy5jaG9vc2VDb2x1bW5zID0gYXJyYXk7CiAgICB9LAogICAgZXhwb3J0Q3VzdG9tRGF0YSgpIHsKICAgICAgaWYgKHRoaXMuZmlsZW5hbWUgPT0gIiIpIHsKICAgICAgICB0aGlzLmZpbGVuYW1lID0gIuWvvOWHuuaVsOaNriI7CiAgICAgIH0KICAgICAgLy8g5Yik5pat5Yu+6YCJ5a+85Ye65YiXCiAgICAgIGxldCBhcnJheSA9IFtdOwogICAgICB0aGlzLmV4cG9ydENvbHVtbnMuZm9yRWFjaChlID0+IHsKICAgICAgICB0aGlzLmNob29zZUNvbHVtbnMuZm9yRWFjaChjID0+IHsKICAgICAgICAgIGlmIChlLnRpdGxlID09IGMgJiYgIWUuZGlzYWJsZWQpIHsKICAgICAgICAgICAgYXJyYXkucHVzaChlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuZXhwb3J0Q29sdW1ucyA9IGFycmF5OwogICAgICB0aGlzLmV4cG9ydE1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICBsZXQgdGl0bGUgPSBbXTsKICAgICAgbGV0IGtleSA9IFtdOwogICAgICB0aGlzLmV4cG9ydENvbHVtbnMuZm9yRWFjaChlID0+IHsKICAgICAgICB0aXRsZS5wdXNoKGUudGl0bGUpOwogICAgICAgIGtleS5wdXNoKGUua2V5KTsKICAgICAgfSk7CiAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAga2V5OiBrZXksCiAgICAgICAgZGF0YTogdGhpcy5leHBvcnREYXRhLAogICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwKICAgICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZQogICAgICB9OwogICAgICBleGNlbC5leHBvcnRfYXJyYXlfdG9fZXhjZWwocGFyYW1zKTsKICAgIH0sCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0KCkKICB9Cn0K"},{"version":3,"sources":["excelExport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"excelExport.vue","sourceRoot":"src/views/my-components/excel","sourcesContent":["<template>\r\n  <Modal v-model=\"exportModalVisible\" title=\"导出知识\" :loading=\"loadingExport\" @on-ok=\"exportCustomData\">\r\n    <Form ref=\"exportForm\" :label-width=\"100\">\r\n      <FormItem label=\"导出文件名\">\r\n        <Input v-model=\"filename\" />\r\n      </FormItem>\r\n      <FormItem label=\"自定义导出列\">\r\n        <CheckboxGroup v-model=\"chooseColumns\">\r\n          <Checkbox v-for=\"(item,i) in exportColumns\" :label=\"item.title\" :key=\"i\" :disabled=\"item.disabled\"></Checkbox>\r\n        </CheckboxGroup>\r\n      </FormItem>\r\n    </Form>\r\n  </Modal>\r\n</template>\r\n\r\n<script>\r\n  import excel from \"@/libs/excel\";\r\n  export default {\r\n    data() {\r\n      return {\r\n        exportModalVisible: false,\r\n        loadingExport: true,\r\n        filename: \"导出数据\",\r\n        chooseColumns: [],\r\n        exportColumns: [],\r\n        exportData: [],\r\n      }\r\n    },\r\n    methods: {\r\n      init() {\r\n        // 初始化导出列数据\r\n        let array = [];\r\n        this.exportColumns.forEach(e => {\r\n          // 指定列限制权限\r\n          if (\r\n            !this.getStore(\"roles\").includes(\"ROLE_ADMIN\") &&\r\n            e.key == \"mobile\"\r\n          ) {\r\n            e.title = \"[无权导出] \" + e.title;\r\n            e.disabled = true;\r\n          } else {\r\n            e.disabled = false;\r\n          }\r\n          array.push(e.title);\r\n        });\r\n        this.chooseColumns = array;\r\n      },\r\n      exportCustomData() {\r\n        if (this.filename == \"\") {\r\n          this.filename = \"导出数据\";\r\n        }\r\n        // 判断勾选导出列\r\n        let array = [];\r\n        this.exportColumns.forEach(e => {\r\n          this.chooseColumns.forEach(c => {\r\n            if (e.title == c && !e.disabled) {\r\n              array.push(e);\r\n            }\r\n          });\r\n        });\r\n        this.exportColumns = array;\r\n        this.exportModalVisible = false;\r\n        let title = [];\r\n        let key = [];\r\n        this.exportColumns.forEach(e => {\r\n          title.push(e.title);\r\n          key.push(e.key);\r\n        });\r\n        const params = {\r\n          title: title,\r\n          key: key,\r\n          data: this.exportData,\r\n          autoWidth: true,\r\n          filename: this.filename\r\n        };\r\n        excel.export_array_to_excel(params);\r\n      },\r\n    },\r\n    mounted() {\r\n      this.init()\r\n    }\r\n  }\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"]}]}