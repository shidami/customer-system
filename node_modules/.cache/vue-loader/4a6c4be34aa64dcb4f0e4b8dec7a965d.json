{"remainingRequest":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\my-components\\toolbar\\toolbarConsultingService.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\src\\views\\my-components\\toolbar\\toolbarConsultingService.vue","mtime":1614579763311},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Documents\\shimin\\current project\\xrcc-front\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCkBpbXBvcnQgIi4vdG9vbGJhckNvbnN1bHRpbmdTZXJ2aWNlLmxlc3MiOw0K"},{"version":3,"sources":["toolbarConsultingService.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkuBA","file":"toolbarConsultingService.vue","sourceRoot":"src/views/my-components/toolbar","sourcesContent":["<template>\r\n  <div class=\"model-box\">\r\n    <Tabs value=\"name1\">\r\n      <TabPane label=\"咨询坐席\" name=\"name1\">\r\n        <Row :gutter=\"16\">\r\n          <Col span=\"5\" style=\"padding-right: 20px;\">\r\n            <div class=\"ui-panl-warp\">\r\n              <p class=\"ui-panl-header\">可选择的技能组</p>\r\n              <Menu\r\n                  :active-name=\"itemListData[0].GrpId\"\r\n                  class=\"ui-toolbar-monitor-item-box ui-menu-primary\"\r\n                  style=\"width: 100%\"\r\n              >\r\n                <MenuItem\r\n                    :name=\"item.GrpId\"\r\n                    @click.native=\"getDetail(item.GrpId,item.GrpName)\"\r\n                    class=\"ui-toolbar-monitor-item\"\r\n                    :class=\"ownSpaceLeftItem == item.id ? '' : ''\"\r\n                    v-for=\"(item, i) in itemListData\"\r\n                    :key=\"item.GrpId\"\r\n                    :data-name-1=\"i + 1\"\r\n                >\r\n                  <span>{{ item.GrpName }}</span>\r\n                </MenuItem>\r\n              </Menu>\r\n            </div>\r\n          </Col>\r\n          <Col span=\"19\">\r\n            <div>\r\n              归属坐席-{{ groupName }}-{{ number }}人；坐席查询：\r\n              <Form\r\n                      ref=\"consultationSeatSearchForm\"\r\n                      :model=\"consultationSeatSearchForm\"\r\n                      style=\"width:180px; display: inline-block;\"\r\n              >\r\n                <FormItem>\r\n                  <Input\r\n                          type=\"text\"\r\n                          v-model=\"consultationSeatSearchForm.user\"\r\n                          placeholder=\"请输入\"\r\n                  >\r\n                  </Input>\r\n                </FormItem>\r\n              </Form>\r\n              <div>\r\n                <Row :gutter=\"16\">\r\n                  {{cardItemSearchList}}\r\n                  <Col span=\"6\" v-for=\"(item, i) in cardItemSearchList\"\r\n                       :key=\"i\"\r\n                       @click.native=\"cardItemClick(item)\"\r\n                  >\r\n                    <div\r\n                            class=\"ui-card\"\r\n\r\n                    >\r\n                      <div class=\"ui-card-header\">\r\n                        <div>\r\n                          姓名：<span class=\"text-val\">{{\r\n                            item.Name\r\n                          }}</span>\r\n                        </div>\r\n                        <div>\r\n                          工号：<span class=\"text-val\">{{\r\n                            item.JobNum\r\n                          }}</span>\r\n                        </div>\r\n                      </div>\r\n                      <div class=\"ui-card-body\">\r\n                        <img v-if=\"item.Gender == '女'\" src=\"../../../assets/female.png\" />\r\n                        <img v-if=\"item.Gender == '男'\" src=\"../../../assets/male2.png\" />\r\n                        <div class=\"\">\r\n                          <p>\r\n                            分机：<span class=\"text-val\">{{\r\n                              item.Seat\r\n                            }}</span>\r\n                          </p>\r\n                          <p>\r\n                            状态：<span class=\"text-val\">{{\r\n                              setState(item.State)\r\n                            }}</span>\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </Col>\r\n                </Row>\r\n              </div>\r\n            </div>\r\n          </Col>\r\n        </Row>\r\n      </TabPane>\r\n      <TabPane label=\"咨询外线\" name=\"name2\">\r\n        <Row>\r\n          <Form ref=\"consultingOutsideLineForm\" :model=\"consultingOutsideLineForm\" :rules=\"consultingOutsideLineValidate\" :label-width=\"80\" style=\"width: 600px\">\r\n            <FormItem label=\"外线号码\" prop=\"phone\">\r\n              <Input type=\"text\" v-model=\"consultingOutsideLineForm.phone\"></Input>\r\n            </FormItem>\r\n            <FormItem>\r\n              <Button type=\"primary\" @click=\"consultingOutsideLineSubmit('consultingOutsideLineForm')\">咨询外线</Button>\r\n            </FormItem>\r\n          </Form>\r\n        </Row>\r\n      </TabPane>\r\n      <TabPane label=\"咨询分机\" name=\"name3\">\r\n\r\n        <div>\r\n          分机列表--{{ extNumber }}个；分机查询：\r\n          <Form\r\n                  ref=\"consultingExtensionSearchForm\"\r\n                  :model=\"consultingExtensionSearchForm\"\r\n                  style=\"width:180px; display: inline-block;\"\r\n          >\r\n            <FormItem>\r\n              <Input\r\n                      type=\"text\"\r\n                      v-model=\"consultingExtensionSearchForm.user\"\r\n                      placeholder=\"请输入\"\r\n              >\r\n              </Input>\r\n            </FormItem>\r\n          </Form>\r\n          <Alert style=\"display: inline-block;margin-left: 15px;\">温馨提示：单击选中下面一个分机选框即可咨询该分机。</Alert>\r\n          <div>\r\n            <Row :gutter=\"16\" class=\"no-margin\">\r\n              <Col span=\"4\" v-for=\"(item, i) in consultingExtensionCardItemSearch\"\r\n                   @click.native=\"clickExtUserCard(item)\"\r\n                   :key=\"i\">\r\n                <div class=\"ui-card\">\r\n                  <div class=\"ui-card-body\">\r\n                    <div><img src=\"../../../assets/telephone.png\" /></div>\r\n                    <div class=\"\">\r\n                      <p>\r\n                        分机：<span class=\"text-val\">{{\r\n                              item.ExtNumber\r\n                            }}</span>\r\n                      </p>\r\n                      <p>\r\n                        姓名：<span class=\"text-val\">{{\r\n                              item.ExtUserRealName\r\n                            }}</span>\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </div>\r\n        </div>\r\n      </TabPane>\r\n    </Tabs>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nvar openerW = parent;\r\nexport default {\r\n  name: \"toolbarConsultingService\",\r\n  props: [\"toolbarConsultingServiceModalVisible\"],\r\n  data() {\r\n    return {\r\n      groupName: \"\",\r\n      number: \"\",\r\n      GroupId:null,\r\n      groupDetail:'',\r\n      extNumber:0,\r\n      //技能组\r\n      itemListData: [],\r\n      //咨询坐席-搜索条件\r\n      consultationSeatSearchForm: {\r\n        userRealName: \"\",\r\n      },\r\n      //咨询外线-搜索条件\r\n      consultingOutsideLineForm:{\r\n        phone:\"\"\r\n      },\r\n      //咨询外线-表头\r\n      consultingOutsideLineFormColumns:[\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          type: \"index\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          title: \"姓名\", //姓名\r\n          key: \"userRealName\",\r\n          width: 150,\r\n          sortable: true,\r\n          tooltip: true,\r\n        },\r\n        {\r\n          title: \"性别\", //性别\r\n          key: \"setGender\",\r\n          width: 150,\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"固定电话\", //固定电话\r\n          key: \"setExtMode\",\r\n          width: 150,\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"手机\", //手机\r\n          key: \"setExtNumber\",\r\n          width: 150,\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"邮箱\", //邮箱\r\n          key: \"email\",\r\n          width: 150,\r\n          sortable: true,\r\n        }\r\n      ],\r\n      //线外咨询表格数据\r\n      consultingOutsideLineData:[{\r\n          id:\"000001\",\r\n          userRealName: \"张三\",\r\n          setGender: \"男\",\r\n          setExtMode: \"010-123123\",\r\n          setExtNumber: \"13333333333\",\r\n          email: \"22@qq.com\"\r\n        },],\r\n      //咨询坐席树\r\n      treeData: [\r\n        {\r\n          id: \"00001\",\r\n          title: \"VIP专属客服\",\r\n          expand: true,\r\n          parentnodes: 0,\r\n          children: [\r\n            {\r\n              id: \"00001000001\",\r\n              title: \"vip4104\",\r\n              expand: true,\r\n              parentnodes: 0,\r\n              children: [],\r\n            },\r\n            {\r\n              id: \"00001000002\",\r\n              title: \"vip6450\",\r\n              expand: true,\r\n              parentnodes: 0,\r\n              children: [],\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: \"00002\",\r\n          title: \"1\",\r\n          expand: true,\r\n          parentnodes: 0,\r\n          children: [\r\n            {\r\n              id: \"00002000001\",\r\n              title: \"1\",\r\n              expand: true,\r\n              parentnodes: 0,\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: \"00003\",\r\n          title: \"综合客服\",\r\n          expand: true,\r\n          children: [],\r\n          parentnodes: 0,\r\n        },\r\n        {\r\n          id: \"00004\",\r\n          title: \"专属客服\",\r\n          expand: true,\r\n          children: [],\r\n          parentnodes: 0,\r\n        },\r\n        {\r\n          id: \"00005\",\r\n          title: \"管理组\",\r\n          expand: true,\r\n          children: [],\r\n          parentnodes: 0,\r\n        },\r\n        {\r\n          id: \"00006\",\r\n          title: \"运输客服\",\r\n          expand: true,\r\n          children: [],\r\n          parentnodes: 0,\r\n        },\r\n      ],\r\n      //咨询外线树\r\n      treeData2: [\r\n        {\r\n          id: \"00001\",\r\n          title: \"个人联系人\",\r\n          expand: true,\r\n          parentnodes: 0,\r\n          children: [\r\n            {\r\n              id: \"00001000001\",\r\n              title: \"vip4104\",\r\n              expand: true,\r\n              parentnodes: 0,\r\n              children: [],\r\n            },\r\n            {\r\n              id: \"00001000002\",\r\n              title: \"vip6450\",\r\n              expand: true,\r\n              parentnodes: 0,\r\n              children: [],\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: \"00002\",\r\n          title: \"共享联系人\",\r\n          expand: true,\r\n          parentnodes: 0,\r\n          children: [\r\n            {\r\n              id: \"00002000001\",\r\n              title: \"1\",\r\n              expand: true,\r\n              parentnodes: 0,\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          id: \"00003\",\r\n          title: \"公共联系人\",\r\n          expand: true,\r\n          children: [],\r\n          parentnodes: 0,\r\n        },\r\n      ],\r\n      //咨询坐席卡片\r\n      cardItem: [\r\n        {\r\n          id: \"0001\",\r\n          userRealName: \"客服1\", //姓名\r\n          username: \"1001\", //工号\r\n          extnumber: \"8002\", //分机号\r\n          currentStatus: \"空闲\", //状态\r\n          setGender:\"0\",//性别\r\n        }],\r\n      cardItemSearchList:[],\r\n      total: 0,\r\n      //咨询分机\r\n      consultingExtensionSearchForm:{\r\n        name:\"\"\r\n      },\r\n      //咨询分机-卡片\r\n      consultingExtensionCardItem: [],\r\n      consultingExtensionCardItemSearch:[],\r\n      //\r\n      consultingOutsideLineValidate:{\r\n        phone: [\r\n          {\r\n            type:'number',\r\n            required: true,\r\n            message: \"请输入正确的手机号码\",\r\n            trigger: \"blur\",\r\n            transform(value){\r\n              var myreg=/^\\d{5,30}$/;\r\n              if(!myreg.test(value)){\r\n                return false;\r\n              }else {\r\n                return Number(value)\r\n              }\r\n            }\r\n          },\r\n        ],\r\n      },\r\n\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getSkillGroupListData();//获取技能组\r\n      this.getExtDataList();//获取分机卡片\r\n    },\r\n    getSkillGroupListData(){\r\n      var than=this;\r\n      window.setTimeout(function (){\r\n        var postData = {\r\n          GroupId : than.GroupId\r\n        };\r\n        //监控窗口加载完成后发送开始监控命令\r\n        //openerW.OcxCommandFun.CTIAgentCommonAction(\"BeginMonitor\", postData,function(data){\r\n        openerW.OcxCommandFun.CTIAgentCommonAction(\"BeginConsult\", postData,function(data){\r\n\r\n        },function(ex){\r\n          openerW.OcxCore.Utility.ShowLoading(false);\r\n          if(ex.Message != undefined && ex.Message != \"\") openerW.OcxCore.Utility.ShowTip(ex.Message, 1);\r\n        });\r\n\r\n      },200)\r\n      window.setTimeout(function (){\r\n        than.setSkillGroupListData();\r\n      },500)\r\n    },\r\n    //咨询坐席-获取技能组\r\n    setSkillGroupListData() {\r\n      var dataA=[];\r\n      //var seatGroups = openerW.OcxCore.Session.getCTIAgentData().getSeatGroups().data;\r\n      var dataA=JSON.parse(localStorage.getItem('GetGrpSeatStateData'));\r\n      var cmd=dataA.cmd;\r\n      var data=dataA.data.Data;\r\n      if(cmd == \"GRPINFO_NOTIFY\"){\r\n        // for(var i in seatGroups){\r\n        //   var v=seatGroups[i];\r\n        //   dataA.push({\"id\":v.GroupId+\"\",\"text\":v.GroupName,\"value\":v.GroupId,\"code\":dataA.length+1})\r\n        // }\r\n        this.GroupId=data[0].GrpId.toString();\r\n        this.itemListData=data;\r\n        this.groupName=data[0].GrpName.toString();\r\n\r\n      }else if(cmd == \"CONSULTSTATE_NOTIFY\"){\r\n        var seats = data.Data;\r\n        LoadViewList(seats);\r\n      }\r\n      this.getSeatList();//获取坐席卡片\r\n    },\r\n    //获取坐席卡片\r\n    getSeatList(){\r\n      var than=this;\r\n      window.setTimeout(function (){\r\n        var postData = {\r\n          GroupId : than.GroupId\r\n        };\r\n        //监控窗口加载完成后发送开始监控命令\r\n        //openerW.OcxCommandFun.CTIAgentCommonAction(\"BeginMonitor\", postData,function(data){\r\n        openerW.OcxCommandFun.CTIAgentCommonAction(\"GetGrpSeatState\", postData,function(data){\r\n\r\n        },function(ex){\r\n          openerW.OcxCore.Utility.ShowLoading(false);\r\n          if(ex.Message != undefined && ex.Message != \"\") openerW.OcxCore.Utility.ShowTip(ex.Message, 1);\r\n        });\r\n\r\n      },200)\r\n      window.setTimeout(function (){\r\n        than.setSeatList();\r\n      },500)\r\n    },\r\n    setSeatList(){\r\n\r\n      var than=this;\r\n      var dataA=JSON.parse(localStorage.getItem('CONSULTSTATE_NOTIFYData'));\r\n\r\n      var cmd=dataA.cmd;\r\n      var data=dataA.data.Data;\r\n      this.cardItem=data;\r\n      this.cardItemSearchList=than.cardItem;\r\n      if (cmd == \"MONITORSTATE_NOTIFY\")//监控坐席状态通知\r\n      {\r\n        this.setTitle(this.cardItemSearchList);\r\n      }\r\n      else if (cmd == \"GROUPWAITCOUNT_NOTIFY\")//技能排队等待数量通知\r\n      {\r\n        if(GroupId != null && GroupId == data.GroupId)\r\n        {\r\n          var waitCount = data.WaitCount || 0;\r\n          $(\"#lblWaitCount\").text(waitCount);\r\n        }\r\n      }\r\n      else if(cmd == \"CurrentUserStateChanged\")\r\n      {\r\n        if(!openerW.OcxCore.Session.IsCheckin())\r\n        {\r\n          $(\"#grid_View\").html(\"\");\r\n          _SeatDatas.clear();\r\n\r\n          than.closeThisWindow();//关闭窗口\r\n        }\r\n        /*         \telse if(openerW.OcxCore.Session.GetUserInfo() != null && openerW.OcxCore.Session.GetUserInfo().CTIMonitorStatus == openerW.OcxCore.Enums.CTIMonitorStatusFlag.INITSYSTEM.getIndex())\r\n                    {\r\n                        if (!!$(this).hasClass(\"selected\")) {\r\n                            $(this).removeClass(\"selected\");\r\n                        } else {\r\n                            $(\"#grid_View .selected\").removeClass(\"selected\");\r\n                            $(this).addClass(\"selected\");\r\n                        }\r\n                        var seatExtNum = $(this).attr(\"id\").toString().replace(\"seat_\",\"\");\r\n                        changeButtonState($(this),_SeatDatas.get(seatExtNum));\r\n                    }else\r\n                    {\r\n                        var seatExtNum = $(this).attr(\"id\").toString().replace(\"seat_\",\"\");\r\n                        changeButtonState($(this),_SeatDatas.get(seatExtNum));\r\n                    } */\r\n      }else if(cmd == \"MonitorOptionRes\")\r\n      {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        if(data.Result == true)\r\n        {\r\n          openerW.OcxCore.Session.getCTIAgentData().setCTIMonitorStatus(data.CTIMonitorStatus);\r\n          var seat = _SeatDatas.get(data.CTIMonitorExtNumber);\r\n          seat.MonitorButton = data.MonitorButton;\r\n          _SeatDatas.put(data.CTIMonitorExtNumber+\"\", seat);\r\n          var seatObj = $(\"#\"+\"seat_\"+data.CTIMonitorExtNumber);\r\n          if(openerW.OcxCore.Session.getCTIAgentData().getCTIMonitorStatus() == openerW.OcxCore.Enums.CTIMonitorStatusFlag.INITSYSTEM.getIndex())\r\n          {\r\n            openerW.OcxCore.Session.getCTIAgentData().setCTIMonitorExtNumber(\"\");\r\n          }else\r\n          {\r\n            openerW.OcxCore.Session.getCTIAgentData().setCTIMonitorExtNumber(data.CTIMonitorExtNumber);\r\n          }\r\n\r\n          if(data.CloseMonitorDialog != undefined && data.CloseMonitorDialog == true)\r\n          {\r\n            than.closeThisWindow();//关闭窗口\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //咨询外线-搜索\r\n    handleSearch() {\r\n      this.cardItemSearchList=dataA;\r\n      this.setTitle(this.cardItemSearchList);\r\n    },\r\n    //获取分机卡片数据\r\n    getExtDataList(){\r\n      var session = parent.OcxCore.Session;//\r\n      var dataA=[];\r\n      if (session != undefined && session != null) {\r\n        if (session.getConfig == undefined || session.getConfig(\"EnableConsultExtNum\") == null || session.getConfig(\"EnableConsultExtNum\") != true) {\r\n          return;\r\n        }\r\n        var ExtNumberList = session.getExtNumberList();\r\n        for (var i = 0; i < ExtNumberList.size(); i++) {\r\n          var ExtNumber = ExtNumberList.get(i);\r\n          if (ExtNumber.ExtNumber == session.getExtNumber()) {\r\n            continue;\r\n          }\r\n          dataA.push(ExtNumber);\r\n        }\r\n      }\r\n      this.extNumber=dataA.length;\r\n      this.consultingExtensionCardItem=dataA;\r\n      this.consultingExtensionCardItemSearch=this.consultingExtensionCardItem;\r\n    },\r\n    //技能组统计明细\r\n    setTitle(data){\r\n      this.number=data.length\r\n    },\r\n    //咨询外线-重置\r\n    handleReset() {\r\n      this.$refs.searchForm.resetFields();\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n    },\r\n    dropDown() {},\r\n    //咨询坐席-获取技能树\r\n    getConsultationSeatTree(){\r\n\r\n    },\r\n    //根据技能组查看坐席详情\r\n    getDetail(id,text) {\r\n      this.GroupId=id;\r\n      this.groupName=text;\r\n      this.getSeatList();\r\n      //this.getSeatStatus();\r\n    },\r\n\r\n    setState (v){\r\n      return openerW.OcxCore.Enums.GetName(openerW.OcxCore.Enums.CTIAgentStatusFlag,v);\r\n    },\r\n    //咨询外线\r\n    consultingOutsideLineSubmit() {\r\n      var than=this;\r\n      var phone = this.consultingOutsideLineForm.phone;\r\n      phone = phone.replace(/(^\\s*)|(\\s*$)/g, \"\");\r\n      if (phone == undefined || phone == null || phone.length == 0) {\r\n        this.$Message.info(\"请输入外线号码！\");\r\n        return;\r\n      }\r\n      var reg = /^(\\+\\d{2,3}\\-)?\\d{11}$/;\r\n      var reg2 = /^(\\d{3,4}-?)?[1-9]\\d{6,7}$/;\r\n      var reg3 = /^\\d{4,10}$/;//短号\r\n      var reg4 = /^\\d{5,30}$/;//5到30位的数字\r\n      if (!reg4.test(phone)) {\r\n        openerW.OcxCore.Utility.ShowWarning(\"请输入正确格式的电话号码！\");\r\n        return;\r\n      }\r\n      var postData = {\r\n        Called: phone\r\n      };\r\n      //客户端拨号之前回调函数\r\n      if (openerW.OcxCore.Session.GetGlobal(\"onBeforeMakeCall\") != undefined && openerW.OcxCore.Session.GetGlobal(\"onBeforeMakeCall\") != null && openerW.OcxCore.Session.GetGlobal(\"onBeforeMakeCall\").AttachSize() > 0) {\r\n        postData = openerW.OcxCore.Session.GetGlobal(\"onBeforeMakeCall\").Call(postData, than.BeforeMakeCallCallback);\r\n      }\r\n      if (postData == undefined || postData == null || postData == \"\") {\r\n        //openerW.OcxCore.Utility.ShowWarning(\"电话号码验证不通过！\");\r\n        return;\r\n      }\r\n      if (postData.Called == undefined || postData.Called == null || postData.Called == \"\" || !reg4.test(postData.Called)) {\r\n        openerW.OcxCore.Utility.ShowTip(\"请输入不超过30位数字的拨号号码！\", 1);\r\n        return false;\r\n      }\r\n      //咨询外线\r\n      //openerW.OcxCore.Session.CTIAgentCommonAction(\"ConsultOutline\", postData, function (data) {\r\n      openerW.OcxCommandFun.CTIAgentCommonAction(\"ConsultOutline\", postData, function (data) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        than.closeThisWindow();\r\n      }, function (ex) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        if (ex.Message != undefined && ex.Message != \"\") openerW.OcxCore.Utility.ShowTip(ex.Message, 1);\r\n      });\r\n    },\r\n    cardItemClick(item){\r\n      var than=this;\r\n      var seatExtNum = item.Seat;\r\n      if (!openerW.OcxCore.Session.IsCheckin()) {\r\n        openerW.OcxCore.Utility.ShowTip(\"已签出，操作无效！\", 1);\r\n        return;\r\n      }\r\n      var consultSeat = {\r\n        Called: seatExtNum\r\n      };\r\n      openerW.OcxCore.Utility.ShowLoading(true, \"处理中...\", 5);\r\n      //ConsultInline//咨询内线\r\n      //openerW.OcxCore.Session.CTIAgentCommonAction(\"ConsultInline\", consultSeat, function (data) {\r\n      openerW.OcxCommandFun.CTIAgentCommonAction(\"ConsultInline\", consultSeat, function (data) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        than.closeThisWindow();\r\n      }, function (ex) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        if (ex.Message != undefined && ex.Message != \"\") openerW.OcxCore.Utility.ShowTip(ex.Message, 1);\r\n      });\r\n    },\r\n    clickExtUserCard(item){\r\n      var than=this;\r\n\r\n      var seatExtNum = item.ExtNumber;\r\n      //$(\"#grid_ExtView .selected\").removeClass(\"selected\");\r\n      //$(this).addClass(\"selected\");\r\n      if (!openerW.OcxCore.Session.IsCheckin()) {\r\n        openerW.OcxCore.Utility.ShowTip(\"已签出，操作无效！\", 1);\r\n        return;\r\n      }\r\n      var consultSeat = {\r\n        Called: seatExtNum\r\n      };\r\n      openerW.OcxCore.Utility.ShowLoading(true, \"处理中...\", 5);\r\n      openerW.OcxCommandFun.CTIAgentCommonAction(\"ConsultInline\", consultSeat, function (data) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n\r\n        than.closeThisWindow();\r\n      }, function (ex) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        if (ex.Message != undefined && ex.Message != \"\") openerW.OcxCore.Utility.ShowTip(ex.Message, 1);\r\n      });\r\n    },\r\n    /**\r\n     * 外呼前回调函数(内部使用，不对外开放)\r\n     *\r\n     * @param postData 呼叫信息\r\n     *\r\n     * @return 外呼前验证结果 true验证成功 false验证失败\r\n     * */\r\n    BeforeMakeCallCallback(postData) {\r\n      var than=this;\r\n      if (postData == undefined || postData == null || postData == \"\") {\r\n        openerW.OcxCore.Utility.ShowWarning(\"电话号码验证不通过！\");\r\n        return false;\r\n      }\r\n      var reg4 = /^\\d{5,30}$/;//5到30位的数字\r\n      if (postData.Called == undefined || postData.Called == null || postData.Called == \"\" || !reg4.test(postData.Called)) {\r\n        openerW.OcxCore.Utility.ShowTip(\"请输入不超过30位数字的拨号号码！\", 1);\r\n        return false;\r\n      }\r\n      //咨询外线\r\n      var procResult = openerW.OcxCore.Session.CTIAgentCommonAction(\"ConsultOutline\", postData, function (data) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        than.closeThisWindow();\r\n      }, function (ex) {\r\n        openerW.OcxCore.Utility.ShowLoading(false);\r\n        if (ex.Message != undefined && ex.Message != \"\") openerW.OcxCore.Utility.ShowTip(ex.Message, 1);\r\n      });\r\n      return procResult;\r\n    },\r\n    closeThisWindow(){\r\n      var index=parent.layer.getFrameIndex(window.name); //获取当前窗口的name\r\n      parent.layer.close(index);\r\n    },\r\n\r\n  },\r\n  watch: {\r\n    //咨询坐席-搜索条件\r\n    \"consultationSeatSearchForm.user\": {\r\n      handler: function(val) {\r\n        var dataA=[];\r\n        var dataObj=JSON.parse(JSON.stringify(this.cardItem));\r\n        if(val==\"\"){\r\n          dataA=this.cardItem;\r\n        }else if(val!=\"\"){\r\n          dataObj.forEach(function (v,i,arr){\r\n            if(v.Name.indexOf(val)!=-1||v.JobNum.toString().indexOf(val)!=-1||v.Seat.toString().indexOf(val)!=-1||v.Gender.toString().indexOf(val)!=-1){\r\n              dataA.push(v);\r\n            }\r\n          })\r\n        }\r\n        this.cardItemSearchList=dataA;\r\n        this.setTitle(this.cardItemSearchList);\r\n      },\r\n    },\r\n    //咨询分机-搜索条件\r\n    \"consultingExtensionSearchForm.user\":{\r\n      handler:function(val) {\r\n        var dataA=[];\r\n        var dataObj=JSON.parse(JSON.stringify(this.consultingExtensionCardItem));\r\n        if(val==\"\"){\r\n          dataA=this.consultingExtensionCardItem;\r\n        }else if(val!=\"\"){\r\n          dataObj.forEach(function (v,i,arr){\r\n\r\n            if(v.ExtNumber.toString().indexOf(val)!=-1||v.ExtUserRealName.toString().indexOf(val)!=-1){\r\n\r\n              dataA.push(v);\r\n            }\r\n          })\r\n        }\r\n        this.consultingExtensionCardItemSearch=dataA;\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@import \"./toolbarConsultingService.less\";\r\n</style>\r\n"]}]}